<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Using Class Modules: Bolt Hole Pattern</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="tutorial.css" rel="stylesheet" type="text/css" />
<link href="tab.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="tab.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Using Class Modules: Bolt Hole Pattern </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>In the Tutorial: Introduction to Class Modules we saw how to create a class and then declare and set an object of that type. The power of classes is that the object that it defines, just like other objects, can have Properties, Methods, and Events, and those items are encapsulated. That means they are isolated and unaffected by the properties, methods, and events of other objects, even if those items have identical names.</p>
<p>For example, suppose you frequently cut bolt hole patterns. Now, you could create code which prompts the user for the pattern parameters and then creates the holes, but that does not make for very reusable code. For example, what if you sometimes get a text file with many bolt hole definitions in it. You would not want the user to have to run the code over and over, inputting that information.</p>
<p>It would be better if the bolt hole pattern was a separate function, and then you could call that function from different procedures, such as one procedure to prompt the user for the information and another to read it from a file. The bolt hole had many parameters though, such as the diameter of the pattern, the diameter of each hole, the center of the pattern, and possibly several more. To set up local variables for these values and then pass all of them at once to a function can make for some long code.</p>
<p>That is where the classes come into play. We can define a class for out bolt hole patterns that contains all of the values we need as properties, and includes the procedures (methods) for drawing the pattern using those properties. This will make for much more portable, easier to maintain, and reusable code.</p>
<p>Define a class for creating a bolt hole pattern:</p>
<div class="tab"> <div class="tablinks" onclick="openTab(event, &apos;CShsnippet&apos;, &apos;tabcontent1&apos;, &apos;tablinks&apos;)">C#</div> </div><div id="CShsnippet" class="tabcontent1"> <div class="fragment"><div class="line"> </div>
<div class="line">    <span class="keyword">class </span>BoltHolePatternHandler</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">private</span> readonly Esprit.Application _espritApplication;</div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">double</span> HoleDiameter;</div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">double</span> PatternDiameter;</div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">int</span> NumberOfHoles;</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">public</span> BoltHolePatternHandler(Esprit.Application app)</div>
<div class="line">        {</div>
<div class="line">            _espritApplication = app;</div>
<div class="line">            <span class="keywordflow">if</span> (_espritApplication.Document.SystemUnit == EspritConstants.espUnitType.espInch)</div>
<div class="line">            {</div>
<div class="line">                HoleDiameter = 1;</div>
<div class="line">                PatternDiameter = 10;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                HoleDiameter = 25;</div>
<div class="line">                PatternDiameter = 250;</div>
<div class="line">            }</div>
<div class="line">            NumberOfHoles = 10;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">void</span> DrawPattern(Esprit.Point point)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (point == <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (var i = 0; i &lt; NumberOfHoles; i++)</div>
<div class="line">            {</div>
<div class="line">                var angle = i * 2 * Math.PI / NumberOfHoles;</div>
<div class="line">                var x = (PatternDiameter / 2) * Math.Cos(angle) + point.X;</div>
<div class="line">                var y = (PatternDiameter / 2) * Math.Sin(angle) + point.Y;</div>
<div class="line">                _espritApplication.Document.Circles.Add(_espritApplication.Document.GetPoint(x, y, 0), HoleDiameter / 2.0);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            _espritApplication.Document.Refresh();</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>Now we can ask the user for input values and use the class functionality:</p>
<div class="tab"> <div class="tablinks2" onclick="openTab(event, &apos;CShsnippet2&apos;, &apos;tabcontent2&apos;, &apos;tablinks2&apos;)">C#</div> </div><div id="CShsnippet2" class="tabcontent2"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> BoltHolePatternHandler _boltHolePattern = <span class="keyword">null</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">void</span> MakeBoltHolePattern()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (_boltHolePattern == <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                _boltHolePattern = <span class="keyword">new</span> BoltHolePatternHandler(EspritApplication);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            var holeDiameter = _boltHolePattern.HoleDiameter;</div>
<div class="line">            var patternDiameter = _boltHolePattern.PatternDiameter;</div>
<div class="line">            var numberOfHoles = _boltHolePattern.NumberOfHoles;</div>
<div class="line">            </div>
<div class="line">            <span class="keywordflow">if</span> (RequestUserInput(<span class="stringliteral">&quot;Enter Hole Diameter&quot;</span>, <span class="stringliteral">&quot;Hole Diameter&quot;</span>, ref holeDiameter) &amp;&amp;</div>
<div class="line">                RequestUserInput(<span class="stringliteral">&quot;Enter Pattern Diameter&quot;</span>, <span class="stringliteral">&quot;Pattern Diameter&quot;</span>, ref patternDiameter) &amp;&amp;</div>
<div class="line">                RequestUserInput(<span class="stringliteral">&quot;Enter Number of Holes&quot;</span>, <span class="stringliteral">&quot;Holes&quot;</span>, ref numberOfHoles))</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (holeDiameter &gt; 0 &amp;&amp; patternDiameter &gt; 0 &amp;&amp; numberOfHoles &gt; 0)</div>
<div class="line">                {</div>
<div class="line">                    _boltHolePattern.HoleDiameter = holeDiameter;</div>
<div class="line">                    _boltHolePattern.PatternDiameter = patternDiameter;</div>
<div class="line">                    _boltHolePattern.NumberOfHoles = numberOfHoles;</div>
<div class="line"> </div>
<div class="line">                    Esprit.Point point = <span class="keyword">null</span>;</div>
<div class="line">                    <span class="keywordflow">try</span></div>
<div class="line">                    {</div>
<div class="line">                        point = Document.GetPoint(<span class="stringliteral">&quot;Pick The Pattern Center&quot;</span>);</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">                    {</div>
<div class="line">                        <span class="comment">// Point was not set</span></div>
<div class="line">                        <span class="keywordflow">return</span>;</div>
<div class="line">                    }</div>
<div class="line"> </div>
<div class="line">                    _boltHolePattern.DrawPattern(point);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/>
<script type="text/javascript" src="restoreTabs.js"></script>
</body>
</html>
