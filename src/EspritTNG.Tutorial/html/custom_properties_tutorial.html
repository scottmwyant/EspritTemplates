<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Introduction to Custom Properties</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="tutorial.css" rel="stylesheet" type="text/css" />
<link href="tab.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="tab.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Introduction to Custom Properties </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This tutorial introduces the ability to add new properties to GraphicObjects. These custom properties can be added and accessed in the API through the CustomProperties collection of each GraphicObject. Like most other collection, CustomProperties will have a Count and an Item property, and Add and Remove methods. The Item property returns a CustomProperty object.</p>
<p>Each CustomProperty has the properties shown in the table below.</p>
<center> <br  />
 <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Property </th><th class="markdownTableHeadCenter">Type </th><th class="markdownTableHeadCenter">Function  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">Caption </td><td class="markdownTableBodyCenter">String </td><td class="markdownTableBodyCenter">The name displayed in the Property Browser.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">Name </td><td class="markdownTableBodyCenter">String </td><td class="markdownTableBodyCenter">The name used to index the object in the collection.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">ReadOnly </td><td class="markdownTableBodyCenter">Boolean </td><td class="markdownTableBodyCenter">Determines whether the Value can be changed through the Property Browser.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">Value </td><td class="markdownTableBodyCenter"></td><td class="markdownTableBodyCenter">The value of the CustomProperty.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">VariableType </td><td class="markdownTableBodyCenter">espPropertyType </td><td class="markdownTableBodyCenter">Determines whether the Value is a Boolean, Double, Long integer, or String.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">Visible </td><td class="markdownTableBodyCenter">Boolean </td><td class="markdownTableBodyCenter">Determines whether or not the item is visible in the PropertyBrowser.  </td></tr>
</table>
</center><p>As a simple example, let us say that you do not like working with Radius values on circles. Suppose that you want all of your circles to display a Diameter value. We just have to add a custom property called Diameter and set its Value to be twice the radius. In this case we can use Diameter for both the Name and the Caption. The Type will be espPropertyTypeDouble, since Diameter can have a decimal in it. The Value then will be two times the radius of that particular circle.</p>
<p><a class="anchor" id="AnchorAddOrUpdateDiameterPropertyOnCircles"></a> Start by making a function that will get a CustomProperty for us, similar to the GetSelectionSet function of Tutorial: Introduction to Feature Recognition, only in this case not only do we need to pass the name of the CustomProperty, but the type and the GraphicObject to which it belongs. Use the following code to update the Diameter custom property if it already exists, and to add it if it does not.</p>
<div class="tab"> <div class="tablinks" onclick="openTab(event, &apos;CShsnippet&apos;, &apos;tabcontent1&apos;, &apos;tablinks&apos;)">C#</div> </div><div id="CShsnippet" class="tabcontent1"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">static</span> <span class="keyword">public</span> EspritProperties.CustomProperty GetOrAddCustomProperty(Esprit.IGraphicObject graphicObject, <span class="keywordtype">string</span> name, EspritConstants.espPropertyType type)</div>
<div class="line">        {</div>
<div class="line">            EspritProperties.CustomProperty customProperty = graphicObject.CustomProperties.Item(name);</div>
<div class="line">            <span class="keywordflow">if</span> (customProperty != <span class="keyword">null</span> &amp;&amp; customProperty.VariableType != type)</div>
<div class="line">            {</div>
<div class="line">                graphicObject.CustomProperties.Remove(name);</div>
<div class="line">                customProperty = <span class="keyword">null</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (customProperty == <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                var properties = graphicObject.CustomProperties as EspritProperties.CustomProperties;</div>
<div class="line">                customProperty = (type == EspritConstants.espPropertyType.espPropertyTypeString)</div>
<div class="line">                    ? properties.Add(name, name, type, <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line">                    : properties.Add(name, name, type, 0);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> customProperty;</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>Now we can make a function that will loop through all of the circles in the document and use the function above to either find or create a Diameter custom property. Then we can set the value to be twice the radius.</p>
<div class="tab"> <div class="tablinks2" onclick="openTab(event, &apos;CShsnippet2&apos;, &apos;tabcontent2&apos;, &apos;tablinks2&apos;)">C#</div> </div><div id="CShsnippet2" class="tabcontent2"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">void</span> AddOrUpdateDiameterPropertyOnCircles()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">foreach</span>(Esprit.Circle circle in Document.Circles)</div>
<div class="line">            {</div>
<div class="line">                var <span class="keyword">property</span> = GraphicObjectHelper.GetOrAddCustomProperty(circle as Esprit.IGraphicObject, <span class="stringliteral">&quot;Diameter&quot;</span>, EspritConstants.espPropertyType.espPropertyTypeDouble);</div>
<div class="line">                <span class="keyword">property</span>.Caption = <span class="stringliteral">&quot;Diameter&quot;</span>;</div>
<div class="line">                <span class="keyword">property</span>.ReadOnly = <span class="keyword">true</span>;</div>
<div class="line">                <span class="keyword">property</span>.Value = 2 * circle.Radius;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>After changing some of the circle radius values, run this code on your file. You should see that all of the Diameter values are updated. Notice how this code makes the Diameter a Read-Only value by setting a ReadOnly value. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/>
<script type="text/javascript" src="restoreTabs.js"></script>
</body>
</html>
