<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Create Center Lines as Leaders</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="tutorial.css" rel="stylesheet" type="text/css" />
<link href="tab.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="tab.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Create Center Lines as Leaders </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This tutorial shows how to operate with the Leader and Notes objects created in the API. Leader objects are created using the AddLeader method of the Annotations collection. AddLeader is passed two points that represent the end and first vertex of the Leader. Additional vertices can be added through its LeaderPoints collection.</p>
<p>In Tutorial: Center Line Visible Circles segments were created as centerline dimension marks for circles. Segments are not good to use because we may have a lot of segments already in our geometry and if we Mask them or do other functions to them, the centerline marks will be included. Since these are used as dimension symbols, it would be more appropriate to use an object related to dimensioning. The Leader object is perfect for the job. Notice that the Leader has an ArrowType property, which can be set to espArrowNone, to make the leader look like a segment.</p>
<div class="tab"> <div class="tablinks" onclick="openTab(event, &apos;CShsnippet&apos;, &apos;tabcontent1&apos;, &apos;tablinks&apos;)">C#</div> </div><div id="CShsnippet" class="tabcontent1"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">void</span> CenterLinesAsLeaders()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (Document.Circles.Count == 0 &amp;&amp; Document.Arcs.Count == 0)</div>
<div class="line">            {</div>
<div class="line">                MessageBox.Show(<span class="stringliteral">&quot;There is no Arc or Circle&quot;</span>, <span class="stringliteral">&quot;CreateCenterLinesAsLeadersTutorial&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            var ratio1 = 1.15;</div>
<div class="line">            var ratio2 = 0.2;</div>
<div class="line">            var ratio3 = 0.4;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">foreach</span> (Esprit.Circle circle in Document.Circles)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (!circle.Grouped)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">continue</span>;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                var leaders = <span class="keyword">new</span> List&lt;Esprit.Leader&gt;();</div>
<div class="line">                leaders.Add(Document.Annotations.AddLeader(</div>
<div class="line">                    Document.GetPoint(circle.X - ratio1 * circle.Radius, circle.Y, circle.Z),</div>
<div class="line">                    Document.GetPoint(circle.X - ratio3 * circle.Radius, circle.Y, circle.Z))</div>
<div class="line">                );</div>
<div class="line"> </div>
<div class="line">                leaders.Add(Document.Annotations.AddLeader(</div>
<div class="line">                    Document.GetPoint(circle.X - ratio2 * circle.Radius, circle.Y, circle.Z),</div>
<div class="line">                    Document.GetPoint(circle.X + ratio2 * circle.Radius, circle.Y, circle.Z))</div>
<div class="line">                );</div>
<div class="line"> </div>
<div class="line">                leaders.Add(Document.Annotations.AddLeader(</div>
<div class="line">                    Document.GetPoint(circle.X + ratio3 * circle.Radius, circle.Y, circle.Z),</div>
<div class="line">                    Document.GetPoint(circle.X + ratio1 * circle.Radius, circle.Y, circle.Z))</div>
<div class="line">                );</div>
<div class="line"> </div>
<div class="line">                leaders.Add(Document.Annotations.AddLeader(</div>
<div class="line">                    Document.GetPoint(circle.X, circle.Y - ratio1 * circle.Radius, circle.Z),</div>
<div class="line">                    Document.GetPoint(circle.X, circle.Y - ratio3 * circle.Radius, circle.Z))</div>
<div class="line">                );</div>
<div class="line"> </div>
<div class="line">                leaders.Add(Document.Annotations.AddLeader(</div>
<div class="line">                    Document.GetPoint(circle.X, circle.Y - ratio2 * circle.Radius, circle.Z),</div>
<div class="line">                    Document.GetPoint(circle.X, circle.Y + ratio2 * circle.Radius, circle.Z))</div>
<div class="line">                );</div>
<div class="line"> </div>
<div class="line">                leaders.Add(Document.Annotations.AddLeader(</div>
<div class="line">                    Document.GetPoint(circle.X, circle.Y + ratio3 * circle.Radius, circle.Z),</div>
<div class="line">                    Document.GetPoint(circle.X, circle.Y + ratio1 * circle.Radius, circle.Z))</div>
<div class="line">                );</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">foreach</span>(var leader <span class="keywordflow">in</span> leaders)</div>
<div class="line">                {</div>
<div class="line">                    leader.ArrowType = EspritConstants.espArrowType.espArrowNone;</div>
<div class="line">                    leader.Layer = circle.Layer;</div>
<div class="line"> </div>
<div class="line">                    leader.Color = EspritApplication.Configuration.ConfigurationDimensions.Color;</div>
<div class="line">                    leader.LineType = EspritApplication.Configuration.ConfigurationDimensions.LineType;</div>
<div class="line">                    leader.LineWeight = EspritApplication.Configuration.ConfigurationDimensions.LineWeight;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">foreach</span> (Esprit.Arc arc in Document.Arcs)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (!arc.Grouped || Math.Abs(arc.EndAngle - arc.StartAngle) != 2 * Math.PI)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">continue</span>;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                var leaders = <span class="keyword">new</span> List&lt;Esprit.Leader&gt;();</div>
<div class="line">                leaders.Add(Document.Annotations.AddLeader(</div>
<div class="line">                    Document.GetPoint(arc.X - ratio1 * arc.Radius, arc.Y, arc.Z),</div>
<div class="line">                    Document.GetPoint(arc.X - ratio3 * arc.Radius, arc.Y, arc.Z))</div>
<div class="line">                );</div>
<div class="line"> </div>
<div class="line">                leaders.Add(Document.Annotations.AddLeader(</div>
<div class="line">                    Document.GetPoint(arc.X - ratio2 * arc.Radius, arc.Y, arc.Z),</div>
<div class="line">                    Document.GetPoint(arc.X + ratio2 * arc.Radius, arc.Y, arc.Z))</div>
<div class="line">                );</div>
<div class="line"> </div>
<div class="line">                leaders.Add(Document.Annotations.AddLeader(</div>
<div class="line">                    Document.GetPoint(arc.X + ratio3 * arc.Radius, arc.Y, arc.Z),</div>
<div class="line">                    Document.GetPoint(arc.X + ratio1 * arc.Radius, arc.Y, arc.Z))</div>
<div class="line">                );</div>
<div class="line"> </div>
<div class="line">                leaders.Add(Document.Annotations.AddLeader(</div>
<div class="line">                    Document.GetPoint(arc.X, arc.Y - ratio1 * arc.Radius, arc.Z),</div>
<div class="line">                    Document.GetPoint(arc.X, arc.Y - ratio3 * arc.Radius, arc.Z))</div>
<div class="line">                );</div>
<div class="line"> </div>
<div class="line">                leaders.Add(Document.Annotations.AddLeader(</div>
<div class="line">                    Document.GetPoint(arc.X, arc.Y - ratio2 * arc.Radius, arc.Z),</div>
<div class="line">                    Document.GetPoint(arc.X, arc.Y + ratio2 * arc.Radius, arc.Z))</div>
<div class="line">                );</div>
<div class="line"> </div>
<div class="line">                leaders.Add(Document.Annotations.AddLeader(</div>
<div class="line">                    Document.GetPoint(arc.X, arc.Y + ratio3 * arc.Radius, arc.Z),</div>
<div class="line">                    Document.GetPoint(arc.X, arc.Y + ratio1 * arc.Radius, arc.Z))</div>
<div class="line">                );</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">foreach</span> (var leader <span class="keywordflow">in</span> leaders)</div>
<div class="line">                {</div>
<div class="line">                    leader.ArrowType = EspritConstants.espArrowType.espArrowNone;</div>
<div class="line">                    leader.Layer = arc.Layer;</div>
<div class="line"> </div>
<div class="line">                    leader.Color = EspritApplication.Configuration.ConfigurationDimensions.Color;</div>
<div class="line">                    leader.LineType = EspritApplication.Configuration.ConfigurationDimensions.LineType;</div>
<div class="line">                    leader.LineWeight = EspritApplication.Configuration.ConfigurationDimensions.LineWeight;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            Document.Refresh();</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>Before running the code make sure you have some grouped circles or 360-degree arcs. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/>
<script type="text/javascript" src="restoreTabs.js"></script>
</body>
</html>
