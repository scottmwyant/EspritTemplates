<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Balanced Turning</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="tutorial.css" rel="stylesheet" type="text/css" />
<link href="tab.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="tab.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Balanced Turning </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Balanced turning allows users of multiple turret machines to optimize rough or finish turning operations. The operations may be set to have the one tool follow the other by a prescribed distance (Trailing Tool Balanced Mode) or have the two tools stay aligned in the Z-axis (Simultaneous Balanced Mode).</p>
<p>The command is named "Balanced Turning". In order for the operation to be enabled, the license must have bit 402 and the machine in the document must have more than one turret capable of working on the same spindle.</p>
<p>This tutorial shows how to create Balanced Turning operations via API. Two operations are created - Balanced Roughing and Balanced Finishing. You can look through the parameters of each operation in the opened Edit Window or just click OK.</p>
<p>Notice also that in order to avoid collision with the lower tool before the Balanced Roughing operation, the additional Sync code is created. It prevents the tool change and movement to the start position of the balanced turning cut until the facing roughing work is complete.</p>
<p>Before running the tutorial, load "C:\Program Files\D.P.Technology\ESPRIT TNG\Help\1033\API Tutorial Samples\Data\BalancedTurning\BalancedTurning.esprit".</p>
<div class="tab"> <div class="tablinks" onclick="openTab(event, &apos;CShsnippet&apos;, &apos;tabcontent1&apos;, &apos;tablinks&apos;)">C#</div> </div><div id="CShsnippet" class="tabcontent1"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> EspritTechnology.TechLatheBalanceRough2 CreateBalancedTurningTechnology()</div>
<div class="line">        {</div>
<div class="line">            EspritTechnology.TechLatheBalanceRough2 balancedTurning = <span class="keyword">new</span> EspritTechnology.TechLatheBalanceRough2()</div>
<div class="line">            {</div>
<div class="line">                SpindleSpeedRPM = 5000,</div>
<div class="line">                FeedratePR = 0.05,</div>
<div class="line">                SpeedUnit = EspritConstants.espSpindleSpeedUnit.espSpindleSpeedConstantSurface,</div>
<div class="line">                FeedUnit = EspritConstants.espFeedUnit.espFeedPerRevolution,</div>
<div class="line">                TransverseFeedratePercent = 50,</div>
<div class="line">                MaximumRPM = 6000,</div>
<div class="line">                ReferenceDiameter = 35,</div>
<div class="line">                CalculateStock = <span class="keyword">true</span>,</div>
<div class="line"> </div>
<div class="line">                TypeOfWork = EspritConstants.espGrooveWorkType.espGrooveWorkOD,</div>
<div class="line">                MasterChannel = EspritConstants.espBalancedTurningMasterChannel.espBalancedTurningMasterChannelLeading,</div>
<div class="line">                UndercuttingMode = EspritConstants.espLatheUndercuttingMode.espLatheUndercuttingYes,</div>
<div class="line">                CollisionDetection = <span class="keyword">true</span>,</div>
<div class="line"> </div>
<div class="line">                StockType = EspritConstants.espLatheRoughStockType.espLatheRoughStockLive,</div>
<div class="line"> </div>
<div class="line">                PullOutAngle = 45,</div>
<div class="line">                FinishLeadInType = EspritConstants.espLatheFinishLeadType.espLatheFinishLeadTangent,</div>
<div class="line">                FinishLeadOutType = EspritConstants.espLatheFinishLeadType.espLatheFinishLeadTangent,</div>
<div class="line"> </div>
<div class="line">                LeadOutAngle = 90,</div>
<div class="line">                ChamferAngle = 45,</div>
<div class="line">                ChamferDistance = 0.02,</div>
<div class="line"> </div>
<div class="line">                DepthOfCut = 1,</div>
<div class="line">                RetractPercentOfDepth = 100,</div>
<div class="line">                PullOutMode = EspritConstants.espPullOutType1.espPullOutAlongFeature,</div>
<div class="line">                DepthClearance = 2,</div>
<div class="line">                ClearanceAlongCut = 2,</div>
<div class="line">                LeadInType = EspritConstants.espLeadType.espLeadNormal,</div>
<div class="line">                LeadOutType = EspritConstants.espLeadType.espLeadNormal,</div>
<div class="line"> </div>
<div class="line">                EntryMode = EspritConstants.espLatheEntryMode1.espLatheEntry1None,</div>
<div class="line">                ExitMode = EspritConstants.espLatheExitMode1.espLatheExit1None,</div>
<div class="line">            };</div>
<div class="line"> </div>
<div class="line">            balancedTurning.TrailingToolDefinition[<span class="stringliteral">&quot;498&quot;</span>].Value = <span class="stringliteral">&quot;OD Lower&quot;</span>;</div>
<div class="line"> </div>
<div class="line">            var parameter = balancedTurning.TrailingToolDefinition.FindParameter(<span class="stringliteral">&quot;LatheToolOrientation&quot;</span>);</div>
<div class="line">            <span class="keywordflow">if</span> (parameter != <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                parameter.Value = EspritConstants.espLatheToolOrientation.espLatheToolOrientationReverseAngle;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            parameter = balancedTurning.TrailingToolDefinition.FindParameter(<span class="stringliteral">&quot;LatheToolOrientationAngle&quot;</span>);</div>
<div class="line">            <span class="keywordflow">if</span> (parameter != <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                parameter.Value = -180.0;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            parameter = balancedTurning.TrailingToolDefinition.FindParameter(<span class="stringliteral">&quot;CoolantOverride&quot;</span>);</div>
<div class="line">            <span class="keywordflow">if</span> (parameter != <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                parameter.Value = <span class="keyword">false</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            parameter = balancedTurning.TrailingToolDefinition.FindParameter(<span class="stringliteral">&quot;Coolant&quot;</span>);</div>
<div class="line">            <span class="keywordflow">if</span> (parameter != <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                parameter.Value = 0;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            parameter = balancedTurning.TrailingToolDefinition.FindParameter(<span class="stringliteral">&quot;CoolantPressure&quot;</span>);</div>
<div class="line">            <span class="keywordflow">if</span> (parameter != <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                parameter.Value = 1;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            parameter = balancedTurning.TrailingToolDefinition.FindParameter(<span class="stringliteral">&quot;WorkOffsetRotationPlane&quot;</span>);</div>
<div class="line">            <span class="keywordflow">if</span> (parameter != <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                parameter.Value = <span class="stringliteral">&quot;XYZ&quot;</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            parameter = balancedTurning.TrailingToolDefinition.FindParameter(<span class="stringliteral">&quot;AutomaticWorkOffsetRotation&quot;</span>);</div>
<div class="line">            <span class="keywordflow">if</span> (parameter != <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                parameter.Value = <span class="keyword">false</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            balancedTurning.LeadingToolDefinition[<span class="stringliteral">&quot;498&quot;</span>].Value = <span class="stringliteral">&quot;OD Upper&quot;</span>;</div>
<div class="line"> </div>
<div class="line">            parameter = balancedTurning.LeadingToolDefinition.FindParameter(<span class="stringliteral">&quot;CoolantOverride&quot;</span>);</div>
<div class="line">            <span class="keywordflow">if</span> (parameter != <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                parameter.Value = <span class="keyword">false</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            parameter = balancedTurning.LeadingToolDefinition.FindParameter(<span class="stringliteral">&quot;LatheToolOrientation&quot;</span>);</div>
<div class="line">            <span class="keywordflow">if</span> (parameter != <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                parameter.Value = EspritConstants.espLatheToolOrientation.espLatheToolOrientationAngle;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            parameter = balancedTurning.LeadingToolDefinition.FindParameter(<span class="stringliteral">&quot;LatheToolOrientationAngle&quot;</span>);</div>
<div class="line">            <span class="keywordflow">if</span> (parameter != <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                parameter.Value = 0;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            parameter = balancedTurning.LeadingToolDefinition.FindParameter(<span class="stringliteral">&quot;Coolant&quot;</span>);</div>
<div class="line">            <span class="keywordflow">if</span> (parameter != <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                parameter.Value = 0;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            parameter = balancedTurning.LeadingToolDefinition.FindParameter(<span class="stringliteral">&quot;CoolantPressure&quot;</span>);</div>
<div class="line">            <span class="keywordflow">if</span> (parameter != <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                parameter.Value = 1;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            parameter = balancedTurning.LeadingToolDefinition.FindParameter(<span class="stringliteral">&quot;AutomaticWorkOffsetRotation&quot;</span>);</div>
<div class="line">            <span class="keywordflow">if</span> (parameter != <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                parameter.Value = <span class="keyword">false</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            parameter = balancedTurning.LeadingToolDefinition.FindParameter(<span class="stringliteral">&quot;WorkOffsetRotationPlane&quot;</span>);</div>
<div class="line">            <span class="keywordflow">if</span> (parameter != <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                parameter.Value = <span class="stringliteral">&quot;XYZ&quot;</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> balancedTurning;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> BalancedTurning()</div>
<div class="line">        {</div>
<div class="line">            var balancedTurning = CreateBalancedTurningTechnology();</div>
<div class="line">            balancedTurning.OperationName = <span class="stringliteral">&quot;Balanced Roughing&quot;</span>;</div>
<div class="line">            balancedTurning.PinchTurningMode = EspritConstants.espPinchTurningMode.espPinchTurningModeTrailingTool;</div>
<div class="line">            balancedTurning.TrailingDistance = 1;</div>
<div class="line">            balancedTurning.ZStockForRough = 0.5;</div>
<div class="line">            balancedTurning.XStockForRough = 0.5;</div>
<div class="line">            balancedTurning.FinishUseFeedSpeedKB = <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line">            Document.GUI.EditTechnology(balancedTurning);</div>
<div class="line"> </div>
<div class="line">            Document.Group.Clear();</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">foreach</span> (Esprit.FeatureChain feature in Document.FeatureChains)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (feature.Name == <span class="stringliteral">&quot;2 Chain&quot;</span>)</div>
<div class="line">                {</div>
<div class="line">                    Document.Group.Add(feature);</div>
<div class="line">                    Document.PartOperations.Add(balancedTurning, feature);</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            var syncPosition1 = Document.Program.Channels[1].ChannelItems[5].Before;</div>
<div class="line">            var syncPosition2 = Document.Program.Channels[2].ChannelItems[1].Before;</div>
<div class="line">            Document.Program.Syncs.Add(syncPosition1, syncPosition2);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> BalancedFinishing()</div>
<div class="line">        {</div>
<div class="line">            var balancedTurning = CreateBalancedTurningTechnology();</div>
<div class="line">            balancedTurning.OperationName = <span class="stringliteral">&quot;Balanced Finishing&quot;</span>;</div>
<div class="line">            balancedTurning.PinchTurningMode = EspritConstants.espPinchTurningMode.espPinchTurningModeSimultaneous;</div>
<div class="line">            balancedTurning.OutputRoughPasses = <span class="keyword">false</span>;</div>
<div class="line">            balancedTurning.FinishPass = <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line">            balancedTurning.ZStockForRough = 0;</div>
<div class="line">            balancedTurning.XStockForRough = 0;</div>
<div class="line"> </div>
<div class="line">            balancedTurning.FinishSpindleSpeedRPM = 6000;</div>
<div class="line">            balancedTurning.FinishFeedratePR = 0.05;</div>
<div class="line">            balancedTurning.FinishLeadInTangentDistance = 1;</div>
<div class="line"> </div>
<div class="line">            balancedTurning.FinishLeadInType = EspritConstants.espLatheFinishLeadType.espLatheFinishLeadTangent;</div>
<div class="line"> </div>
<div class="line">            balancedTurning.FinishUseFeedSpeedKB = <span class="keyword">false</span>;</div>
<div class="line">            balancedTurning.TrailingDistance = 1;</div>
<div class="line"> </div>
<div class="line">            Document.Group.Clear();</div>
<div class="line"> </div>
<div class="line">            Document.GUI.EditTechnology(balancedTurning);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">foreach</span> (Esprit.FeatureChain feature in Document.FeatureChains)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (feature.Name == <span class="stringliteral">&quot;2 Chain&quot;</span>)</div>
<div class="line">                {</div>
<div class="line">                    Document.Group.Add(feature);</div>
<div class="line">                    Document.PartOperations.Add(balancedTurning, feature);</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/>
<script type="text/javascript" src="restoreTabs.js"></script>
</body>
</html>
