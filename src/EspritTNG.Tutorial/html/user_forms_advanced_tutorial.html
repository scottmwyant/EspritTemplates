<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Even More on UserForms</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="tutorial.css" rel="stylesheet" type="text/css" />
<link href="tab.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="tab.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Even More on UserForms </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The Tutorial: More On UserForms showed how to use a form to have the user enter certain information, and actually change that form depending upon an option that the user could choose. But notice that there is a lot of wasted real estate and redundant controls on the form - each option uses a different set of 3 Label and 3 TextBox controls. This tutorial shows how could options share just one set of controls, and simply have their meaning change based on which option was chosen.</p>
<p>There are two RadioButton controls on the form that present the user with the option of either a fixed increment of any number of passes or with 3 passes of specified increments:</p>
<center> <table style="border: 0px solid transparent;">
<tr>
<td valign="top"><img src="UserFormsAdvancedStockTutorial.png" alt="" hspace="50" class="inline"/> </td><td valign="top"><img src="UserFormsAdvancedEvenTutorial.png" alt="" hspace="50" class="inline"/>  </td></tr>
</table>
</center><p>Remember that the (Name) property is the most critical property of each control, as well as of the form itself, because it is by this name that we refer to the control.</p>
<p>The properties of each control should have the following values:</p>
<center> <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Object Type </th><th class="markdownTableHeadCenter">Name  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">UserForm </td><td class="markdownTableBodyCenter">frmUserFormsAdvancedTutorial  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">RadioButton </td><td class="markdownTableBodyCenter">optEvenPasses  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">RadioButton </td><td class="markdownTableBodyCenter">optSpecifyStock  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">Label </td><td class="markdownTableBodyCenter">Label1  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">Label </td><td class="markdownTableBodyCenter">Label2  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">Label </td><td class="markdownTableBodyCenter">Label3  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">TextBox </td><td class="markdownTableBodyCenter">TextBox1  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">TextBox </td><td class="markdownTableBodyCenter">TextBox2  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">TextBox </td><td class="markdownTableBodyCenter">TextBox3  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">CommandButton </td><td class="markdownTableBodyCenter">cmdEditTechnology  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">CommandButton </td><td class="markdownTableBodyCenter">cmdOK  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">CommandButton </td><td class="markdownTableBodyCenter">cmdCancel  </td></tr>
</table>
</center><p>Arrange the control on the form and align them if you like. When you are finished, assosiate the following event procedures with the form:</p>
<ul>
<li>OK Button:</li>
</ul>
<div class="tab"> <div class="tablinks1" onclick="openTab(event, &apos;CShsnippet1&apos;, &apos;tabcontent1&apos;, &apos;tablinks1&apos;)">C#</div> </div><div id="CShsnippet1" class="tabcontent1"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnButtonOkClick(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (_techMillContour1.ToolID == <span class="keywordtype">string</span>.Empty)</div>
<div class="line">            {</div>
<div class="line">                MessageBox.Show(<span class="stringliteral">&quot;No tool was found. Press Edit Technology button to select a tool&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            var initializedValue = <span class="keyword">true</span>;</div>
<div class="line">            <span class="keywordtype">int</span> numberOfPasses;</div>
<div class="line">            <span class="keywordtype">double</span> initialStock = 0;</div>
<div class="line">            <span class="keywordtype">double</span> finalStock = 0;</div>
<div class="line">            var stockValue = <span class="keyword">new</span> <span class="keywordtype">double</span>[3];</div>
<div class="line">            var isEvenPassesChecked = optEvenPasses.Checked;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (isEvenPassesChecked)</div>
<div class="line">            {</div>
<div class="line">                initializedValue &amp;= <span class="keywordtype">int</span>.TryParse(textBox1.Text, out numberOfPasses);</div>
<div class="line">                initializedValue &amp;= <span class="keywordtype">double</span>.TryParse(textBox2.Text, out initialStock);</div>
<div class="line">                initializedValue &amp;= <span class="keywordtype">double</span>.TryParse(textBox3.Text, out finalStock);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                numberOfPasses = 3;</div>
<div class="line">                initializedValue &amp;= <span class="keywordtype">double</span>.TryParse(textBox1.Text, out stockValue[0]);</div>
<div class="line">                initializedValue &amp;= <span class="keywordtype">double</span>.TryParse(textBox2.Text, out stockValue[1]);</div>
<div class="line">                initializedValue &amp;= <span class="keywordtype">double</span>.TryParse(textBox3.Text, out stockValue[2]);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (!initializedValue || numberOfPasses &lt; 2)</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">            CloseForm();</div>
<div class="line"> </div>
<div class="line">            Esprit.FeatureChain featureChain = <span class="keyword">null</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                featureChain = Document.GetAnyElement(<span class="stringliteral">&quot;Select Reference Feature&quot;</span>, EspritConstants.espGraphicObjectType.espFeatureChain) as Esprit.FeatureChain;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// Element was not set</span></div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (featureChain == <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> ((_techMillContour1.LeadInType == EspritConstants.espMillLeadinType.espMillLeadinPosition) ||</div>
<div class="line">                                   (_techMillContour1.LeadInType == EspritConstants.espMillLeadinType.espMillLeadinPositionRadius) ||</div>
<div class="line">                                   (_techMillContour1.LeadInType == EspritConstants.espMillLeadinType.espMillLeadinPositionRadiusNormal))</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">try</span></div>
<div class="line">                {</div>
<div class="line">                    featureChain.LeadInPoint = Document.GetPoint(<span class="stringliteral">&quot;Select Entry Point&quot;</span>);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">                {</div>
<div class="line">                    <span class="comment">// Element was not set</span></div>
<div class="line">                    <span class="keywordflow">return</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> ((_techMillContour1.LeadOutType == EspritConstants.espMillLeadoutType.espMillLeadoutPosition) ||</div>
<div class="line">               (_techMillContour1.LeadOutType == EspritConstants.espMillLeadoutType.espMillLeadoutPositionRadius) ||</div>
<div class="line">               (_techMillContour1.LeadOutType == EspritConstants.espMillLeadoutType.espMillLeadoutPositionRadiusNormal))</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">try</span></div>
<div class="line">                {</div>
<div class="line">                    featureChain.LeadOutPoint = Document.GetPoint(<span class="stringliteral">&quot;Select Exit Point&quot;</span>);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">                {</div>
<div class="line">                    <span class="comment">// Element was not set</span></div>
<div class="line">                    <span class="keywordflow">return</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (isEvenPassesChecked)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordtype">double</span> stockIncrement = (initialStock - finalStock) / (numberOfPasses - 1);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">for</span> (var i = 0; i &lt; numberOfPasses; i++)</div>
<div class="line">                {</div>
<div class="line">                    _techMillContour1.StockAllowance = initialStock - i * stockIncrement;</div>
<div class="line">                    <span class="keywordflow">try</span></div>
<div class="line">                    {</div>
<div class="line">                        Document.PartOperations.Add(_techMillContour1, featureChain);</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">                    {</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">for</span> (var i = 0; i &lt; numberOfPasses; i++)</div>
<div class="line">                {</div>
<div class="line">                    _techMillContour1.StockAllowance = stockValue[i];</div>
<div class="line">                    <span class="keywordflow">try</span></div>
<div class="line">                    {</div>
<div class="line">                        Document.PartOperations.Add(_techMillContour1, featureChain);</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">                    {</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            Document.Refresh();</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><ul>
<li>Cancel Button:</li>
</ul>
<div class="tab"> <div class="tablinks2" onclick="openTab(event, &apos;CShsnippet2&apos;, &apos;tabcontent2&apos;, &apos;tablinks2&apos;)">C#</div> </div><div id="CShsnippet2" class="tabcontent2"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnCancelButtonClick(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            CloseForm();</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keywordtype">void</span> CloseForm()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (_form != <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                _form.Close();</div>
<div class="line">                _form = <span class="keyword">null</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><ul>
<li>Edit Technology Button:</li>
</ul>
<div class="tab"> <div class="tablinks3" onclick="openTab(event, &apos;CShsnippet3&apos;, &apos;tabcontent3&apos;, &apos;tablinks3&apos;)">C#</div> </div><div id="CShsnippet3" class="tabcontent3"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnEditTechnologyButtonClick(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            var tools = Document.Tools as EspritTools.Tools;</div>
<div class="line"> </div>
<div class="line">            EspritConstants.espGuiReturnVal res = EspritConstants.espGuiReturnVal.espGuiComplete;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (tools.Count == 0)</div>
<div class="line">            {</div>
<div class="line">                var technologyUtility = Document.TechnologyUtility as EspritTechnology.TechnologyUtility;</div>
<div class="line">                var toolEndMill = technologyUtility.CreateTechnology(EspritConstants.espTechnologyType.espToolMillEndMill, Document.SystemUnit);</div>
<div class="line"> </div>
<div class="line">                var parameter = toolEndMill.FindParameter(<span class="stringliteral">&quot;ToolID&quot;</span>);</div>
<div class="line">                <span class="keywordflow">if</span> (parameter != <span class="keyword">null</span>)</div>
<div class="line">                {</div>
<div class="line">                    parameter.Value = <span class="stringliteral">&quot;EM 3&quot;</span>;</div>
<div class="line">                }</div>
<div class="line">                parameter = toolEndMill.FindParameter(<span class="stringliteral">&quot;Comment&quot;</span>);</div>
<div class="line">                <span class="keywordflow">if</span> (parameter != <span class="keyword">null</span>)</div>
<div class="line">                {</div>
<div class="line">                    parameter.Value = <span class="stringliteral">&quot;This endmill was added by tutorial extension&quot;</span>;</div>
<div class="line">                }</div>
<div class="line">                parameter = toolEndMill.FindParameter(<span class="stringliteral">&quot;ToolNumber&quot;</span>);</div>
<div class="line">                <span class="keywordflow">if</span> (parameter != <span class="keyword">null</span>)</div>
<div class="line">                {</div>
<div class="line">                    parameter.Value = 3;</div>
<div class="line">                }</div>
<div class="line">                parameter = toolEndMill.FindParameter(<span class="stringliteral">&quot;Coolant&quot;</span>);</div>
<div class="line">                <span class="keywordflow">if</span> (parameter != <span class="keyword">null</span>)</div>
<div class="line">                {</div>
<div class="line">                    parameter.Value = EspritConstants.espCoolantType.espCoolantOn;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                res = Document.GUI.EditTool(toolEndMill);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (res != EspritConstants.espGuiReturnVal.espGuiCancel)</div>
<div class="line">                {</div>
<div class="line">                    tools.Add(toolEndMill);</div>
<div class="line">                    _techMillContour1.ToolID = toolEndMill.Caption;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (res != EspritConstants.espGuiReturnVal.espGuiCancel)</div>
<div class="line">            {</div>
<div class="line">                Document.GUI.EditTechnology(_techMillContour1);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><ul>
<li>Events to sepcify a fixed increment of any number of passes or 3 passes of specified increments:</li>
</ul>
<div class="tab"> <div class="tablinks6" onclick="openTab(event, &apos;CShsnippet6&apos;, &apos;tabcontent6&apos;, &apos;tablinks6&apos;)">C#</div> </div><div id="CShsnippet6" class="tabcontent6"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnSpecifyStockCheckedChanged(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            SpecifyStock();</div>
<div class="line">            _form.Refresh();</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> SpecifyStock()</div>
<div class="line">        {</div>
<div class="line">            label1.Text = <span class="stringliteral">&quot;Stock on Pass 1&quot;</span>;</div>
<div class="line">            label2.Text = <span class="stringliteral">&quot;Stock on Pass 2&quot;</span>;</div>
<div class="line">            label3.Text = <span class="stringliteral">&quot;Stock on Pass 3&quot;</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (Document.SystemUnit == EspritConstants.espUnitType.espMetric)</div>
<div class="line">            {</div>
<div class="line">                textBox1.Text = <span class="stringliteral">&quot;10&quot;</span>;</div>
<div class="line">                textBox2.Text = <span class="stringliteral">&quot;5&quot;</span>;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                textBox1.Text = <span class="stringliteral">&quot;0.5&quot;</span>;</div>
<div class="line">                textBox2.Text = <span class="stringliteral">&quot;0.25&quot;</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            textBox3.Text = <span class="stringliteral">&quot;0&quot;</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnEvenPassesStockCheckedChanged(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            SpecifyEvenPasses();</div>
<div class="line">            _form.Refresh();</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> SpecifyEvenPasses()</div>
<div class="line">        {</div>
<div class="line">            label1.Text = <span class="stringliteral">&quot;Number of Passes&quot;</span>;</div>
<div class="line">            label2.Text = <span class="stringliteral">&quot;Initial Stock&quot;</span>;</div>
<div class="line">            label3.Text = <span class="stringliteral">&quot;Final Stock&quot;</span>;</div>
<div class="line"> </div>
<div class="line">            textBox1.Text = <span class="stringliteral">&quot;4&quot;</span>;</div>
<div class="line">            textBox3.Text = <span class="stringliteral">&quot;0&quot;</span>;</div>
<div class="line"> </div>
<div class="line">            textBox2.Text = (Document.SystemUnit == EspritConstants.espUnitType.espMetric)</div>
<div class="line">                ? <span class="stringliteral">&quot;12.5&quot;</span></div>
<div class="line">                : <span class="stringliteral">&quot;0.5&quot;</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>To launch the tutorial execute the following code in your main procedure:</p>
<div class="tab"> <div class="tablinks5" onclick="openTab(event, &apos;CShsnippet5&apos;, &apos;tabcontent5&apos;, &apos;tablinks5&apos;)">C#</div> </div><div id="CShsnippet5" class="tabcontent5"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">void</span> MultiPassContourFormAdvanced()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (_techMillContour1 == <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                _techMillContour1 = <span class="keyword">new</span> EspritTechnology.TechMillContour1();</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (_form == <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                Show();</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/>
<script type="text/javascript" src="restoreTabs.js"></script>
</body>
</html>
