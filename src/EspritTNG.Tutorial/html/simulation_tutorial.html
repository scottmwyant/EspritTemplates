<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Simulation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="tutorial.css" rel="stylesheet" type="text/css" />
<link href="tab.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="tab.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Simulation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This tutorial shows the key points of simulation in ESPRIT. The simulation is accessed through the Document.Simulation object. Running the simulation is quite easy - all you have to do is call the Play method.</p>
<p>In this tutorial we will create a form that allows to use the basic simulation commands.</p>
<p>Arrange the controls on the form and align them if you like. When you are finished, your form should look similar to the one below.</p>
<div class="image">
<img src="SimulationTutorial.png" alt=""/>
</div>
<p>Set the properties of each control to the following values:</p>
<center> <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Object Type </th><th class="markdownTableHeadCenter">Name </th><th class="markdownTableHeadCenter">Properties  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">UserForm </td><td class="markdownTableBodyCenter">frmSimulationTutorial </td><td class="markdownTableBodyCenter">Caption = SimulationTutorial  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">Label </td><td class="markdownTableBodyCenter">lblFeedSpeed </td><td class="markdownTableBodyCenter">Caption = Change play Feed speed:  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">Label </td><td class="markdownTableBodyCenter">lblRapidSpeed </td><td class="markdownTableBodyCenter">Caption = Change play Rapid speed:  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">CheckBox </td><td class="markdownTableBodyCenter">chCollisions </td><td class="markdownTableBodyCenter">Caption = Detect collisions  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">CheckBox </td><td class="markdownTableBodyCenter">chNCCoordinateSystem </td><td class="markdownTableBodyCenter">Caption = NC coordinate system  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">CheckBox </td><td class="markdownTableBodyCenter">chPartViolation </td><td class="markdownTableBodyCenter">Caption = Part violation  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">CheckBox </td><td class="markdownTableBodyCenter">chStopCode </td><td class="markdownTableBodyCenter">Caption = Stop code  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">CheckBox </td><td class="markdownTableBodyCenter">chTraceToolpath </td><td class="markdownTableBodyCenter">Caption = Trace toolpath  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">ScrollBar </td><td class="markdownTableBodyCenter">sbFeed </td><td class="markdownTableBodyCenter"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">ScrollBar </td><td class="markdownTableBodyCenter">sbRapid </td><td class="markdownTableBodyCenter"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">CommandButton </td><td class="markdownTableBodyCenter">cmdPlay </td><td class="markdownTableBodyCenter">Caption = Play  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">CommandButton </td><td class="markdownTableBodyCenter">cmdPause </td><td class="markdownTableBodyCenter">Caption = Pause  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">CommandButton </td><td class="markdownTableBodyCenter">cmdStop </td><td class="markdownTableBodyCenter">Caption = Stop  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">CommandButton </td><td class="markdownTableBodyCenter">cmdStep </td><td class="markdownTableBodyCenter">Caption = Step  </td></tr>
</table>
</center><p>Assosiate the following event procedures with the form:</p>
<ul>
<li>Play Button - start simulation or resume it after pause:</li>
</ul>
<div class="tab"> <div class="tablinks1" onclick="openTab(event, &apos;CShsnippet1&apos;, &apos;tabcontent1&apos;, &apos;tablinks1&apos;)">C#</div> </div><div id="CShsnippet1" class="tabcontent1"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnPlayButtonClick(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            Document.Simulation.Play();</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><ul>
<li>Pause Button - temporarily stop the simulation:</li>
</ul>
<div class="tab"> <div class="tablinks2" onclick="openTab(event, &apos;CShsnippet2&apos;, &apos;tabcontent2&apos;, &apos;tablinks2&apos;)">C#</div> </div><div id="CShsnippet2" class="tabcontent2"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnPauseButtonClick(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            Document.Simulation.Pause();</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><ul>
<li>Stop Button - stop the simulation and exit the simulation mode:</li>
</ul>
<div class="tab"> <div class="tablinks3" onclick="openTab(event, &apos;CShsnippet3&apos;, &apos;tabcontent3&apos;, &apos;tablinks3&apos;)">C#</div> </div><div id="CShsnippet3" class="tabcontent3"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnStopButtonClick(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            Document.Simulation.Stop();</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><ul>
<li>Step Button - move simulation to the next step:</li>
</ul>
<div class="tab"> <div class="tablinks6" onclick="openTab(event, &apos;CShsnippet6&apos;, &apos;tabcontent6&apos;, &apos;tablinks6&apos;)">C#</div> </div><div id="CShsnippet6" class="tabcontent6"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnStepButtonClick(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            Document.Simulation.Step();</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>Before running the tutorial, create new or open a file that has several operations on it.</p>
<p>ESPRIT API allows the user to change the simulation color of each cutting tool. The following code automatically changes the SimulationColor property of each tool:</p>
<div class="tab"> <div class="tablinks4" onclick="openTab(event, &apos;CShsnippet4&apos;, &apos;tabcontent4&apos;, &apos;tablinks4&apos;)">C#</div> </div><div id="CShsnippet4" class="tabcontent4"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> SimulateWithChangingColor()</div>
<div class="line">        {</div>
<div class="line">            Random rnd = <span class="keyword">new</span> Random();</div>
<div class="line">            var tools = Document.Tools as EspritTools.Tools;</div>
<div class="line">            <span class="keywordflow">foreach</span> (EspritTechnology.Tool technology in tools)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (technology == <span class="keyword">null</span>)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">continue</span>;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                System.Drawing.Color color = System.Drawing.Color.FromArgb(0, 0, 0);</div>
<div class="line">                var value = 255 - 100 * rnd.Next(rnd.Next(2));</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">switch</span> (rnd.Next(3))</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">case</span> 0:</div>
<div class="line">                        color = System.Drawing.Color.FromArgb(value, 0, 0);</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> 1:</div>
<div class="line">                        color = System.Drawing.Color.FromArgb(0, value, 0);</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> 2:</div>
<div class="line">                        color = System.Drawing.Color.FromArgb(0, 0, value);</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                technology.SimulationColor = (int)ColorHelper.ColorToUInt(color);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> uint ColorToUInt(System.Drawing.Color color)</div>
<div class="line">        {</div>
<div class="line">            var value = (uint)((color.A &lt;&lt; 24) | (color.B &lt;&lt; 16) |</div>
<div class="line">                               (color.G &lt;&lt; 8) | color.R);</div>
<div class="line">            <span class="keywordflow">return</span> value;</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>It is also possible to manage "Collision detection"/"NC coordinate system"/"Part violation"/"Stop code"/"Trace toolpath" state and simulation feed and rapid speed through the API.</p>
<div class="tab"> <div class="tablinks5" onclick="openTab(event, &apos;CShsnippet5&apos;, &apos;tabcontent5&apos;, &apos;tablinks5&apos;)">C#</div> </div><div id="CShsnippet5" class="tabcontent5"> <div> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnCollisionsCheckBoxCheckedChanged(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            Document.Simulation.CollisionDetection = _collisionsCheckBox.Checked;</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnNCCoordinateSystemCheckBoxCheckedChanged(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            Document.Simulation.NCCoordinateSystem = _ncCoordinateSystemCheckBox.Checked;</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnPartViolationCheckBoxCheckedChanged(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            Document.Simulation.PartViolationDetection = _partViolationCheckBox.Checked;</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnStopCodeCheckBoxCheckedChanged(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            Document.Simulation.StopCode = _stopCodeCheckBox.Checked;</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnTraceToolpathCheckBoxCheckedChanged(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            Document.Simulation.TraceToolpath = _traceToolpathCheckBox.Checked;</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div> <div> <div class="fragment"><div class="line"> </div>
<div class="line">            Document.Simulation.PlayFeedSpeed = speed;</div>
<div class="line"> </div>
</div><!-- fragment --> <div class="fragment"><div class="line"> </div>
<div class="line">            Document.Simulation.PlayRapidSpeed = speed;</div>
<div class="line"> </div>
</div><!-- fragment --></div> <div> Note that the value for feed speed must be in range [-0.2 ; 0.8] and for rapid speed - in range [-0.8; 0.2]. <br  />
 </div> </div> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/>
<script type="text/javascript" src="restoreTabs.js"></script>
</body>
</html>
