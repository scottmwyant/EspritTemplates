<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Using Technology From An Existing Operation on New Operations</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="tutorial.css" rel="stylesheet" type="text/css" />
<link href="tab.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="tab.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Using Technology From An Existing Operation on New Operations </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This tutorial shows how to take the technology from one existing operation, make a copy of it and create new operations with the same or similar technology. In this case the properties of the copy can be changed without affecting the properties of the original.</p>
<p>Note that this tutorial was originally written before the Mill Contour operation had settings for both Rough and Finish passes. That is why this tutorial does several contours, one for each rough pass and one for the finish. While this could now be done with one contour operation, this tutorial is still valid and a good exercise.</p>
<p>It may be useful in contouring to take several passes, starting at an outside stock allowance value and gradually decreasing the stock allowance. Previously, individual contour operations had to be created for this. What if we wanted to give the user a short cut, so that they just had to create the initial rough contour at the outermost stock allowance, and then from this rough contour the other contours would be created. We just need to prompt the user to pick the rough contour and give the total number of passes and the final stock allowance. Then we would take the technology of that rough contour and use that to create new contours, simply recalculating a new stock allowance value for each one.</p>
<p>Before running the code create a mill contour operation with the Stock Allowance set to the stock allowance for the initial pass.</p>
<div class="tab"> <div class="tablinks" onclick="openTab(event, &apos;CShsnippet&apos;, &apos;tabcontent1&apos;, &apos;tablinks&apos;)">C#</div> </div><div id="CShsnippet" class="tabcontent1"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">void</span> MultiPassContourImproved()</div>
<div class="line">        {</div>
<div class="line">            Esprit.IGraphicObject obj = <span class="keyword">null</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                obj = Document.GetAnyElement(<span class="stringliteral">&quot;Pick Rough Mill Contour&quot;</span>,</div>
<div class="line">                    espGraphicObjectType.espOperation);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// Element was not set</span></div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            var espOperation = obj as Esprit.PartOperation;</div>
<div class="line">            <span class="keywordflow">if</span> (espOperation == <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                System.Windows.MessageBox.Show(<span class="stringliteral">&quot;Must pick mill contour operation.&quot;</span>, <span class="stringliteral">&quot;TechnologiesAndOperationsTutorial&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line">            var roughOpTech = espOperation.Technology as EspritTechnology.Technology;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (roughOpTech.TechnologyType != espTechnologyType.espTechMillContour1)</div>
<div class="line">            {</div>
<div class="line">                System.Windows.MessageBox.Show(<span class="stringliteral">&quot;Must pick mill contour operation.&quot;</span>, <span class="stringliteral">&quot;TechnologiesAndOperationsTutorial&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line">            </div>
<div class="line">            var numberOfPasses = 4;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (RequestUserInput(<span class="stringliteral">&quot;Enter the Total Number of Passes&quot;</span>, <span class="stringliteral">&quot;Number of Passes&quot;</span>, ref numberOfPasses) &amp;&amp; numberOfPasses &gt; 1)</div>
<div class="line">            {</div>
<div class="line">                var mc = <span class="keyword">new</span> EspritTechnology.TechMillContour1();</div>
<div class="line">                roughOpTech.CopyTo(mc as ITechnology, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">                var finalStock = 0.0;</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (!RequestUserInput(<span class="stringliteral">&quot;Enter the Final Stock Allowance&quot;</span>, <span class="stringliteral">&quot;Final Stock &quot;</span>, ref finalStock))</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">return</span>;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                var stockIncrement = (mc.StockAllowance - finalStock) / (numberOfPasses - 1);</div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; numberOfPasses; i++)</div>
<div class="line">                {</div>
<div class="line">                    mc.StockAllowance -= stockIncrement;</div>
<div class="line"> </div>
<div class="line">                    Esprit.PartOperation operation = <span class="keyword">null</span>;</div>
<div class="line">                    <span class="keywordflow">try</span></div>
<div class="line">                    {</div>
<div class="line">                        operation = Document.PartOperations.Add(mc, espOperation.Feature);</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">                    {</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">if</span> (operation != <span class="keyword">null</span>)</div>
<div class="line">                    {</div>
<div class="line">                        operation.Color = espOperation.Color;</div>
<div class="line">                        operation.LineType = espOperation.LineType;</div>
<div class="line">                        operation.LineWeight = espOperation.LineWeight;</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/>
<script type="text/javascript" src="restoreTabs.js"></script>
</body>
</html>
