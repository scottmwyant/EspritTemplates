<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Move P0 to Arc or Circle Center or Point</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="tutorial.css" rel="stylesheet" type="text/css" />
<link href="tab.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="tab.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Move P0 to Arc or Circle Center or Point </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The Tutorial: Move P0 to Any Element Center used the GetAnyElement method to move P0 to an Arc or Circle center. However, when prompted to pick an arc or circle the user could have actually picked anything, such as a line for example. This did not produce an error, the code just continued without taking any further action. That was because we used separate If condition statements. Had we used a single If with an Else condition, we would have been in trouble.</p>
<p>This tutorial will allow the user to only pick either an arc or a circle or a point and nothing else. It will then respond appropriately based on the user's selection.</p>
<p>This will still rely on the GetAnyElement method of the Document. It uses an additional, optional argument to GetAnyElement that masks the GraphicObject types that can be chosen. This type mask is an array of espGraphicObjectType values. The espGraphicObjectType is an alternative to using TypeName to determine the type of a GraphicObject. espGraphicObjectType is an Enumerated Constant, which is an easier way of representing long integer value. The important thing about enumerated constants in ESPRIT is that they are all provided in the separate EspritConstants library.</p>
<div class="tab"> <div class="tablinks" onclick="openTab(event, &apos;CShsnippet&apos;, &apos;tabcontent1&apos;, &apos;tablinks&apos;)">C#</div> </div><div id="CShsnippet" class="tabcontent1"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">void</span> MoveP0ToArcOrCircleCenterOrPoint()</div>
<div class="line">        {</div>
<div class="line">            var typeMask = <span class="keyword">new</span> EspritConstants.espGraphicObjectType[3]</div>
<div class="line">            {</div>
<div class="line">                EspritConstants.espGraphicObjectType.espArc,</div>
<div class="line">                EspritConstants.espGraphicObjectType.espCircle,</div>
<div class="line">                EspritConstants.espGraphicObjectType.espPoint</div>
<div class="line">            };</div>
<div class="line"> </div>
<div class="line">            Esprit.IGraphicObject element = <span class="keyword">null</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                element = Document.GetAnyElement(<span class="stringliteral">&quot;Pick a Circle or Arc or Point&quot;</span>, typeMask);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// Element was not set</span></div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line">            </div>
<div class="line">            <span class="keywordflow">if</span> (element == <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">switch</span> (element.GraphicObjectType)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espArc:</div>
<div class="line">                    var arc = element as Esprit.Arc;</div>
<div class="line">                    Document.MoveP0(arc.CenterPoint);</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espCircle:</div>
<div class="line">                    var circle = element as Esprit.Circle;</div>
<div class="line">                    Document.MoveP0(circle.CenterPoint);</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espPoint:</div>
<div class="line">                    var point = element as Esprit.Point;</div>
<div class="line">                    Document.MoveP0(point);</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>Select on a circle or arc or point when prompted and watch the XYZ origin P0 move to that location. Notice that the ability to pick points includes SNAP and GRID points, so you may wish to turn those items off on the Status Bar to show that you cannot pick lines, segments, features, or graphical objects other that arcs, circles, and points. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/>
<script type="text/javascript" src="restoreTabs.js"></script>
</body>
</html>
