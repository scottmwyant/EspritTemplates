<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Expanding the Bolt Hole Pattern Class</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="tutorial.css" rel="stylesheet" type="text/css" />
<link href="tab.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="tab.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Expanding the Bolt Hole Pattern Class </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The Tutorial: Using Class Modules: Bolt Hole Pattern created a class for a bolt hole pattern. This tutorial will expand upon that class by adding several Methods for manipulating the pattern after its creation. A class method is really just any procedure or function.</p>
<p>Define a class for creating and manipulating a bolt hole pattern:</p>
<p><a class="anchor" id="AnchorRemoveHoles"></a> </p><div class="tab"> <div class="tablinks" onclick="openTab(event, &apos;CShsnippet&apos;, &apos;tabcontent1&apos;, &apos;tablinks&apos;)">C#</div> </div><div id="CShsnippet" class="tabcontent1"> <div class="fragment"><div class="line"> </div>
<div class="line">    <span class="keyword">class </span>BoltHolePatternExpandHandler : IDisposable</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">private</span> readonly Esprit.Application _espritApplication;</div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">double</span> HoleDiameter;</div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">double</span> PatternDiameter;</div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">double</span> StartAngleRad;</div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">int</span> NumberOfHoles;</div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">bool</span> IsBoltHoleCreated;</div>
<div class="line">        <span class="keyword">public</span> Esprit.Point LocalPatternCenter;</div>
<div class="line">        <span class="keyword">public</span> List&lt;Esprit.Circle&gt; Holes;</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">public</span> BoltHolePatternExpandHandler(Esprit.Application app)</div>
<div class="line">        {</div>
<div class="line">            _espritApplication = app;</div>
<div class="line">            <span class="keywordflow">if</span> (_espritApplication.Document.SystemUnit == EspritConstants.espUnitType.espInch)</div>
<div class="line">            {</div>
<div class="line">                HoleDiameter = 1;</div>
<div class="line">                PatternDiameter = 10;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                HoleDiameter = 25;</div>
<div class="line">                PatternDiameter = 250;</div>
<div class="line">            }</div>
<div class="line">            NumberOfHoles = 10;</div>
<div class="line">            StartAngleRad = 0;</div>
<div class="line">            LocalPatternCenter = <span class="keyword">null</span>;</div>
<div class="line">            Holes = <span class="keyword">new</span> List&lt;Esprit.Circle&gt;();</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">void</span> Dispose()</div>
<div class="line">        {</div>
<div class="line">            RemoveHoles();</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">void</span> RemoveHoles()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">foreach</span>(var hole <span class="keywordflow">in</span> Holes)</div>
<div class="line">            {</div>
<div class="line">                _espritApplication.Document.Circles.Remove(hole.Key);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            Holes.Clear();</div>
<div class="line">            _espritApplication.Document.Refresh();</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">void</span> Move(Esprit.Point point)</div>
<div class="line">        {</div>
<div class="line">            var xMove = point.X - LocalPatternCenter.X;</div>
<div class="line">            var yMove = point.Y - LocalPatternCenter.Y;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">foreach</span>(var hole <span class="keywordflow">in</span> Holes)</div>
<div class="line">            {</div>
<div class="line">                hole.X += xMove;</div>
<div class="line">                hole.Y += yMove;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            LocalPatternCenter = point;</div>
<div class="line">            _espritApplication.Document.Refresh();</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">public</span> List&lt;Esprit.Circle&gt; DrawPattern(Esprit.Point point)</div>
<div class="line">        {</div>
<div class="line">            RemoveHoles();</div>
<div class="line">            <span class="keywordflow">if</span> (point != <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                LocalPatternCenter = point;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (LocalPatternCenter != <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">for</span> (var i = 0; i &lt; NumberOfHoles; i++)</div>
<div class="line">                {</div>
<div class="line">                    var angle = StartAngleRad + i * 2 * Math.PI / NumberOfHoles;</div>
<div class="line">                    var x = (PatternDiameter / 2) * Math.Cos(angle) + LocalPatternCenter.X;</div>
<div class="line">                    var y = (PatternDiameter / 2) * Math.Sin(angle) + LocalPatternCenter.Y;</div>
<div class="line">                    Holes.Add(_espritApplication.Document.Circles.Add(_espritApplication.Document.GetPoint(x, y, 0), HoleDiameter / 2.0));</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            _espritApplication.Document.Refresh();</div>
<div class="line">            <span class="keywordflow">return</span> Holes;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>Now we can ask the user for input values and use the class functionality:</p>
<div class="tab"> <div class="tablinks2" onclick="openTab(event, &apos;CShsnippet2&apos;, &apos;tabcontent2&apos;, &apos;tablinks2&apos;)">C#</div> </div><div id="CShsnippet2" class="tabcontent2"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnDeleteButtonClick(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (_boltHolePattern != <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                _boltHolePattern.Dispose();</div>
<div class="line">                _boltHolePattern = <span class="keyword">null</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnMoveButtonClick(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            Esprit.Point point = <span class="keyword">null</span>;</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                point = Document.GetPoint(<span class="stringliteral">&quot;Pick The New Pattern Center&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// Point was not set</span></div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            _boltHolePattern?.Move(point);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnCreateButtonClick(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            MakeHole();</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> MakeHole()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (_boltHolePattern == <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                _boltHolePattern = <span class="keyword">new</span> BoltHolePatternExpandHandler(EspritApplication);</div>
<div class="line">                _boltHolePattern.IsBoltHoleCreated = <span class="keyword">false</span>;</div>
<div class="line">            }</div>
<div class="line">            </div>
<div class="line">            var holeDiameter = _boltHolePattern.HoleDiameter;</div>
<div class="line">            var patternDiameter = _boltHolePattern.PatternDiameter;</div>
<div class="line">            var numberOfHoles = _boltHolePattern.NumberOfHoles;</div>
<div class="line">            var startAngle = (_boltHolePattern.StartAngleRad * 180/ Math.PI);</div>
<div class="line">            </div>
<div class="line">            <span class="keywordflow">if</span> (RequestUserInput(<span class="stringliteral">&quot;Enter Hole Diameter&quot;</span>, <span class="stringliteral">&quot;Hole Diameter&quot;</span>, ref holeDiameter) &amp;&amp;</div>
<div class="line">                RequestUserInput(<span class="stringliteral">&quot;Enter Pattern Diameter&quot;</span>, <span class="stringliteral">&quot;Pattern Diameter&quot;</span>, ref patternDiameter) &amp;&amp;</div>
<div class="line">                RequestUserInput(<span class="stringliteral">&quot;Enter Number of Holes&quot;</span>, <span class="stringliteral">&quot;Holes&quot;</span>, ref numberOfHoles) &amp;&amp;</div>
<div class="line">                RequestUserInput(<span class="stringliteral">&quot;Enter New Start Angle in Degrees&quot;</span>, <span class="stringliteral">&quot;Start Angle&quot;</span>, ref startAngle) )</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (holeDiameter &gt; 0 &amp;&amp; patternDiameter &gt; 0 &amp;&amp; numberOfHoles &gt; 0)</div>
<div class="line">                {</div>
<div class="line">                    _boltHolePattern.HoleDiameter = holeDiameter;</div>
<div class="line">                    _boltHolePattern.NumberOfHoles = numberOfHoles;</div>
<div class="line">                    _boltHolePattern.StartAngleRad = startAngle * Math.PI / 180;</div>
<div class="line">                    _boltHolePattern.HoleDiameter = holeDiameter;</div>
<div class="line"> </div>
<div class="line">                    Esprit.Point point = <span class="keyword">null</span>;</div>
<div class="line"> </div>
<div class="line">                    <span class="keywordflow">if</span> (!_boltHolePattern.IsBoltHoleCreated)</div>
<div class="line">                    {</div>
<div class="line">                        <span class="keywordflow">try</span></div>
<div class="line">                        {</div>
<div class="line">                            point = Document.GetPoint(<span class="stringliteral">&quot;Pick The Pattern Center&quot;</span>);</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">                        {</div>
<div class="line">                            <span class="comment">// Point was not set</span></div>
<div class="line">                            _boltHolePattern.IsBoltHoleCreated = <span class="keyword">false</span>;</div>
<div class="line">                            <span class="keywordflow">return</span>;</div>
<div class="line">                        }</div>
<div class="line">                        _boltHolePattern.IsBoltHoleCreated = <span class="keyword">true</span>;</div>
<div class="line">                    }</div>
<div class="line">                    _boltHolePattern.DrawPattern(point);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>Start by running the MakeBoltHolePattern function. Then try the UpdateBoltHolePattern and MoveBoltHolePattern. Then run the MakeBoltHolePattern again, and try the other two a few more times. Then try the RemoveBoltHolePattern. Do all of them behave as expected?</p>
<p>Notice that this code used some private variables to keep the user from accessing them directly. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/>
<script type="text/javascript" src="restoreTabs.js"></script>
</body>
</html>
