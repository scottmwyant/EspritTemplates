<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Square Feature PTOP</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="tutorial.css" rel="stylesheet" type="text/css" />
<link href="tab.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="tab.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Square Feature PTOP </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>In this tutorial you will create a Feature PTOP of four points in square pattern. The important concept introduced in this tutorial is the use of the Add method to create and add objects to a collection - besides adding Point objects to the Points collection we are also adding a FeaturePtop object to the FeaturePtops collection. The FeaturePtop is a special object in that it also has an Add method, but unlike adding to a collection it does not create the object that it is adding, it only associates that object with the FeaturePtop object. Note how Properties such as Color and LineType can be assigned.</p>
<p>Notice how Document.FeaturePtops.Add needs a start point as an argument. That command initially creates the feature ptop at that point, and after that the other three points are added to it one at a time as they are created.</p>
<div class="tab"> <div class="tablinks" onclick="openTab(event, &apos;CShsnippet&apos;, &apos;tabcontent1&apos;, &apos;tablinks&apos;)">C#</div> </div><div id="CShsnippet" class="tabcontent1"> <div> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">void</span> SquareFeaturePtop()</div>
<div class="line">        {</div>
<div class="line">            var length = 10.0;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (RequestUserInput(<span class="stringliteral">&quot;Enter Length&quot;</span>, <span class="stringliteral">&quot;Square Length&quot;</span>, ref length))</div>
<div class="line">            {</div>
<div class="line">                var point = Document.Points.Add(0, 0, 0);</div>
<div class="line"> </div>
<div class="line">                Esprit.FeaturePtop featurePtop = Document.FeaturePtops.Add(point);</div>
<div class="line">                featurePtop.Color = ColorHelper.ColorToUInt(System.Drawing.Color.Blue);</div>
<div class="line">                featurePtop.LineType = EspritConstants.espLineType.espPhantom;</div>
<div class="line"> </div>
<div class="line">                point = Document.Points.Add(0, length, 0);</div>
<div class="line">                featurePtop.Add(point);</div>
<div class="line"> </div>
<div class="line">                point = Document.Points.Add(length, length, 0);</div>
<div class="line">                featurePtop.Add(point);</div>
<div class="line"> </div>
<div class="line">                point = Document.Points.Add(length, 0, 0);</div>
<div class="line">                featurePtop.Add(point);</div>
<div class="line"> </div>
<div class="line">                Document.Refresh();</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div> <div> The following function is used to convert the color value: </div> <div> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> uint ColorToUInt(System.Drawing.Color color)</div>
<div class="line">        {</div>
<div class="line">            var value = (uint)((color.A &lt;&lt; 24) | (color.B &lt;&lt; 16) |</div>
<div class="line">                               (color.G &lt;&lt; 8) | color.R);</div>
<div class="line">            <span class="keywordflow">return</span> value;</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --><br  />
 </div></div><div id="CShsnippet" class="tabcontent1"></div><p>Do a Fit in ESPRIT after running the code and you will see the newly created points and the feature in the graphics. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/>
<script type="text/javascript" src="restoreTabs.js"></script>
</body>
</html>
