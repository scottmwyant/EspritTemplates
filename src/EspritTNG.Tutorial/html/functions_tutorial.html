<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Fun with Functions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="tutorial.css" rel="stylesheet" type="text/css" />
<link href="tab.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="tab.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Fun with Functions </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This tutorial shows how to create and use functions with different input parameters and return values.</p>
<p><a class="anchor" id="AnchorDisplayLayerCounts"></a></p><ul>
<li>Find the number of items on a layer:</li>
</ul>
<div class="tab"> <div class="tablinks1" onclick="openTab(event, &apos;CShsnippet1&apos;, &apos;tabcontent1&apos;, &apos;tablinks1&apos;)">C#</div> </div><div id="CShsnippet1" class="tabcontent1"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> uint GetLayerCount(Esprit.Document document, Esprit.Layer layer)</div>
<div class="line">        {</div>
<div class="line">            uint count = 0;</div>
<div class="line">            <span class="keywordflow">for</span> (var i = 1; i &lt;= document.GraphicsCollection.Count; i++)</div>
<div class="line">            {</div>
<div class="line">                var graphicObject = document.GraphicsCollection[i] as Esprit.GraphicObject;</div>
<div class="line">                <span class="keywordflow">if</span> (graphicObject.Layer.Name == layer.Name &amp;&amp; graphicObject.TypeName != <span class="stringliteral">&quot;Unknown&quot;</span>)</div>
<div class="line">                {</div>
<div class="line">                    count++;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">return</span> count;</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><ul>
<li>Loop through all layers and display their number of items in an output window:</li>
</ul>
<div class="tab"> <div class="tablinks2" onclick="openTab(event, &apos;CShsnippet2&apos;, &apos;tabcontent2&apos;, &apos;tablinks2&apos;)">C#</div> </div><div id="CShsnippet2" class="tabcontent2"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> DisplayLayerCounts()</div>
<div class="line">        {</div>
<div class="line">            EspritApplication.EventWindow.Clear();</div>
<div class="line">            EspritApplication.EventWindow.Visible = <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">foreach</span> (Esprit.Layer layer in Document.Layers)</div>
<div class="line">            {</div>
<div class="line">                EspritApplication.EventWindow.AddMessage(EspritConstants.espMessageType.espMessageTypeInformation, <span class="stringliteral">&quot;FunctionsTutorial&quot;</span>, $<span class="stringliteral">&quot;Layer {layer.Number} {layer.Name} contains {GetLayerCount(Document, layer)} items.&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>Tutorial outputs information to the EventWindow :</p>
<div class="image">
<img src="Functions2EventWindow.png" alt=""/>
</div>
<ul>
<li>Remove empty layers:</li>
</ul>
<div class="tab"> <div class="tablinks3" onclick="openTab(event, &apos;CShsnippet3&apos;, &apos;tabcontent3&apos;, &apos;tablinks3&apos;)">C#</div> </div><div id="CShsnippet3" class="tabcontent3"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> RemoveEmptyLayers()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">foreach</span> (Esprit.Layer layer in Document.Layers)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (IsEmpty(Document, layer))</div>
<div class="line">                {</div>
<div class="line">                    Document.Layers.Remove(layer.Name);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">bool</span> IsEmpty(Esprit.Document document, Esprit.Layer layer)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">return</span> GetLayerCount(document, layer) == 0;</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><ul>
<li>Find a point mid way between two other points:</li>
</ul>
<div class="tab"> <div class="tablinks4" onclick="openTab(event, &apos;CShsnippet4&apos;, &apos;tabcontent4&apos;, &apos;tablinks4&apos;)">C#</div> </div><div id="CShsnippet4" class="tabcontent4"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> MidPointDemo()</div>
<div class="line">        {</div>
<div class="line">            Esprit.Point point1 = <span class="keyword">null</span>;</div>
<div class="line">            Esprit.Point point2 = <span class="keyword">null</span>;</div>
<div class="line"> </div>
<div class="line">            _form.Hide();</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                point1 = Document.GetPoint(<span class="stringliteral">&quot;DateTimePicker Point 1&quot;</span>);</div>
<div class="line">                point2 = Document.GetPoint(<span class="stringliteral">&quot;DateTimePicker Point 2&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// Element was not set</span></div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (point1 != <span class="keyword">null</span> &amp;&amp; point2 != <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                var midPoint = AddPoint(Document, GetMidPoint(Document, point1, point2));</div>
<div class="line"> </div>
<div class="line">                Document.Refresh();</div>
<div class="line"> </div>
<div class="line">                EspritApplication.EventWindow.Clear();</div>
<div class="line">                EspritApplication.EventWindow.Visible = <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line">                EspritApplication.EventWindow.AddMessage(EspritConstants.espMessageType.espMessageTypeInformation, <span class="stringliteral">&quot;FunctionsTutorial&quot;</span>, $<span class="stringliteral">&quot;Midpoint is {midPoint.X}, {midPoint.Y}, {midPoint.Z}&quot;</span>);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            _form.Show();</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> Esprit.Point AddPoint(Esprit.Document document, Esprit.Point point)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">return</span> document.Points.Add(point.X, point.Y, point.Z);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> Esprit.Point GetMidPoint(Esprit.Document document, Esprit.Point point1, Esprit.Point point2)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">return</span> document.GetPoint((point1.X + point2.X) / 2.0, (point1.Y + point2.Y) / 2.0, (point1.Z + point2.Z) / 2.0);</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>Tutorial outputs information to the EventWindow :</p>
<div class="image">
<img src="Functions3EventWindow.png" alt=""/>
</div>
<ul>
<li>Get a layer with the specified name if it exists or create a new one:</li>
</ul>
<p><a class="anchor" id="AnchorGetLayer"></a> </p><div class="tab"> <div class="tablinks5" onclick="openTab(event, &apos;CShsnippet5&apos;, &apos;tabcontent5&apos;, &apos;tablinks5&apos;)">C#</div> </div><div id="CShsnippet5" class="tabcontent5"> <div> check if a layer exists: </div> <div> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">bool</span> LayerExist(Esprit.Document document, <span class="keywordtype">string</span> layerName)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">bool</span> result = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">foreach</span> (Esprit.Layer layer in document.Layers)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (layer.Name == layerName)</div>
<div class="line">                {</div>
<div class="line">                    result = <span class="keyword">true</span>;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> result;</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div> <div> reference the existing layer or create a new one </div> <div> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> GetLayerDemo()</div>
<div class="line">        {</div>
<div class="line">            var layerName = <span class="stringliteral">&quot;Default&quot;</span>;</div>
<div class="line">            <span class="keywordflow">if</span> (RequestUserInput(<span class="stringliteral">&quot;Enter Layer to Get&quot;</span>, <span class="stringliteral">&quot;GetLayerDemo&quot;</span>, ref layerName))</div>
<div class="line">            {</div>
<div class="line">                Document.ActiveLayer = GetLayer(Document, layerName);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> Esprit.Layer GetLayer(Esprit.Document document, <span class="keywordtype">string</span> layerName)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (LayerExist(document, layerName))</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span> document.Layers[layerName];</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span> document.Layers.Add(layerName);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div></div><div id="CShsnippet5" class="tabcontent5"></div><p><a class="anchor" id="AnchorLine2"></a></p><ul>
<li>Create a line from two point:</li>
</ul>
<div class="tab"> <div class="tablinks6" onclick="openTab(event, &apos;CShsnippet6&apos;, &apos;tabcontent6&apos;, &apos;tablinks6&apos;)">C#</div> </div><div id="CShsnippet6" class="tabcontent6"> <div> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> Line2Demo()</div>
<div class="line">        {</div>
<div class="line">            Esprit.Point point1 = <span class="keyword">null</span>;</div>
<div class="line">            Esprit.Point point2 = <span class="keyword">null</span>;</div>
<div class="line"> </div>
<div class="line">            _form.Hide();</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                point1 = Document.GetPoint(<span class="stringliteral">&quot;Select First Point&quot;</span>);</div>
<div class="line">                point2 = Document.GetPoint(<span class="stringliteral">&quot;Select Second Point&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// Element was not set</span></div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (point1 != <span class="keyword">null</span> &amp;&amp; point2 != <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                var line = Line2(Document, point1, point2);</div>
<div class="line"> </div>
<div class="line">                EspritApplication.EventWindow.Clear();</div>
<div class="line">                EspritApplication.EventWindow.Visible = <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line">                EspritApplication.EventWindow.AddMessage(EspritConstants.espMessageType.espMessageTypeInformation, <span class="stringliteral">&quot;FunctionsTutorial&quot;</span>, $<span class="stringliteral">&quot;L.Ux = {line.Ux}&quot;</span>);</div>
<div class="line">                EspritApplication.EventWindow.AddMessage(EspritConstants.espMessageType.espMessageTypeInformation, <span class="stringliteral">&quot;FunctionsTutorial&quot;</span>, $<span class="stringliteral">&quot;L.Uy = {line.Uy}&quot;</span>);</div>
<div class="line">                EspritApplication.EventWindow.AddMessage(EspritConstants.espMessageType.espMessageTypeInformation, <span class="stringliteral">&quot;FunctionsTutorial&quot;</span>, $<span class="stringliteral">&quot;L.Uz = {line.Uz}&quot;</span>);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            _form.Show();</div>
<div class="line"> </div>
<div class="line">            Document.Refresh();</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> Esprit.Line Line2(Esprit.Document document, Esprit.Point point1, Esprit.Point point2)</div>
<div class="line">        {</div>
<div class="line">            var deltaX = point2.X - point1.X;</div>
<div class="line">            var deltaY = point2.Y - point1.Y;</div>
<div class="line">            var deltaZ = point2.Z - point1.Z;</div>
<div class="line">            var distance = Geometry.Distance(point1, point2);</div>
<div class="line">            <span class="keywordflow">return</span> document.Lines.Add(point1, deltaX / distance, deltaY / distance, deltaZ / distance);</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div> <div> calculate distance between two point </div> <div> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">double</span> Distance(Point point1, Point point2 = <span class="keyword">null</span>)</div>
<div class="line">        {</div>
<div class="line">            var x2 = point2?.X ?? 0;</div>
<div class="line">            var y2 = point2?.Y ?? 0;</div>
<div class="line">            var z2 = point2?.Z ?? 0;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> Distance(point1.X, point1.Y, point1.Z, x2, y2, z2);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">double</span> Distance(<span class="keywordtype">double</span> x1, <span class="keywordtype">double</span> y1, <span class="keywordtype">double</span> z1, <span class="keywordtype">double</span> x2, <span class="keywordtype">double</span> y2, <span class="keywordtype">double</span> z2)</div>
<div class="line">        {</div>
<div class="line">            var dx = x2 - x1;</div>
<div class="line">            var dy = y2 - y1;</div>
<div class="line">            var dz = z2 - z1;</div>
<div class="line">            <span class="keywordflow">return</span> Math.Sqrt(dx * dx + dy * dy + dz * dz);</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div> </div><p>Tutorial outputs information to the EventWindow :</p>
<div class="image">
<img src="Functions1EventWindow.png" alt=""/>
</div>
 </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/>
<script type="text/javascript" src="restoreTabs.js"></script>
</body>
</html>
