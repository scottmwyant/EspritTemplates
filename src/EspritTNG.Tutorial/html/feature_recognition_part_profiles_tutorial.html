<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Feature Recognition: Part Profiles</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="tutorial.css" rel="stylesheet" type="text/css" />
<link href="tab.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="tab.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Feature Recognition: Part Profiles </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Altogether there are six methods for automatically creating features with FeatureRecognition. This tutorial will look at CreatePartProfileShadow, which will create geometry or features around the shadow that a part casts onto a plane. We need to provide a SelectionSet as an argument, along with just one plane in this case. As with the other feature recognition commands, an array of GraphicObject objects is returned.</p>
<p>Suppose that you load solids for your lathe machining, and you always want to get a shadow of the part in the XYZ plane to get geometry that you can use to create your rough, finish, and cutoff features.</p>
<p>The code below shows the example of accessing the objects returned by CreatePartProfileShadow. Suppose that we want to find the maximum diameter of our part, to know what size stock to use. We could make a feature profile on the YZ plane, and then loop through the elements of the feature and find which one was the farthest away from the origin point at the center.</p>
<div class="tab"> <div class="tablinks" onclick="openTab(event, &apos;CShsnippet&apos;, &apos;tabcontent1&apos;, &apos;tablinks&apos;)">C#</div> </div><div id="CShsnippet" class="tabcontent1"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">void</span> FindMaximumDiameter()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (Document.Solids.Count == 0)</div>
<div class="line">            {</div>
<div class="line">                MessageBox.Show(<span class="stringliteral">&quot;There are no solids in this file.&quot;</span>, <span class="stringliteral">&quot;FeatureRecognitionPartProfilesTutorial&quot;</span>, MessageBoxButton.OK);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            EspritApplication.EventWindow.Clear();</div>
<div class="line">            EspritApplication.EventWindow.Visible = <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line">            var plane = PlaneHelper.GetPlane(Document, <span class="stringliteral">&quot;Temp XYZ&quot;</span>);</div>
<div class="line">            PlaneHelper.SetPlaneVectors(ref plane, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1);</div>
<div class="line"> </div>
<div class="line">            var <span class="keyword">set</span> = SelectionSetHelper.GetSelectionSet(Document, <span class="stringliteral">&quot;Temp&quot;</span>);</div>
<div class="line"> </div>
<div class="line">            EspritApplication.Configuration.ConfigurationFeatureRecognition.Tolerance = Document.SystemUnit == EspritConstants.espUnitType.espInch ? 0.001 : 0.025;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">foreach</span> (Esprit.Solid solid in Document.Solids)</div>
<div class="line">            {</div>
<div class="line">                <span class="keyword">set</span>.RemoveAll();</div>
<div class="line">                <span class="keyword">set</span>.Add(solid);</div>
<div class="line"> </div>
<div class="line">                Array shadows = <span class="keyword">null</span>;</div>
<div class="line">                <span class="keywordflow">try</span></div>
<div class="line">                {</div>
<div class="line">                    shadows = Document.FeatureRecognition.CreatePartProfileShadow(<span class="keyword">set</span>, plane, EspritConstants.espGraphicObjectReturnType.espFeatureChains);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">catch</span>(Exception)</div>
<div class="line">                {</div>
<div class="line">                    MessageBox.Show(<span class="stringliteral">&quot;Fail on creating part profile shadow.&quot;</span>, <span class="stringliteral">&quot;FeatureRecognitionPartProfilesTutorial&quot;</span>, MessageBoxButton.OK);</div>
<div class="line">                    <span class="keywordflow">return</span>;</div>
<div class="line">                }</div>
<div class="line">                </div>
<div class="line">                var maxDiameter = 0.0;</div>
<div class="line">                <span class="keywordflow">for</span> (var i = shadows.GetLowerBound(0); i &lt;= shadows.GetUpperBound(0); i++)</div>
<div class="line">                {</div>
<div class="line">                    var graphicObject = shadows.GetValue(i) as Esprit.IGraphicObject;</div>
<div class="line">                    <span class="keywordflow">if</span> (graphicObject.GraphicObjectType != EspritConstants.espGraphicObjectType.espFeatureChain)</div>
<div class="line">                    {</div>
<div class="line">                        <span class="keywordflow">continue</span>;</div>
<div class="line">                    }</div>
<div class="line"> </div>
<div class="line">                    var featureChain = graphicObject as Esprit.FeatureChain;</div>
<div class="line">                    <span class="keywordflow">for</span> (var j = 1; j &lt;= featureChain.Count; j++)</div>
<div class="line">                    {</div>
<div class="line">                        Esprit.Point point1 = <span class="keyword">null</span>;</div>
<div class="line">                        Esprit.Point point2 = <span class="keyword">null</span>;</div>
<div class="line"> </div>
<div class="line">                        <span class="keywordflow">switch</span> (featureChain.Item[j].GraphicObjectType)</div>
<div class="line">                        {</div>
<div class="line">                            <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espArc:</div>
<div class="line">                                var arc = featureChain.Item[j] as Esprit.Arc;</div>
<div class="line">                                point1 = arc.Extremity(EspritConstants.espExtremityType.espExtremityStart);</div>
<div class="line">                                point2 = arc.Extremity(EspritConstants.espExtremityType.espExtremityEnd);</div>
<div class="line">                                <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">                            <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espSegment:</div>
<div class="line">                                var segment = featureChain.Item[j] as Esprit.Segment;</div>
<div class="line">                                point1 = segment.Extremity(EspritConstants.espExtremityType.espExtremityStart);</div>
<div class="line">                                point2 = segment.Extremity(EspritConstants.espExtremityType.espExtremityEnd);</div>
<div class="line">                                <span class="keywordflow">break</span>;</div>
<div class="line">                        }</div>
<div class="line"> </div>
<div class="line">                        var distance = Math.Sqrt(point1.Y * point1.Y + point1.Z * point1.Z);</div>
<div class="line"> </div>
<div class="line">                        <span class="keywordflow">if</span> (distance &gt; maxDiameter / 2)</div>
<div class="line">                        {</div>
<div class="line">                            maxDiameter = distance * 2;</div>
<div class="line">                        }</div>
<div class="line"> </div>
<div class="line">                        distance = Math.Sqrt(point2.Y * point2.Y + point2.Z * point2.Z);</div>
<div class="line"> </div>
<div class="line">                        <span class="keywordflow">if</span> (distance &gt; maxDiameter / 2)</div>
<div class="line">                        {</div>
<div class="line">                            maxDiameter = distance * 2;</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line"> </div>
<div class="line">                    Document.FeatureChains.Remove(featureChain.Key);</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                EspritApplication.EventWindow.AddMessage(EspritConstants.espMessageType.espMessageTypeInformation, <span class="stringliteral">&quot;FeatureRecognitionPartProfilesTutorial&quot;</span>, $<span class="stringliteral">&quot;The Max YZ Diameter of Solid {solid.Key} is {maxDiameter}&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> SelectionSet GetOrAddSelectionSet(ISelectionSets selectionSets, <span class="keywordtype">string</span> name)</div>
<div class="line">        {</div>
<div class="line">            var <span class="keyword">set</span> = selectionSets[name] ?? selectionSets.Add(name);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">set</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>Before running the code open a file with a lathe type solid in it, or create one yourself by using the Solid Modeler to rotate a feature.</p>
<p>Tutorial outputs information to the EventWindow :</p>
<div class="image">
<img src="FeatureRecognitionPartProfilesEventWindow.png" alt=""/>
</div>
 </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/>
<script type="text/javascript" src="restoreTabs.js"></script>
</body>
</html>
