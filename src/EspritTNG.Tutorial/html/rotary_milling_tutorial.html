<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Rotary Milling</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="tutorial.css" rel="stylesheet" type="text/css" />
<link href="tab.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="tab.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Rotary Milling </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This tutorial shows how to import a CAD model, set up the part and machine and perform different operations on the imported solid. It also shows how to ceate auto chains and free form features. Before running the tutorial, load "C:\Program Files\D.P.Technology\ESPRIT TNG\Help\1033\API Tutorial Samples\Data\RotaryMillig\RotaryMilling.esprit" - it already has the machine defined and mounted tools.</p>
<p>Note that when you press buttons on "Rotary Milling Tutorial" form which add operations - after adding each operation rebuilds and you have to wait until the rebuild ends before pressing the next button. After "Add engraving operation" all operations are rebulded again.</p>
<p>First, import a CAD model:</p>
<div class="tab"> <div class="tablinks1" onclick="openTab(event, &apos;CShsnippet1&apos;, &apos;tabcontent1&apos;, &apos;tablinks1&apos;)">C#</div> </div><div id="CShsnippet1" class="tabcontent1"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> ImportCAD()</div>
<div class="line">        {</div>
<div class="line">            var projectDirectoryPath = Path.GetDirectoryName(Document.DocumentProperties.Path);</div>
<div class="line"> </div>
<div class="line">            var cadModelFilePath = Path.Combine(projectDirectoryPath, <span class="stringliteral">&quot;RotorVane.SLDPRT&quot;</span>);</div>
<div class="line"> </div>
<div class="line">            Document.MergeFile2(cadModelFilePath, <span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (Document.Solids.Count != 1)</div>
<div class="line">            {</div>
<div class="line">                System.Windows.MessageBox.Show(<span class="stringliteral">&quot;Import solid error. The document must contain 1 solid.&quot;</span>, <span class="stringliteral">&quot;RotaryMillingTutorial&quot;</span>, MessageBoxButton.OK);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            Esprit.Solid solid = Document.Solids[1];</div>
<div class="line">            solid.Grouped = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">            Document.PartSetup.BeginEdit();</div>
<div class="line">            var part = Document.Parts[1];</div>
<div class="line">            part.Geometry.Add(Document.Solids[1]);</div>
<div class="line">            Document.PartSetup.EndEdit();</div>
<div class="line"> </div>
<div class="line">            Document.Refresh();</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p><a class="anchor" id="AnchorAddBarStock"></a> Set up the part and create an autosized bar stock:</p>
<div class="tab"> <div class="tablinks2" onclick="openTab(event, &apos;CShsnippet2&apos;, &apos;tabcontent2&apos;, &apos;tablinks2&apos;)">C#</div> </div><div id="CShsnippet2" class="tabcontent2"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> AddBarStock()</div>
<div class="line">        {</div>
<div class="line">            Document.PartSetup.BeginEdit();</div>
<div class="line"> </div>
<div class="line">            var wp = Document.Workpieces[1];</div>
<div class="line">            var bs = wp.Stocks.AddBarStock();</div>
<div class="line">            bs.AutoSize();</div>
<div class="line"> </div>
<div class="line">            bs.Tolerance = 0.1;</div>
<div class="line"> </div>
<div class="line">            Document.PartSetup.EndEdit();</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>In Machine Setup add the workpiece to the existing fixture:</p>
<div class="tab"> <div class="tablinks4" onclick="openTab(event, &apos;CShsnippet4&apos;, &apos;tabcontent4&apos;, &apos;tablinks4&apos;)">C#</div> </div><div id="CShsnippet4" class="tabcontent4"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> CreateMachineSetup()</div>
<div class="line">        {</div>
<div class="line">            Document.InitialMachineSetup.BeginEdit();</div>
<div class="line"> </div>
<div class="line">            var workpieceItem = Document.InitialMachineSetup.MachineItems[1].MachineItems.AddWorkpieceInstance();</div>
<div class="line">            workpieceItem.Name = <span class="stringliteral">&quot;Workpiece 1&quot;</span>;</div>
<div class="line">            workpieceItem.WorkOffsets[1].WorkOffsetType = EspritConstants.espWorkOffsetType.espWorkOffsetTypeCustom;</div>
<div class="line">            workpieceItem.ZTranslation = -10;</div>
<div class="line">            Document.InitialMachineSetup.EndEdit();</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p><a class="anchor" id="FreeForm"></a> Create a FreeForm feature - for "Part" select the whole Solid - and an Auto Chain "1 Chain" from all elements of the Geometry layer. After that create a Z-level Roughing operation, set the "1 Chain" as Boundary area on the limits tab.</p>
<div class="tab"> <div class="tablinks3" onclick="openTab(event, &apos;CShsnippet3&apos;, &apos;tabcontent3&apos;, &apos;tablinks3&apos;)">C#</div> </div><div id="CShsnippet3" class="tabcontent3"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> Esprit.FreeFormFeature CreateFreeFormFeature(<span class="keywordtype">string</span> name, EspritConstants.espFreeFormElementType type)</div>
<div class="line">        {</div>
<div class="line">            Esprit.FreeFormFeature feature = Document.FreeFormFeatures.Add();</div>
<div class="line">            feature.Name = name;</div>
<div class="line">            feature.Add(Document.Solids[1], type);</div>
<div class="line">            <span class="keywordflow">return</span> feature;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> Esprit.FreeFormFeature CreateFreeFormFeature(<span class="keywordtype">string</span> name, EspritConstants.espFreeFormElementType type, <span class="keywordtype">int</span> faceIdentity)</div>
<div class="line">        {</div>
<div class="line">            var feature = CreateFreeFormFeature(name, type);</div>
<div class="line"> </div>
<div class="line">            EspritSolids.SolidBody body = Document.Solids[1].SolidBody;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">foreach</span> (EspritSolids.SolidFace face in body.SolidFaces)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (face.Identity == faceIdentity)</div>
<div class="line">                {</div>
<div class="line">                    feature.Add(face, EspritConstants.espFreeFormElementType.espFreeFormPartSurfaceItem);</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">return</span> feature;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> AddFeatureOperation(Esprit.IGraphicObject feature, Object technology)</div>
<div class="line">        {</div>
<div class="line">            Document.Group.Clear();</div>
<div class="line">            Document.Group.Add(feature);</div>
<div class="line">            Document.PartOperations.Add(technology, feature);</div>
<div class="line">            Document.Group.Clear();</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> AddRoughingOperation()</div>
<div class="line">        {</div>
<div class="line">            Esprit.FreeFormFeature freeFormFeature1 = CreateFreeFormFeature(<span class="stringliteral">&quot;1 FreeForm&quot;</span>, EspritConstants.espFreeFormElementType.espFreeFormPartSurfaceItem);</div>
<div class="line"> </div>
<div class="line">            EspritTechnology.TechMoldRoughing roughing = <span class="keyword">new</span> EspritTechnology.TechMoldRoughing()</div>
<div class="line">            {</div>
<div class="line">                OperationName = <span class="stringliteral">&quot;Roughing&quot;</span>,</div>
<div class="line">                ToolID = <span class="stringliteral">&quot;EM2 (25mm EM)&quot;</span>,</div>
<div class="line">                SpindleSpeedRPM = 5000,</div>
<div class="line">                SpindleSpeedSPM = 393,</div>
<div class="line">                FeedratePM = 2000,</div>
<div class="line">                FeedratePT = 0.2,</div>
<div class="line">                RotaryMachining = <span class="keyword">true</span>,</div>
<div class="line">                StockAllowanceWalls = 1,</div>
<div class="line">                StockAllowanceFloors = 1,</div>
<div class="line">                DepthCalculation = EspritConstants.espMoldRoughingDepthCalculation.espMoldRoughingDepthCalculationAdaptive,</div>
<div class="line">                IncrementalDepth = 10,</div>
<div class="line">                PlungeFeedRatePercent = 100,</div>
<div class="line">                LateralFeedRatePercent = 100,</div>
<div class="line">                FeedUnit = EspritConstants.espFeedUnit.espFeedPerMinute,</div>
<div class="line">                CalculateStock = <span class="keyword">true</span>,</div>
<div class="line">                Tolerance = 0.03,</div>
<div class="line">                DepthStrategy = EspritConstants.espMoldRoughingDepthStrategy.espMoldRoughingDepthStrategyTopDown,</div>
<div class="line">                CuttingStrategy = EspritConstants.espMoldRoughingMachiningStrategy.espMoldRoughingMachiningStrategyClimbOutsideIn,</div>
<div class="line">                MoldCutPassesMode = EspritConstants.espMoldCutPassesMode.espMoldCutPassesClosed,</div>
<div class="line">                RoundAllCorners = EspritConstants.espMoldRoundAllCorners.espMoldRoundAllCornersYes,</div>
<div class="line">                CornerRoundingTolerance = 3.125,</div>
<div class="line">                StepOver = 12.5,</div>
<div class="line">                StepPercentOfDiameter = 50,</div>
<div class="line">                PositionOnModelLimit = EspritConstants.espMoldPositionOnModelLimit.espMoldPositionOnModelLimitLimitedByStock,</div>
<div class="line">                PositionOnBoundaryProfile = EspritConstants.espMoldPositionOnBoundaryProfile.espMoldPositionOnBoundaryProfileInside,</div>
<div class="line">                RetractOptimization = EspritConstants.espMoldRetractOptimization.espMoldRetractOptimizationWithin,</div>
<div class="line">                Clearance = 2,</div>
<div class="line">                FullClearance = 70,</div>
<div class="line">                OptimizationMode = EspritConstants.espRetractOptimizationMode.espRetractOptimizationStock,</div>
<div class="line">                ClippingEntity = <span class="stringliteral">&quot;1003,1&quot;</span>,</div>
<div class="line">                FullClearanceReference = <span class="stringliteral">&quot;1003,1&quot;</span> <span class="comment">// identifies 1 FreeForm feature</span></div>
<div class="line">            };</div>
<div class="line"> </div>
<div class="line">            EspritTechnology.TechMoldApproach entry = <span class="keyword">new</span> EspritTechnology.TechMoldApproach()</div>
<div class="line">            {</div>
<div class="line">                EntryMovesType = EspritConstants.espMoldEntryMovesType.espMoldEntryMovesVerticalThenLateralWithLimits,</div>
<div class="line">                LateralDistance = 20,</div>
<div class="line">                VerticalDistance = 0</div>
<div class="line">            };</div>
<div class="line">            var entries = <span class="keyword">new</span> List&lt;EspritTechnology.TechMoldApproach&gt;()</div>
<div class="line">            {</div>
<div class="line">                 entry</div>
<div class="line">            };</div>
<div class="line"> </div>
<div class="line">            roughing.set_EntryMovesStrategies(entries.ToArray());</div>
<div class="line"> </div>
<div class="line">            EspritTechnology.TechMoldDetach exit1 = <span class="keyword">new</span> EspritTechnology.TechMoldDetach()</div>
<div class="line">            {</div>
<div class="line">                ExitMovesType = EspritConstants.espMoldExitMovesType.espMoldExitMovesVerticalThenRadiusWithLimits,</div>
<div class="line">                LateralDistance = 15,</div>
<div class="line">                ArcRadius = 6.25,</div>
<div class="line">                VerticalDistance = 2</div>
<div class="line">            };</div>
<div class="line">            EspritTechnology.TechMoldDetach exit2 = <span class="keyword">new</span> EspritTechnology.TechMoldDetach()</div>
<div class="line">            {</div>
<div class="line">                ExitMovesType = EspritConstants.espMoldExitMovesType.espMoldExitMovesVerticalThenLateralWithLimits,</div>
<div class="line">                LateralDistance = 15,</div>
<div class="line">                VerticalDistance = 2</div>
<div class="line">            };</div>
<div class="line"> </div>
<div class="line">            var exitModes = <span class="keyword">new</span> List&lt;EspritTechnology.TechMoldDetach&gt;()</div>
<div class="line">            {</div>
<div class="line">                 exit1,</div>
<div class="line">                 exit2</div>
<div class="line">            };</div>
<div class="line">            roughing.set_ExitMovesStrategies(exitModes.ToArray());</div>
<div class="line"> </div>
<div class="line">            EspritTechnology.TechMoldFeedLink feedLink1 = <span class="keyword">new</span> EspritTechnology.TechMoldFeedLink()</div>
<div class="line">            {</div>
<div class="line">                FeedLinkType = EspritConstants.espMoldFeedLinkType.espMoldFeedLinkSmoothArcWithDetach,</div>
<div class="line">                MaximumLinkDistance = 50,</div>
<div class="line">                RampAngle = 2</div>
<div class="line">            };</div>
<div class="line">            EspritTechnology.TechMoldFeedLink feedLink2 = <span class="keyword">new</span> EspritTechnology.TechMoldFeedLink()</div>
<div class="line">            {</div>
<div class="line">                FeedLinkType = EspritConstants.espMoldFeedLinkType.espMoldFeedLinkSmoothArcWithDetach,</div>
<div class="line">                MaximumLinkDistance = 50,</div>
<div class="line">                RampAngle = 2,</div>
<div class="line">                LateralDistance = 0.25</div>
<div class="line">            };</div>
<div class="line">            EspritTechnology.TechMoldFeedLink feedLink3 = <span class="keyword">new</span> EspritTechnology.TechMoldFeedLink()</div>
<div class="line">            {</div>
<div class="line">                FeedLinkType = EspritConstants.espMoldFeedLinkType.espMoldFeedLinkLinearWithDetach,</div>
<div class="line">                MaximumLinkDistance = 50,</div>
<div class="line">                LateralDistance = 6.25,</div>
<div class="line">                RampAngle = 2</div>
<div class="line">            };</div>
<div class="line">            EspritTechnology.TechMoldFeedLink feedLink4 = <span class="keyword">new</span> EspritTechnology.TechMoldFeedLink()</div>
<div class="line">            {</div>
<div class="line">                FeedLinkType = EspritConstants.espMoldFeedLinkType.espMoldFeedLinkRamp,</div>
<div class="line">                MaximumLinkDistance = 100,</div>
<div class="line">                MinimumRampWidth = 25,</div>
<div class="line">                RampAngle = 2</div>
<div class="line">            };</div>
<div class="line">            var feedLinks = <span class="keyword">new</span> List&lt;EspritTechnology.TechMoldFeedLink&gt;()</div>
<div class="line">            {</div>
<div class="line">                 feedLink1,</div>
<div class="line">                 feedLink2,</div>
<div class="line">                 feedLink3,</div>
<div class="line">                 feedLink4</div>
<div class="line">            };</div>
<div class="line">            roughing.set_FeedLinks(feedLinks.ToArray());</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// create auto chain on elements in Geometry Layer</span></div>
<div class="line">            var <span class="keyword">set</span> = SelectionSetHelper.GetOrAddSelectionSet(Document.SelectionSets, <span class="stringliteral">&quot;Temp&quot;</span>);</div>
<div class="line">            <span class="keyword">set</span>.RemoveAll();</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">foreach</span> (Esprit.IGraphicObject graphicObject in Document.GraphicsCollection)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span>(graphicObject.Layer.Name == <span class="stringliteral">&quot;Geometry&quot;</span>)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keyword">set</span>.Add(graphicObject);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (<span class="keyword">set</span>.Count &gt; 0)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">try</span></div>
<div class="line">                {</div>
<div class="line">                    Document.FeatureRecognition.CreateAutoChains(<span class="keyword">set</span>);</div>
<div class="line">                    roughing.BoundaryProfiles = <span class="stringliteral">&quot;6,1&quot;</span>; <span class="comment">// identifies 1 Chain</span></div>
<div class="line">                    AddFeatureOperation(freeFormFeature1, roughing);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">                { }</div>
<div class="line">            }</div>
<div class="line">            Document.SelectionSets.Remove(<span class="keyword">set</span>.Name);</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>Create 2 new FreeForm features: for "Part" select faces where Roughing operation was created and for "Check" select the enire Solid. Create 2 Concentric Finishing operations: set the Position angle of the second operation to 30 degrees so that the machine moves with a linear motion in the x direction for the first finishing operation and along 30 degrees for the second.</p>
<div class="tab"> <div class="tablinks5" onclick="openTab(event, &apos;CShsnippet5&apos;, &apos;tabcontent5&apos;, &apos;tablinks5&apos;)">C#</div> </div><div id="CShsnippet5" class="tabcontent5"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> EspritTechnology.TechMoldConcentricFinishing FinishingOperation(<span class="keywordtype">double</span> angle, <span class="keywordtype">string</span> fullClearanceReference)</div>
<div class="line">        {</div>
<div class="line">            EspritTechnology.TechMoldConcentricFinishing finishing = <span class="keyword">new</span> EspritTechnology.TechMoldConcentricFinishing()</div>
<div class="line">            {</div>
<div class="line">                OperationName = <span class="stringliteral">&quot;Concentric Finishing&quot;</span>,</div>
<div class="line">                SpindleSpeedRPM = 8000,</div>
<div class="line">                SpindleSpeedSPM = 452,</div>
<div class="line">                FeedratePM = 1000,</div>
<div class="line">                FeedratePT = 0.0625,</div>
<div class="line">                ToolID = <span class="stringliteral">&quot;EM1 (18mm BNEM)&quot;</span>,</div>
<div class="line">                FeedUnit = EspritConstants.espFeedUnit.espFeedPerMinute,</div>
<div class="line">                PlungeFeedRatePercent = 100,</div>
<div class="line">                LateralFeedRatePercent = 100,</div>
<div class="line">                CalculateStock = <span class="keyword">true</span>,</div>
<div class="line">                RotaryMachining = <span class="keyword">true</span>,</div>
<div class="line">                ToolPositionAngle = angle,</div>
<div class="line">                Tolerance = 0.012,</div>
<div class="line">                StepPercentOfDiameter = 25,</div>
<div class="line">                MaximumSlopeAngle = 90,</div>
<div class="line">                StepOver = 4.5,</div>
<div class="line">                OffsetSide = EspritConstants.espMoldConcSideOffset.espMoldConcSideOffsetLeft,</div>
<div class="line">                MachiningDirection = EspritConstants.espMoldConcentricMachiningDirection.espMoldConcentricMachiningDirectionInsideOut,</div>
<div class="line">                PassOrder = EspritConstants.espMoldConcentricPassOrder.espMoldConcentricPassOrderPerRegionShortestDistance,</div>
<div class="line">                PositionOnBoundaryProfile = EspritConstants.espMoldPositionOnBoundaryProfile.espMoldPositionOnBoundaryProfileInside,</div>
<div class="line">                ApproachInsideBoundary = <span class="keyword">true</span>,</div>
<div class="line">                RetractOptimization = EspritConstants.espMoldRetractOptimization.espMoldRetractOptimizationWithin,</div>
<div class="line">                Clearance = 2,</div>
<div class="line">                FullClearance = 70,</div>
<div class="line">                FullClearanceReference = fullClearanceReference, <span class="comment">// identifies 2 or 3 FreeForm feature</span></div>
<div class="line">                ExtraMoves = EspritConstants.espMoldConcentricFullFilled.espMoldConcentricFullFilled_No,</div>
<div class="line">                PositionOnModelLimit = EspritConstants.espMoldPositionOnModelLimit.espMoldPositionOnModelLimitOutsideOffset,</div>
<div class="line">                ModelLimitOffset = 6.0</div>
<div class="line">            };</div>
<div class="line"> </div>
<div class="line">            EspritTechnology.TechMoldApproach entry1 = <span class="keyword">new</span> EspritTechnology.TechMoldApproach()</div>
<div class="line">            {</div>
<div class="line">                EntryMovesType = EspritConstants.espMoldEntryMovesType.espMoldEntryMovesHelical,</div>
<div class="line">                VerticalDistance = 12,</div>
<div class="line">                HelixAngle = 10,</div>
<div class="line">                HelixDiameter = 10</div>
<div class="line">            };</div>
<div class="line">            EspritTechnology.TechMoldApproach entry2 = <span class="keyword">new</span> EspritTechnology.TechMoldApproach()</div>
<div class="line">            {</div>
<div class="line">                EntryMovesType = EspritConstants.espMoldEntryMovesType.espMoldEntryMovesVerticalThenRadius,</div>
<div class="line">                ArcAngle = 30,</div>
<div class="line">                ArcRadius = 9,</div>
<div class="line">                VerticalDistance = 3</div>
<div class="line">            };</div>
<div class="line">            EspritTechnology.TechMoldApproach entry3 = <span class="keyword">new</span> EspritTechnology.TechMoldApproach()</div>
<div class="line">            {</div>
<div class="line">                EntryMovesType = EspritConstants.espMoldEntryMovesType.espMoldEntryMovesVertical,</div>
<div class="line">                VerticalDistance = 3</div>
<div class="line">            };</div>
<div class="line">            var entries = <span class="keyword">new</span> List&lt;EspritTechnology.TechMoldApproach&gt;()</div>
<div class="line">            {</div>
<div class="line">                 entry1,</div>
<div class="line">                 entry2,</div>
<div class="line">                 entry3</div>
<div class="line">            };</div>
<div class="line"> </div>
<div class="line">            finishing.set_EntryMovesStrategies(entries.ToArray());</div>
<div class="line"> </div>
<div class="line">            EspritTechnology.TechMoldDetach exit1 = <span class="keyword">new</span> EspritTechnology.TechMoldDetach()</div>
<div class="line">            {</div>
<div class="line">                ExitMovesType = EspritConstants.espMoldExitMovesType.espMoldExitMovesVerticalThenRadius,</div>
<div class="line">                ArcAngle = 30,</div>
<div class="line">                ArcRadius = 9,</div>
<div class="line">                VerticalDistance = 1,</div>
<div class="line">                EntryMovesAngle = 60</div>
<div class="line">            };</div>
<div class="line">            EspritTechnology.TechMoldDetach exit2 = <span class="keyword">new</span> EspritTechnology.TechMoldDetach()</div>
<div class="line">            {</div>
<div class="line">                ExitMovesType = EspritConstants.espMoldExitMovesType.espMoldExitMovesVertical,</div>
<div class="line">                VerticalDistance = 3</div>
<div class="line">            };</div>
<div class="line"> </div>
<div class="line">            var exitModes = <span class="keyword">new</span> List&lt;EspritTechnology.TechMoldDetach&gt;()</div>
<div class="line">            {</div>
<div class="line">                 exit1,</div>
<div class="line">                 exit2</div>
<div class="line">            };</div>
<div class="line">            finishing.set_ExitMovesStrategies(exitModes.ToArray());</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> finishing;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> AddConcentricFinishingOperation()</div>
<div class="line">        {</div>
<div class="line">            var freeFormFeature2 = CreateFreeFormFeature(<span class="stringliteral">&quot;2 FreeForm&quot;</span>, EspritConstants.espFreeFormElementType.espFreeFormCheckSurfaceItem, 2154);</div>
<div class="line">            var freeFormFeature3 = CreateFreeFormFeature(<span class="stringliteral">&quot;3 FreeForm&quot;</span>, EspritConstants.espFreeFormElementType.espFreeFormCheckSurfaceItem, 1853);</div>
<div class="line"> </div>
<div class="line">            var finishing1 = FinishingOperation(0, <span class="stringliteral">&quot;1003,2&quot;</span>);</div>
<div class="line">            var finishing2 = FinishingOperation(30, <span class="stringliteral">&quot;1003,3&quot;</span>);</div>
<div class="line"> </div>
<div class="line">            AddFeatureOperation(freeFormFeature2, finishing1);</div>
<div class="line">            AddFeatureOperation(freeFormFeature3, finishing2);</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>Choose a circumferential pocket near the machined area and create an Auto Chain on it. Create a Wrap Pocketing operation on that pocket.</p>
<div class="tab"> <div class="tablinks6" onclick="openTab(event, &apos;CShsnippet6&apos;, &apos;tabcontent6&apos;, &apos;tablinks6&apos;)">C#</div> </div><div id="CShsnippet6" class="tabcontent6"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> CreateAutoChainOnLoop(<span class="keywordtype">int</span> loopIdentity)</div>
<div class="line">        {</div>
<div class="line">            EspritSolids.SolidBody body = Document.Solids[1].SolidBody;</div>
<div class="line"> </div>
<div class="line">            var <span class="keyword">set</span> = SelectionSetHelper.GetOrAddSelectionSet(Document.SelectionSets, <span class="stringliteral">&quot;Temp&quot;</span>);</div>
<div class="line">            <span class="keyword">set</span>.RemoveAll();</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">foreach</span> (EspritSolids.SolidLoop loop in body.SolidLoops)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (loop.Identity == loopIdentity)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keyword">set</span>.Add(loop);</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (<span class="keyword">set</span>.Count &gt; 0)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">try</span></div>
<div class="line">                {</div>
<div class="line">                    Document.FeatureRecognition.CreateAutoChains(<span class="keyword">set</span>);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">                { }</div>
<div class="line">            }</div>
<div class="line">            Document.SelectionSets.Remove(<span class="keyword">set</span>.Name);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> WrappedMilling()</div>
<div class="line">        {</div>
<div class="line">            CreateAutoChainOnLoop(3971);</div>
<div class="line"> </div>
<div class="line">            EspritTechnology.TechMillWrapPocket wrapPocketing = <span class="keyword">new</span> EspritTechnology.TechMillWrapPocket()</div>
<div class="line">            {</div>
<div class="line">                OperationName = <span class="stringliteral">&quot;Wrap Pocketing&quot;</span>,</div>
<div class="line">                ToolID = <span class="stringliteral">&quot;EM3 (20mm BM)&quot;</span>,</div>
<div class="line">                FinishToolID = <span class="stringliteral">&quot;EM3 (20mm BM)&quot;</span>,</div>
<div class="line">                FloorFinishToolID = <span class="stringliteral">&quot;EM3 (20mm BM)&quot;</span>,</div>
<div class="line">                SpindleSpeedRPM = 6000,</div>
<div class="line">                SpindleSpeedSPM = 377,</div>
<div class="line">                XYFeedratePM = 1000,</div>
<div class="line">                XYFeedratePT = 0.08333,</div>
<div class="line">                ZFeedratePM = 1000,</div>
<div class="line">                ZFeedratePT = 0.083333,</div>
<div class="line">                FeedUnit = EspritConstants.espFeedUnit.espFeedPerRevolution,</div>
<div class="line">                CalculateStock = <span class="keyword">true</span>,</div>
<div class="line">                WrapFeature = <span class="keyword">true</span>,</div>
<div class="line">                WorkingDiameter = 25,</div>
<div class="line">                TypeOfWork = EspritConstants.espWrapDiameterSide.espWrapOutsideDiameter,</div>
<div class="line">                WallType = EspritConstants.espMillWrapPocketMoveType.espMillWrapPocketMoveTypeRadialWall,</div>
<div class="line">                Tolerance = 0.1,</div>
<div class="line">                TotalDepth = 6,</div>
<div class="line">                IncrementalDepth = 6,</div>
<div class="line">                IncrDepthCalculation = EspritConstants.espPocketIncrDepthCalculation.espPocketIncrDepthCalculationVarying,</div>
<div class="line">                RetractForIdepth = EspritConstants.espRetractMode.espRetractClearanceAboveSurface,</div>
<div class="line">                StepOver = 10, </div>
<div class="line">                StepPercentOfDiameter = 50,</div>
<div class="line">                EdgeClearance = 1,</div>
<div class="line">                CylindricalFeatureTolerance = 1,</div>
<div class="line">                OutputRoughPasses = <span class="keyword">true</span>,</div>
<div class="line">                ToolMotionPattern = EspritConstants.espMillPocketMovement.espMillPocketConcentricOut,</div>
<div class="line">                FullEngageFeedPercent = 100,</div>
<div class="line">                EntryMode = EspritConstants.espMillPocketEntryMode.espMillPocketEntryModePlunge,</div>
<div class="line">                ExitMode = EspritConstants.espMillPocketExitMode.espMillPocketExitModeUp,</div>
<div class="line">                Clearance = 1,</div>
<div class="line">                FullClearance = 35,</div>
<div class="line">                RapidPartialDepth = <span class="keyword">true</span>,</div>
<div class="line">                FullClearanceFrom = <span class="stringliteral">&quot;6,2&quot;</span>,</div>
<div class="line">                MachiningPriority = EspritConstants.espMillPocketMachiningPriority.espMillPocketMachiningPriorityRegion,</div>
<div class="line">                FinishPassesAfter = EspritConstants.espMillPocketPassesAfter.espMillPocketPassesAfter_REWAF</div>
<div class="line">            };</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">foreach</span> (Esprit.FeatureChain chain in Document.FeatureChains)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (chain.Name == <span class="stringliteral">&quot;2 Chain&quot;</span>)</div>
<div class="line">                {</div>
<div class="line">                    AddFeatureOperation(chain, wrapPocketing);</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>Utilize CreateHoleFeatures2 to create holes and set up drilling operations:</p>
<div class="tab"> <div class="tablinks7" onclick="openTab(event, &apos;CShsnippet7&apos;, &apos;tabcontent7&apos;, &apos;tablinks7&apos;)">C#</div> </div><div id="CShsnippet7" class="tabcontent7"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> RecognizeHoles()</div>
<div class="line">        {</div>
<div class="line">            var solidArray = <span class="keyword">new</span> List&lt;Esprit.IGraphicObject&gt;();</div>
<div class="line"> </div>
<div class="line">            solidArray.Add(Document.Solids[1]);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                var conf = EspritApplication.Configuration.ConfigurationHoleRecognition2;</div>
<div class="line">                conf.MaxDiameterInch = 30;</div>
<div class="line">                conf.MaxDiameterMetric = 30;</div>
<div class="line">                conf.MinDiameterInch = 0;</div>
<div class="line">                conf.MinDiameterMetric = 0;</div>
<div class="line"> </div>
<div class="line">                conf.CombineCoaxialHoles = <span class="keyword">true</span>;</div>
<div class="line">                conf.PropagateHoleFace = <span class="keyword">true</span>;</div>
<div class="line">                conf.ActiveWorkplaneOnly = <span class="keyword">false</span>;</div>
<div class="line">                conf.SplitCustomHole = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">                conf.GroupBySameDiameters = <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line">                conf.GroupBySameDirection = <span class="keyword">false</span>;</div>
<div class="line">                conf.GroupBySameAltitude = <span class="keyword">false</span>;</div>
<div class="line">                conf.GroupByCadFeature = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">                Document.FeatureRecognition.CreateHoleFeatures2(solidArray.ToArray(), out var comFaults);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">for</span> (var i = 1; i &lt;= comFaults.Count; i++)</div>
<div class="line">                {</div>
<div class="line">                    var msgType = comFaults[i].Severity == EspritComBase.espFaultSeverity.espFaultWarning ? EspritConstants.espMessageType.espMessageTypeWarning : EspritConstants.espMessageType.espMessageTypeError;</div>
<div class="line">                    EspritApplication.EventWindow.AddMessage(msgType, <span class="stringliteral">&quot;RotaryMillingTutorial&quot;</span>, comFaults[i].Description);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (Exception)</div>
<div class="line">            {</div>
<div class="line">                System.Windows.MessageBox.Show(<span class="stringliteral">&quot;Error on Hole Features recognition&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> AddDrillingOperation()</div>
<div class="line">        {</div>
<div class="line">            EspritTechnology.TechMillHoleMachining drillingOperation = <span class="keyword">new</span> EspritTechnology.TechMillHoleMachining()</div>
<div class="line">            {</div>
<div class="line">                OperationName = <span class="stringliteral">&quot;Drilling&quot;</span>,</div>
<div class="line">                ToolID = <span class="stringliteral">&quot;DR4 (12mm Drill)&quot;</span>,</div>
<div class="line">                SpindleSpeedRPM = 800,</div>
<div class="line">                SpindleSpeedSPM = 30,</div>
<div class="line">                ZFeedratePM = 400,</div>
<div class="line">                ZFeedratePR = 0.5,</div>
<div class="line">                FeedUnit = EspritConstants.espFeedUnit.espFeedPerMinute,</div>
<div class="line">                CalculateStock = <span class="keyword">true</span>,</div>
<div class="line">                MachiningStrategy = EspritConstants.espCenterHoleMachiningStrategy.espCenterHoleMachiningStrategyToolSpinning,</div>
<div class="line">                DepthFromFeature = <span class="keyword">true</span>,</div>
<div class="line">                DwellTime = 1,</div>
<div class="line">                DwellRevolution = 0,</div>
<div class="line">                CannedCycleNCOutput = <span class="keyword">true</span>,</div>
<div class="line">                PeckingMode = EspritConstants.espHolePeckingMode.espHolePeckingModeConstant,</div>
<div class="line">                PeckIncrement = 10,</div>
<div class="line">                PeckClearance = 1,</div>
<div class="line">                Clearance = 10,</div>
<div class="line">                CycleType = EspritConstants.espHoleCycleType.espHoleCycleTypeDrillingWithChipRemoval</div>
<div class="line">            };</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">foreach</span> (Esprit.HolesFeature hole in Document.HolesFeatures)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (hole.Diameter &lt; 30)</div>
<div class="line">                {</div>
<div class="line">                    AddFeatureOperation(hole, drillingOperation);</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> AddCenterDrillingOperation()</div>
<div class="line">        {</div>
<div class="line">            EspritTechnology.TechMillHoleMachining drillingOperation = <span class="keyword">new</span> EspritTechnology.TechMillHoleMachining()</div>
<div class="line">            {</div>
<div class="line">                OperationName = <span class="stringliteral">&quot;Center Drilling&quot;</span>,</div>
<div class="line">                ToolID = <span class="stringliteral">&quot;DR6 (30mm Drill)&quot;</span>,</div>
<div class="line">                SpindleSpeedRPM = 600,</div>
<div class="line">                SpindleRPM = 600,</div>
<div class="line">                RetractSpindleSpeedRPM = 50,</div>
<div class="line">                RetractSpindleSpeedSPM = 5,</div>
<div class="line">                FeedUnit = EspritConstants.espFeedUnit.espFeedPerMinute,</div>
<div class="line">                SpindleSpeedSPM = 57,</div>
<div class="line">                ZFeedratePM = 80,</div>
<div class="line">                ZFeedratePR = 0.13333,</div>
<div class="line">                CalculateStock = <span class="keyword">true</span>,</div>
<div class="line">                MachiningStrategy = EspritConstants.espCenterHoleMachiningStrategy.espCenterHoleMachiningStrategyPartSpinning,</div>
<div class="line">                DepthFromFeature = <span class="keyword">true</span>,</div>
<div class="line">                DwellTime = 1,</div>
<div class="line">                DwellRevolution = 0,</div>
<div class="line">                CannedCycleNCOutput = <span class="keyword">true</span>,</div>
<div class="line">                PeckingMode = EspritConstants.espHolePeckingMode.espHolePeckingModeConstant,</div>
<div class="line">                PeckIncrement = 10,</div>
<div class="line">                PeckClearance = 1,</div>
<div class="line">                Clearance = 15,</div>
<div class="line">                CycleType = EspritConstants.espHoleCycleType.espHoleCycleTypeDrilling,</div>
<div class="line">                ThroughDepth = 5,</div>
<div class="line">                AutomaticWorkOffsetRotation = <span class="keyword">true</span>,</div>
<div class="line">                RigidTapping = <span class="keyword">true</span>,</div>
<div class="line">                ApproachSpindleDirection = EspritConstants.espSpindleDirection.espSpindleCW,</div>
<div class="line">                ApproachSpindleSpeedRPM = 50,</div>
<div class="line">                ApproachSpindleSpeedSPM = 5,</div>
<div class="line">                EntryFeedratePercent = 100,</div>
<div class="line">                IntersectionFeedratePercent = 200,</div>
<div class="line">                PartialContactFeedratePercent = 25,</div>
<div class="line">                IntersectionClearance = 0.04,</div>
<div class="line">                FullRetractBetweenHoles = <span class="keyword">true</span>,</div>
<div class="line">                FullClearance = 10,</div>
<div class="line">                FullClearanceFrom = <span class="stringliteral">&quot;1006,5&quot;</span>,</div>
<div class="line">                LiveStockUpdating = <span class="keyword">true</span>,</div>
<div class="line">                StockAutomation = EspritConstants.espStockAutomationDrilling.espStockAutomationDrillingStartDepth</div>
<div class="line">            };</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">foreach</span> (Esprit.HolesFeature hole in Document.HolesFeatures)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (hole.Diameter == 30)</div>
<div class="line">                {</div>
<div class="line">                    AddFeatureOperation(hole, drillingOperation);</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>Create a chain feature on the convex edge of one of the vanes by doing an Auto Chain on that geometry and create a contouring operation on that feature:</p>
<div class="tab"> <div class="tablinks9" onclick="openTab(event, &apos;CShsnippet9&apos;, &apos;tabcontent9&apos;, &apos;tablinks9&apos;)">C#</div> </div><div id="CShsnippet9" class="tabcontent9"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> AddContouringOperation()</div>
<div class="line">        {</div>
<div class="line">            EspritSolids.SolidBody body = Document.Solids[1].SolidBody;</div>
<div class="line"> </div>
<div class="line">            var <span class="keyword">set</span> = SelectionSetHelper.GetOrAddSelectionSet(Document.SelectionSets, <span class="stringliteral">&quot;Temp&quot;</span>);</div>
<div class="line">            <span class="keyword">set</span>.RemoveAll();</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">foreach</span> (EspritSolids.SolidLoop loop in body.SolidLoops)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (<span class="keyword">set</span>.Count &gt; 0)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">foreach</span> (EspritSolids.SolidEdge edge in loop.SolidEdges)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">if</span> (edge.Identity == 3486)</div>
<div class="line">                    {</div>
<div class="line">                        <span class="keyword">set</span>.Add(edge);</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (<span class="keyword">set</span>.Count &gt; 0)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">try</span></div>
<div class="line">                {</div>
<div class="line">                    Document.FeatureRecognition.CreateAutoChains(<span class="keyword">set</span>);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">                { }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            Document.SelectionSets.Remove(<span class="keyword">set</span>.Name);</div>
<div class="line"> </div>
<div class="line">            EspritTechnology.TechMillContour1 contouringOperation = <span class="keyword">new</span> EspritTechnology.TechMillContour1()</div>
<div class="line">            {</div>
<div class="line">                OperationName = <span class="stringliteral">&quot;Contouring&quot;</span>,</div>
<div class="line">                ToolID = <span class="stringliteral">&quot;EM1 (18mm BNEM)&quot;</span>,</div>
<div class="line">                SpindleSpeedRPM = 8000,</div>
<div class="line">                SpindleSpeedSPM = 452,</div>
<div class="line">                XYFeedratePM = 1000,</div>
<div class="line">                XYFeedratePT = 0.0625,</div>
<div class="line">                ZFeedratePM = 1000,</div>
<div class="line">                ZFeedratePT = 0.0625,</div>
<div class="line">                FeedUnit = EspritConstants.espFeedUnit.espFeedPerMinute,</div>
<div class="line">                CalculateStock = <span class="keyword">true</span>,</div>
<div class="line">                RotaryMachining = <span class="keyword">true</span>,</div>
<div class="line">                FinishStockAllowanceWalls = -6.0,</div>
<div class="line">                StockAllowanceFloors = 1.0,</div>
<div class="line">                ProcessOrder = EspritConstants.espMillContourProcessOrder.espMillContourProcessOrderWidthFirst,</div>
<div class="line">                SpiralTolerance = 0.005,</div>
<div class="line">                IncrementalDepth = 18,</div>
<div class="line">                RetractForIdepth = EspritConstants.espRetractMode.espRetractClearanceAboveSurface,</div>
<div class="line">                ReadTaperFromFeature = <span class="keyword">true</span>,</div>
<div class="line">                OffsetSideComputer = EspritConstants.espMillContourOffsetSide.espMillContourOffsetLeft,</div>
<div class="line">                OffsetToolRadius = <span class="keyword">true</span>,</div>
<div class="line">                CutterCompNC = EspritConstants.espOffsetSide.espOffsetLeft,</div>
<div class="line">                OffsetRegisterNC = 1,</div>
<div class="line">                Trimming = EspritConstants.espMillContourTrimming.espMillContourTrimCollapse,</div>
<div class="line">                ToolBlend = <span class="keyword">true</span>,</div>
<div class="line">                LookAhead = EspritConstants.espLookAheadMode.espLookAheadOn,</div>
<div class="line">                IslandCollisionCheck = EspritConstants.espIslandCollisionDetection.espIslandCollisionSkip,</div>
<div class="line">                Clearance = 2,</div>
<div class="line">                RetractBetweenCuts = EspritConstants.espRetractMode.espRetractClearanceAboveSurface,</div>
<div class="line">                EntryMode = EspritConstants.espMillEntryMode.espMillEntryDownThenOver,</div>
<div class="line">                ExitMode = EspritConstants.espExitMode.espExitOverThenUp,</div>
<div class="line">                LeadInType = EspritConstants.espMillLeadinType.espMillLeadinTangent,</div>
<div class="line">                LeadOutType = EspritConstants.espMillLeadoutType.espMillLeadoutTangent,</div>
<div class="line">                TangentLeadInDistance = 11,</div>
<div class="line">                TangentLeadOutDistance = 11,</div>
<div class="line">                StartOvercut = 9,</div>
<div class="line">                StartOvercutPercentage = 50,</div>
<div class="line">                EndOvercut = 9,</div>
<div class="line">                EndOvercutPercentage = 50,</div>
<div class="line">                RoughPasses = 1</div>
<div class="line">            };</div>
<div class="line"> </div>
<div class="line">            Document.Refresh();</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">foreach</span> (Esprit.FeatureChain chain in Document.FeatureChains)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (chain.Name == <span class="stringliteral">&quot;3 Chain&quot;</span>)</div>
<div class="line">                {</div>
<div class="line">                    AddFeatureOperation(chain, contouringOperation);</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>Create Auto Chain on the loop around the center hole and spiraling and engraving operations on that feature:</p>
<div class="tab"> <div class="tablinks10" onclick="openTab(event, &apos;CShsnippet10&apos;, &apos;tabcontent10&apos;, &apos;tablinks10&apos;)">C#</div> </div><div id="CShsnippet10" class="tabcontent10"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> AddSpiralingOperation()</div>
<div class="line">        {</div>
<div class="line">            CreateAutoChainOnLoop(45);</div>
<div class="line"> </div>
<div class="line">            EspritTechnology.TechMillSpiral spiralingOperation = <span class="keyword">new</span> EspritTechnology.TechMillSpiral()</div>
<div class="line">            {</div>
<div class="line">                OperationName = <span class="stringliteral">&quot;Spiraling&quot;</span>,</div>
<div class="line">                ToolID = <span class="stringliteral">&quot;EM4 (10mm EM)&quot;</span>,</div>
<div class="line">                SpindleSpeedRPM = 4000,</div>
<div class="line">                SpindleSpeedSPM = 126,</div>
<div class="line">                XYFeedratePM = 1000,</div>
<div class="line">                XYFeedratePT = 0.125,</div>
<div class="line">                ZFeedratePM = 1000,</div>
<div class="line">                ZFeedratePT = 0.125,</div>
<div class="line">                FeedUnit = EspritConstants.espFeedUnit.espFeedPerMinute,</div>
<div class="line">                CalculateStock = <span class="keyword">true</span>,</div>
<div class="line">                HoleOrder = EspritConstants.espHoleMachiningOrder.espHoleMachiningOrderFeatureOrder,</div>
<div class="line">                RotaryMachining = <span class="keyword">true</span>,</div>
<div class="line">                Strategy = EspritConstants.espMillSpiralStrategy.espMillSpiralStrategyTangentArcs,</div>
<div class="line">                Direction = EspritConstants.espClockDirection.espCCW,</div>
<div class="line">                ClearingStep = 2.5,</div>
<div class="line">                StepPercentOfDiameter = 25,</div>
<div class="line">                DrillHoleDiameter = 30,</div>
<div class="line">                Tolerance = 0.005,</div>
<div class="line">                TotalDepth = 0,</div>
<div class="line">                IncrementalDepth = 10,</div>
<div class="line">                RetractForIdepth = EspritConstants.espRetractMode.espRetractClearanceAboveDepth,</div>
<div class="line">                OffsetToolRadius = <span class="keyword">true</span>,</div>
<div class="line">                CutterCompNC = EspritConstants.espOffsetSide.espOffsetOff,</div>
<div class="line">                Clearance = 2,</div>
<div class="line">                ExitMode = EspritConstants.espExitMode.espExitUpThenOver,</div>
<div class="line">                EntryMode = EspritConstants.espMillEntryMode.espMillEntryOverThenDown,</div>
<div class="line">                LeadInType = EspritConstants.espMillLeadinType.espMillLeadinRadius,</div>
<div class="line">                LeadInDistance = 25,</div>
<div class="line">                LeadInRadius = 10,</div>
<div class="line">                LeadOutType = EspritConstants.espMillLeadoutType.espMillLeadoutTangent,</div>
<div class="line">                LeadOutDistance = 5</div>
<div class="line">            };</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">foreach</span> (Esprit.FeatureChain chain in Document.FeatureChains)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (chain.Name == <span class="stringliteral">&quot;4 Chain&quot;</span>)</div>
<div class="line">                {</div>
<div class="line">                    AddFeatureOperation(chain, spiralingOperation);</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> AddEngravingOperation()</div>
<div class="line">        {</div>
<div class="line">            EspritTechnology.TechMillEngraving engravingOperation = <span class="keyword">new</span> EspritTechnology.TechMillEngraving()</div>
<div class="line">            {</div>
<div class="line">                OperationName = <span class="stringliteral">&quot;Engraving&quot;</span>,</div>
<div class="line">                ToolID = <span class="stringliteral">&quot;EM5 (CM)&quot;</span>,</div>
<div class="line">                SpindleSpeedRPM = 8000,</div>
<div class="line">                SpindleSpeedSPM = 251,</div>
<div class="line">                XYFeedratePM = 1000,</div>
<div class="line">                XYFeedratePT = 0.0625,</div>
<div class="line">                ZFeedratePM = 1000,</div>
<div class="line">                ZFeedratePT = 0.0625,</div>
<div class="line">                AutomaticWorkOffsetRotation = <span class="keyword">true</span>,</div>
<div class="line">                FeedUnit = EspritConstants.espFeedUnit.espFeedPerMinute,</div>
<div class="line">                CalculateStock = <span class="keyword">true</span>,</div>
<div class="line">                FontType = EspritConstants.espMillEngraveFontType.espMillEngraveFontTypeSingleStroke,</div>
<div class="line">                SingleStrokeFontName = <span class="stringliteral">&quot;0-DIN 17 F.csv&quot;</span>,</div>
<div class="line">                Text = <span class="stringliteral">&quot;ESPRIT&quot;</span>,</div>
<div class="line">                CharacterHeight = 8,</div>
<div class="line">                CharacterWidth = 8,</div>
<div class="line">                TextPattern = EspritConstants.espMillEngraveTextPattern.espMillEngraveTextPatternCircular,</div>
<div class="line">                CenterPointX = 0,</div>
<div class="line">                CenterPointY = 0,</div>
<div class="line">                CenterPointZ = 51.562,</div>
<div class="line">                Radius = 22,</div>
<div class="line">                TextDirection = EspritConstants.espMillEngraveTextDirection.espMillEngraveTextDirectionCW,</div>
<div class="line">                StartAngle = 90,</div>
<div class="line">                HorizontalAlignment = EspritConstants.espMillEngraveHorizontalAlignment.espMillEngraveHorizontalAlignmentCenter,</div>
<div class="line">                VerticalAlignment = EspritConstants.espMillEngraveVerticalAlignment.espMillEngraveVerticalAlignmentCenter,</div>
<div class="line">                SpiralTolerance = 0.1,</div>
<div class="line">                TotalDepth = 0.5,</div>
<div class="line">                TypeOfWork = EspritConstants.espWrapDiameterSide.espWrapOutsideDiameter,</div>
<div class="line">                WorkingDiameter = EspritConstants.espWrapDiameterSide.espWrapOutsideDiameter,</div>
<div class="line">                RotaryMachining = <span class="keyword">true</span>,</div>
<div class="line">                RetractForIdepth = EspritConstants.espRetractMode.espRetractClearanceAboveSurface,</div>
<div class="line">                PolarInterpolation = <span class="keyword">false</span>,</div>
<div class="line">                LengthCompOverride = <span class="keyword">false</span>,</div>
<div class="line">                FullClearance = 10,</div>
<div class="line">                Clearance = 2,</div>
<div class="line">                EntryMode = EspritConstants.espMillPocketEntryMode.espMillPocketEntryModePlunge,</div>
<div class="line">                StepOver = 5,</div>
<div class="line">                StepPercentOfDiameter = 50,</div>
<div class="line">                CharacterWidthPercent = 100,</div>
<div class="line">                EngraveStrategy = EspritConstants.espMillEngraveStrategy.espMillEngraveStrategyContour,</div>
<div class="line">                SecondaryAxisClamp = EspritConstants.espAxisClamp.espAxisClampOff,</div>
<div class="line">                PrimaryAxisClamp = EspritConstants.espAxisClamp.espAxisClampOff,</div>
<div class="line">                TertiaryAxisClamp = EspritConstants.espAxisClamp.espAxisClampOff</div>
<div class="line">            };</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">foreach</span> (Esprit.FeatureChain chain in Document.FeatureChains)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (chain.Name == <span class="stringliteral">&quot;4 Chain&quot;</span>)</div>
<div class="line">                {</div>
<div class="line">                    AddFeatureOperation(chain, engravingOperation);</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            Document.PartOperations.RebuildAll();</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>After all set up is done, start the simulation:</p>
<div class="tab"> <div class="tablinks8" onclick="openTab(event, &apos;CShsnippet8&apos;, &apos;tabcontent8&apos;, &apos;tablinks8&apos;)">C#</div> </div><div id="CShsnippet8" class="tabcontent8"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> StartSimulation()</div>
<div class="line">        {</div>
<div class="line">            Document.Simulation.SetCollisions(<span class="keyword">true</span>);</div>
<div class="line">            Document.Simulation.PartViolationDetection = <span class="keyword">false</span>;</div>
<div class="line">            Document.Simulation.Play();</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>Make sure "Part Violation Detection" is unchecked because Contouring and Engraving operations are violating the part. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/>
<script type="text/javascript" src="restoreTabs.js"></script>
</body>
</html>
