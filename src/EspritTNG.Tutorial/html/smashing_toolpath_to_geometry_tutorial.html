<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Smashing Toolpath to Geometry</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="tutorial.css" rel="stylesheet" type="text/css" />
<link href="tab.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="tab.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Smashing Toolpath to Geometry </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The Tutorial: Examining the Toolpath introduced us to the ToolPath of the Operation. We saw that the ItemCopy method returns a ToolPathItem structure. The ToolPathItem contains an AuxCode, a Type, and Data. Some of the Type values represent arcs and segments. For these types, the Data object contains all of the information that defines that arc or segment. The question then becomes, what exactly is the Data and how is its information accessed.</p>
<p>In the case of a graphical item, the Data returned is of a class from the separate ESPRITGeometry library. Instead of Points, Arcs or Segments there will be ComPoint ComArc or ComSegment objects.</p>
<div class="tab"> <div class="tablinks" onclick="openTab(event, &apos;CShsnippet&apos;, &apos;tabcontent1&apos;, &apos;tablinks&apos;)">C#</div> </div><div id="CShsnippet" class="tabcontent1"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> SmashOperations()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (Document.Group.Count == 0)</div>
<div class="line">            {</div>
<div class="line">                Esprit.PartOperation operation = <span class="keyword">null</span>;</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">try</span></div>
<div class="line">                {</div>
<div class="line">                    operation = Document.GetAnyElement(<span class="stringliteral">&quot;Select Operation to Smash&quot;</span>, EspritConstants.espGraphicObjectType.espOperation) as Esprit.PartOperation;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">catch</span>(System.Runtime.InteropServices.COMException)</div>
<div class="line">                {</div>
<div class="line">                    <span class="comment">// Operation was not set</span></div>
<div class="line">                    <span class="keywordflow">return</span>;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                SmashOperation(operation, EspritApplication);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">for</span> (var i = 1; i &lt;= Document.Group.Count; i++)</div>
<div class="line">                {</div>
<div class="line">                    var obj = Document.Group[i] as Esprit.IGraphicObject;</div>
<div class="line">                    <span class="keywordflow">if</span> (obj.GraphicObjectType == EspritConstants.espGraphicObjectType.espOperation)</div>
<div class="line">                    {</div>
<div class="line">                        var operation = obj as Esprit.PartOperation;</div>
<div class="line">                        SmashOperation(operation, EspritApplication);</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            Document.Refresh();</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">void</span> SmashOperation(Esprit.PartOperation operation, Esprit.Application app)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (operation == <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">for</span> (var i = 1; i &lt;= operation.ToolPath.Count; i++)</div>
<div class="line">            {</div>
<div class="line">                var toolPathItem = operation.ToolPath.ItemCopy(i);</div>
<div class="line">                <span class="keywordflow">switch</span>(toolPathItem.Type)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">case</span> EspritConstants.espToolPathItemType.tpiEND_POINT:</div>
<div class="line">                    <span class="keywordflow">case</span> EspritConstants.espToolPathItemType.tpiSTART_POINT:</div>
<div class="line">                        var point = toolPathItem.data as EspritGeometryBase.IComPoint;</div>
<div class="line">                        app.Document.Points.Add(point.X, point.Y, point.Z);</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">                    <span class="keywordflow">case</span> EspritConstants.espToolPathItemType.tpiSEG2:</div>
<div class="line">                    <span class="keywordflow">case</span> EspritConstants.espToolPathItemType.tpiSEG3:</div>
<div class="line">                        var segment = toolPathItem.data as EspritGeometryBase.IComSegment;</div>
<div class="line">                        app.Document.Segments.Add(</div>
<div class="line">                            app.Document.GetPoint(segment.StartPoint.X, segment.StartPoint.Y, segment.StartPoint.Z),</div>
<div class="line">                            app.Document.GetPoint(segment.EndPoint.X, segment.EndPoint.Y, segment.EndPoint.Z)</div>
<div class="line">                         );</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">                    <span class="keywordflow">case</span> EspritConstants.espToolPathItemType.tpiARC2:</div>
<div class="line">                    <span class="keywordflow">case</span> EspritConstants.espToolPathItemType.tpiARC3:</div>
<div class="line">                        var arc = toolPathItem.data as EspritGeometryBase.IComArc;</div>
<div class="line">                        var newArc = app.Document.Arcs.Add(</div>
<div class="line">                            app.Document.GetPoint(arc.CenterPoint.X, arc.CenterPoint.Y, arc.CenterPoint.Z),</div>
<div class="line">                            arc.Radius, arc.StartAngle, arc.EndAngle);</div>
<div class="line"> </div>
<div class="line">                        newArc.Ux = arc.U.X;</div>
<div class="line">                        newArc.Uy = arc.U.Y;</div>
<div class="line">                        newArc.Uz = arc.U.Z;</div>
<div class="line">                        newArc.Vx = arc.V.X;</div>
<div class="line">                        newArc.Vy = arc.V.Y;</div>
<div class="line">                        newArc.Vz = arc.V.Z;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>Before running the code open an ESPRIT file that contains multiple operations. Group select some of those operations if you wish. Go to mask and turn off operations or suppress them so that they are not visible. Do you see the geometry that has been smashed beneath them now? </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/>
<script type="text/javascript" src="restoreTabs.js"></script>
</body>
</html>
