<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Calculate Operation Cycle Times</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="tutorial.css" rel="stylesheet" type="text/css" />
<link href="tab.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="tab.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Calculate Operation Cycle Times </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>In this tutorial you will loop through all of the operations in the document and calculate the cycle times for each and a total time for the program.</p>
<p>Note that in Tutorial: Scan Operations we were able to find the length of feed and rapid moves in an operation. This is because LengthOfFeed and LengthOfRapid are properties of the PartOperation object. But in order to calculate cycle times, we will need to know the feedrate. The feedrates are not a property of the generic PartOperation object. The feedrates belong to the specific technology object within the operation. So similar to what we did in Tutorial: Write Tool Parameters to a File, we will need to typecast the generic Technology as a specific technology object. Then we will be able to access the feedrate properties such as XYFeedratePM or FeedratePM.</p>
<div class="tab"> <div class="tablinks" onclick="openTab(event, &apos;CShsnippet&apos;, &apos;tabcontent1&apos;, &apos;tablinks&apos;)">C#</div> </div><div id="CShsnippet" class="tabcontent1"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">void</span> CalculateCycleTimes()</div>
<div class="line">        {</div>
<div class="line">            var rapidrate = Document.SystemUnit == espUnitType.espMetric</div>
<div class="line">                ? 2500</div>
<div class="line">                : 100;</div>
<div class="line"> </div>
<div class="line">            var totalTime = 0.0;</div>
<div class="line">            var time = 0.0;</div>
<div class="line">            var feedrate = 0.0;</div>
<div class="line">            var elapseTimeString = <span class="keywordtype">string</span>.Empty;</div>
<div class="line"> </div>
<div class="line">            EspritApplication.EventWindow.Clear();</div>
<div class="line">            EspritApplication.EventWindow.Visible = <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">foreach</span> (Esprit.PartOperation partOperation in Document.PartOperations)</div>
<div class="line">            {</div>
<div class="line">                var technology = partOperation.Technology as EspritTechnology.Technology;</div>
<div class="line">                <span class="keywordflow">switch</span> (technology.TechnologyType)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">case</span> espTechnologyType.espTechLatheBalanceRough:</div>
<div class="line">                        var lbr = partOperation.Technology as EspritTechnology.TechLatheBalanceRough;</div>
<div class="line">                        feedrate = lbr.FeedratePM;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> espTechnologyType.espTechLatheBarfeed:</div>
<div class="line">                        var lbe = partOperation.Technology as EspritTechnology.TechLatheBarfeed;</div>
<div class="line">                        feedrate = lbe.FeedratePM;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> espTechnologyType.espTechLatheContour:</div>
<div class="line">                        var lcn = partOperation.Technology as EspritTechnology.TechLatheContour;</div>
<div class="line">                        feedrate = lcn.FeedratePM;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> espTechnologyType.espTechLatheCopyRough:</div>
<div class="line">                        var lcr = partOperation.Technology as EspritTechnology.TechLatheCopyRough;</div>
<div class="line">                        feedrate = lcr.FeedratePM;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> espTechnologyType.espTechLatheCutoff:</div>
<div class="line">                        var lco = partOperation.Technology as EspritTechnology.TechLatheCutoff;</div>
<div class="line">                        feedrate = lco.FeedratePM;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> espTechnologyType.espTechLatheDrill:</div>
<div class="line">                        var ldr = partOperation.Technology as EspritTechnology.TechLatheDrill;</div>
<div class="line">                        feedrate = ldr.FeedratePM;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> espTechnologyType.espTechLatheGroove:</div>
<div class="line">                        var lgr = partOperation.Technology as EspritTechnology.TechLatheGroove;</div>
<div class="line">                        feedrate = lgr.FeedratePM;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> espTechnologyType.espTechLatheManual:</div>
<div class="line">                        var lmn = partOperation.Technology as EspritTechnology.TechLatheManual;</div>
<div class="line">                        feedrate = lmn.FeedratePM;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> espTechnologyType.espTechLatheMillContour:</div>
<div class="line">                        var lmc = partOperation.Technology as EspritTechnology.TechLatheMillContour;</div>
<div class="line">                        feedrate = lmc.FeedratePM;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> espTechnologyType.espTechLatheMillDrill:</div>
<div class="line">                        var lmd = partOperation.Technology as EspritTechnology.TechLatheMillDrill;</div>
<div class="line">                        feedrate = lmd.FeedratePM;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> espTechnologyType.espTechLatheMillPocket:</div>
<div class="line">                        var lmp = partOperation.Technology as EspritTechnology.TechLatheMillPocket;</div>
<div class="line">                        feedrate = lmp.FeedratePM;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> espTechnologyType.espTechLathePark:</div>
<div class="line">                        feedrate = 0;</div>
<div class="line">                        time = 2;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> espTechnologyType.espTechLathePickup:</div>
<div class="line">                        var lpu = partOperation.Technology as EspritTechnology.TechLathePickup;</div>
<div class="line">                        feedrate = lpu.FeedratePM;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> espTechnologyType.espTechLathePocket:</div>
<div class="line">                        var lpo = partOperation.Technology as EspritTechnology.TechLathePocket;</div>
<div class="line">                        feedrate = lpo.FeedratePM;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> espTechnologyType.espTechLatheRelease:</div>
<div class="line">                        var lrl = partOperation.Technology as EspritTechnology.TechLatheRelease;</div>
<div class="line">                        feedrate = lrl.FeedratePM;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> espTechnologyType.espTechLatheRough:</div>
<div class="line">                        var lrg = partOperation.Technology as EspritTechnology.TechLatheRough;</div>
<div class="line">                        feedrate = lrg.FeedratePM;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> espTechnologyType.espTechLatheTailstock:</div>
<div class="line">                        var lts = partOperation.Technology as EspritTechnology.TechLatheTailstock;</div>
<div class="line">                        feedrate = lts.FeedratePM;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> espTechnologyType.espTechLatheThread:</div>
<div class="line">                        var lth = partOperation.Technology as EspritTechnology.TechLatheThread;</div>
<div class="line">                        feedrate = lth.FeedratePM;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> espTechnologyType.espTechMill3DFinish:</div>
<div class="line">                        var l3f = partOperation.Technology as EspritTechnology.TechMill3DFinish;</div>
<div class="line">                        feedrate = l3f.XYFeedratePM;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> espTechnologyType.espTechMill3DProject:</div>
<div class="line">                        var m3p = partOperation.Technology as EspritTechnology.TechMill3DProject;</div>
<div class="line">                        feedrate = m3p.XYFeedratePM;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> espTechnologyType.espTechMill3DRemachining:</div>
<div class="line">                        var m3rem = partOperation.Technology as EspritTechnology.TechMill3DRemachining;</div>
<div class="line">                        feedrate = m3rem.XYFeedratePM;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> espTechnologyType.espTechMill3DRough:</div>
<div class="line">                        var m3rgh = partOperation.Technology as EspritTechnology.TechMill3DRough;</div>
<div class="line">                        feedrate = m3rgh.XYFeedratePM;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> espTechnologyType.espTechMill3DZLevelFinish:</div>
<div class="line">                        var m3zl = partOperation.Technology as EspritTechnology.TechMill3DZLevelFinish;</div>
<div class="line">                        feedrate = m3zl.XYFeedratePM;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> espTechnologyType.espTechMillContour:</div>
<div class="line">                        var mcn = partOperation.Technology as EspritTechnology.TechMillContour;</div>
<div class="line">                        feedrate = mcn.XYFeedratePM;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> espTechnologyType.espTechMillContour1:</div>
<div class="line">                        var mcn1 = partOperation.Technology as EspritTechnology.TechMillContour1;</div>
<div class="line">                        feedrate = mcn1.XYFeedratePM;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> espTechnologyType.espTechMillContour4x:</div>
<div class="line">                        var mc4 = partOperation.Technology as EspritTechnology.TechMillContour4x;</div>
<div class="line">                        feedrate = mc4.XYFeedratePM;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> espTechnologyType.espTechMillDrill:</div>
<div class="line">                        var mdr = partOperation.Technology as EspritTechnology.TechMillDrill;</div>
<div class="line">                        feedrate = mdr.ZFeedratePM;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> espTechnologyType.espTechMillDrill4x:</div>
<div class="line">                        var md4 = partOperation.Technology as EspritTechnology.TechMillDrill4x;</div>
<div class="line">                        feedrate = md4.ZFeedratePM;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> espTechnologyType.espTechMillFace:</div>
<div class="line">                        var mfc = partOperation.Technology as EspritTechnology.TechMillFace;</div>
<div class="line">                        feedrate = mfc.XYFeedratePM;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> espTechnologyType.espTechMillManual:</div>
<div class="line">                        var mmn = partOperation.Technology as EspritTechnology.TechMillManual;</div>
<div class="line">                        feedrate = mmn.XYFeedratePM;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> espTechnologyType.espTechMillPark:</div>
<div class="line">                        feedrate = 0;</div>
<div class="line">                        time = 2;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> espTechnologyType.espTechMillPocket:</div>
<div class="line">                        var mpo = partOperation.Technology as EspritTechnology.TechMillPocket;</div>
<div class="line">                        feedrate = mpo.XYFeedratePM;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> espTechnologyType.espTechMillPocket1:</div>
<div class="line">                        var mpo1 = partOperation.Technology as EspritTechnology.TechMillPocket1;</div>
<div class="line">                        feedrate = mpo1.XYFeedratePM;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> espTechnologyType.espTechMillPocket2:</div>
<div class="line">                        var mpo2 = partOperation.Technology as EspritTechnology.TechMillPocket2;</div>
<div class="line">                        feedrate = mpo2.XYFeedratePM;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> espTechnologyType.espTechMillPocket4x:</div>
<div class="line">                        var mpo4 = partOperation.Technology as EspritTechnology.TechMillPocket4x;</div>
<div class="line">                        feedrate = mpo4.XYFeedratePM;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> espTechnologyType.espTechMillSpiral:</div>
<div class="line">                        var msp = partOperation.Technology as EspritTechnology.TechMillSpiral;</div>
<div class="line">                        feedrate = msp.XYFeedratePM;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> espTechnologyType.espTechMillThread:</div>
<div class="line">                        var mth = partOperation.Technology as EspritTechnology.TechMillThread;</div>
<div class="line">                        feedrate = mth.XYFeedratePM;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> espTechnologyType.espTechUnknown:</div>
<div class="line">                        feedrate = 0;</div>
<div class="line">                        time = 0;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (feedrate != 0)</div>
<div class="line">                    time = partOperation.LengthOfFeed / feedrate + partOperation.LengthOfRapid / rapidrate;</div>
<div class="line"> </div>
<div class="line">                elapseTimeString += $<span class="stringliteral">&quot;OP {partOperation.Key} time is {time.ToString(&quot;</span>F<span class="stringliteral">&quot;)} minutes\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">                totalTime += time;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (elapseTimeString != <span class="keywordtype">string</span>.Empty)</div>
<div class="line">                EspritApplication.EventWindow.AddMessage(EspritConstants.espMessageType.espMessageTypeInformation, <span class="stringliteral">&quot;CalcOperationCycleTimesTutorial&quot;</span>, elapseTimeString);</div>
<div class="line"> </div>
<div class="line">            EspritApplication.EventWindow.AddMessage(EspritConstants.espMessageType.espMessageTypeInformation, <span class="stringliteral">&quot;CalcOperationCycleTimesTutorial&quot;</span>, $<span class="stringliteral">&quot;Total program time is {totalTime.ToString(&quot;</span>F<span class="stringliteral">&quot;)} minutes&quot;</span>);</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>As technologies are added to the EspritTechnology library, this program may become out of date. While it will still work for the operation technologies that are included, it will miss those that are not. However, any new technology type can be handled in the exact same manner as the other ones, so this program serves as a good template. It will be left up to the programmer to determine what, if any, technologies are missing and to add them in an appropriate manner.</p>
<p>Tutorial outputs information to the EventWindow :</p>
<div class="image">
<img src="CalcOperationCycleTimesEventWindow.png" alt=""/>
</div>
 </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/>
<script type="text/javascript" src="restoreTabs.js"></script>
</body>
</html>
