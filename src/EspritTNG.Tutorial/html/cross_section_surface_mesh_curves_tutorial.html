<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Creating Cross Section and Surface Mesh Curves</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="tutorial.css" rel="stylesheet" type="text/css" />
<link href="tab.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="tab.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Creating Cross Section and Surface Mesh Curves </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>We have seen several applications for creating curves in the previous tutorials. Another common application is the need to create multiple curves such as cross sections from large collections of point data. For example, you may import some point data that was collected from a Coordinate Measure Machine (CMM). In order to create a surface, you first need to create curves through those points. Those curves might run in one direction as parallel cross sections, or they may form an ordered mesh in two directions. Depending on how the point data is organized, we can write code to generate those curves.</p>
<p>Let us start with cross sections. We can assume that the sections are normal (perpendicular) to either the X, Y or Z axis. For that axis, the sections start at a certain value and are spaced at a constant interval. We may want to account for a slight deviation of the points from that interval. We can easily test the desired coordinate to see what cross-section the point lies in relative to the start, and then add that point to the curve for that section.</p>
<p>To be flexible, let us create a function that can create the curves normal to any of the three global axes, and that accepts an enumerated value as an argument to designate the normal axis.</p>
<div class="tab"> <div class="tablinks" onclick="openTab(event, &apos;CShsnippet&apos;, &apos;tabcontent1&apos;, &apos;tablinks&apos;)">C#</div> </div><div id="CShsnippet" class="tabcontent1"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">void</span> CreateCrossSectionCurves(Esprit.Application app,  EspSectionNormalAxis normalAxis, <span class="keywordtype">double</span> start, <span class="keywordtype">double</span> step, <span class="keywordtype">double</span> deviation = 0)</div>
<div class="line">        {</div>
<div class="line">            var document = app.Document;</div>
<div class="line">            Dictionary&lt;int, Esprit.FeaturePtop&gt; ptops = <span class="keyword">new</span> Dictionary&lt;int, Esprit.FeaturePtop&gt;();</div>
<div class="line">            Dictionary&lt;int, double&gt; min = <span class="keyword">new</span> Dictionary&lt;int, double&gt;();</div>
<div class="line">            Dictionary&lt;int, double&gt; max = <span class="keyword">new</span> Dictionary&lt;int, double&gt;();</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (var i = 1; i &lt;= document.Group.Count; i++)</div>
<div class="line">            {</div>
<div class="line">                var graphicObject = document.Group[i] as Esprit.IGraphicObject;</div>
<div class="line">                <span class="keywordflow">if</span> (graphicObject == <span class="keyword">null</span> || graphicObject.GraphicObjectType != EspritConstants.espGraphicObjectType.espPoint)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">continue</span>;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                var point = graphicObject as Esprit.Point;</div>
<div class="line">                <span class="keywordtype">double</span> pointCoordinate = 0;</div>
<div class="line">                <span class="keywordflow">switch</span>(normalAxis)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">case</span> EspSectionNormalAxis.espSectionNormalAxisX:</div>
<div class="line">                        pointCoordinate = point.X;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> EspSectionNormalAxis.espSectionNormalAxisY:</div>
<div class="line">                        pointCoordinate = point.Y;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> EspSectionNormalAxis.espSectionNormalAxisZ:</div>
<div class="line">                        pointCoordinate = point.Z;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                <span class="keywordtype">int</span> sectionNumber = (int)(Math.Abs(pointCoordinate - start) / step);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (!min.ContainsKey(sectionNumber) &amp;&amp; !max.ContainsKey(sectionNumber))</div>
<div class="line">                {</div>
<div class="line">                    min.Add(sectionNumber, start + sectionNumber * step - Math.Abs(deviation));</div>
<div class="line">                    max.Add(sectionNumber, start + sectionNumber * step + Math.Abs(deviation));</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (pointCoordinate &gt;= min[sectionNumber] &amp;&amp; pointCoordinate &lt;= max[sectionNumber])</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">if</span> (!ptops.ContainsKey(sectionNumber))</div>
<div class="line">                    {</div>
<div class="line">                        ptops.Add(sectionNumber, document.FeaturePtops.Add(point));</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">else</span></div>
<div class="line">                    {</div>
<div class="line">                        ptops[sectionNumber].Add(point);</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">foreach</span>(var section <span class="keywordflow">in</span> ptops.Values)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">try</span></div>
<div class="line">                    {</div>
<div class="line">                        <span class="keywordflow">if</span> (section.Count &gt; 1)</div>
<div class="line">                        {</div>
<div class="line">                            GraphicObjectHelper.SetDefaultAttributes(document.Curves.AddFromElement(section) as Esprit.GraphicObject, app.Configuration);</div>
<div class="line">                        }</div>
<div class="line"> </div>
<div class="line">                        document.FeaturePtops.Remove(section.Key);</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">catch</span>(Exception)</div>
<div class="line">                    {</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">void</span> SetDefaultAttributes(Esprit.GraphicObject graphicObject, Esprit.Configuration config)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">switch</span> (graphicObject.GraphicObjectType)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espAnnotation:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationNotes.Color;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espArc:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationArcs.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationArcs.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationArcs.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espCircle:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationCircles.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationCircles.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationCircles.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espCurve:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationCurves.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationCurves.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationCurves.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espDimension:</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espHatch:</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espLeader:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationDimensions.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationDimensions.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationDimensions.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espFeatureChain:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationFeatureChains.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationFeatureChains.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationFeatureChains.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espFeaturePtop:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationFeaturePtops.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationFeaturePtops.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationFeaturePtops.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espLine:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationLines.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationLines.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationLines.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espOperation:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationOperations.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationOperations.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationOperations.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espPoint:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationPoints.Color;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationPoints.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espSegment:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationSegments.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationSegments.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationSegments.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espSolidModel:</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espSTL_Model:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationPoints.Color;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>With this function, we can now create code that prompts the user for the parameters and pass those to the function to create the appropriate curves:</p>
<div class="tab"> <div class="tablinks2" onclick="openTab(event, &apos;CShsnippet2&apos;, &apos;tabcontent2&apos;, &apos;tablinks2&apos;)">C#</div> </div><div id="CShsnippet2" class="tabcontent2"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> CreateCrossSectionCurvesNormalToX()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (Document.Group.Count == 0)</div>
<div class="line">            {</div>
<div class="line">                System.Windows.MessageBox.Show(<span class="stringliteral">&quot;Please group points before running this function.&quot;</span>, <span class="stringliteral">&quot;CrossSectionSurfaceMeshCurvesTutorial&quot;</span>, MessageBoxButton.OK);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            var startX = 0.0;</div>
<div class="line">            var stepX = 1.0;</div>
<div class="line">            var deviation = 0.0;</div>
<div class="line">            <span class="keywordflow">if</span> (!RequestUserInput(<span class="stringliteral">&quot;Enter the starting X coordinate&quot;</span>, <span class="stringliteral">&quot;Start X&quot;</span>, ref startX, <span class="keyword">true</span>) ||</div>
<div class="line">                !RequestUserInput(<span class="stringliteral">&quot;Enter the cross section step in X&quot;</span>, <span class="stringliteral">&quot;Step X&quot;</span>, ref stepX, <span class="keyword">true</span>) ||</div>
<div class="line">                !RequestUserInput(<span class="stringliteral">&quot;Enter the maximum deviation&quot;</span>, <span class="stringliteral">&quot;Deviation&quot;</span>, ref deviation, <span class="keyword">true</span>))</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (stepX == 0)</div>
<div class="line">            {</div>
<div class="line">                System.Windows.MessageBox.Show(<span class="stringliteral">&quot;The value of step in x cannot be zero.&quot;</span>, <span class="stringliteral">&quot;CrossSectionSurfaceMeshCurvesTutorial&quot;</span>, MessageBoxButton.OK);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            Document.OpenUndoTransaction();</div>
<div class="line">            CreateCrossSectionCurves(EspritApplication, EspSectionNormalAxis.espSectionNormalAxisX, startX, stepX, deviation);</div>
<div class="line">            Document.CloseUndoTransaction(<span class="keyword">true</span>);</div>
<div class="line">            Document.Refresh();</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> CreateCrossSectionCurvesNormalToY()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (Document.Group.Count == 0)</div>
<div class="line">            {</div>
<div class="line">                System.Windows.MessageBox.Show(<span class="stringliteral">&quot;Please group points before running this function.&quot;</span>, <span class="stringliteral">&quot;CrossSectionSurfaceMeshCurvesTutorial&quot;</span>, MessageBoxButton.OK);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            var startY = 0.0;</div>
<div class="line">            var stepY = 1.0;</div>
<div class="line">            var deviation = 0.0;</div>
<div class="line">            <span class="keywordflow">if</span> (!RequestUserInput(<span class="stringliteral">&quot;Enter the starting Y coordinate&quot;</span>, <span class="stringliteral">&quot;Start Y&quot;</span>, ref startY, <span class="keyword">true</span>) ||</div>
<div class="line">                !RequestUserInput(<span class="stringliteral">&quot;Enter the cross section step in Y&quot;</span>, <span class="stringliteral">&quot;Step Y&quot;</span>, ref stepY, <span class="keyword">true</span>) ||</div>
<div class="line">                !RequestUserInput(<span class="stringliteral">&quot;Enter the maximum deviation&quot;</span>, <span class="stringliteral">&quot;Deviation&quot;</span>, ref deviation, <span class="keyword">true</span>))</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (stepY == 0)</div>
<div class="line">            {</div>
<div class="line">                System.Windows.MessageBox.Show(<span class="stringliteral">&quot;The value of step in y cannot be zero.&quot;</span>, <span class="stringliteral">&quot;CrossSectionSurfaceMeshCurvesTutorial&quot;</span>, MessageBoxButton.OK);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            Document.OpenUndoTransaction();</div>
<div class="line">            CreateCrossSectionCurves(EspritApplication, EspSectionNormalAxis.espSectionNormalAxisY, startY, stepY, deviation);</div>
<div class="line">            Document.CloseUndoTransaction(<span class="keyword">true</span>);</div>
<div class="line">            Document.Refresh();</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>If you do not have a file that contains a cloud of points, you could make a simple one by using the Point Array command on the geometry toolbar to create a grid of points. Examine the curves that result. You could go on to put a Lofted Surface through these curves using the Lofted Surface command on the Surfaces toolbar.</p>
<p>Note that in the code above we assume that the points in any given section are going to be in order, and not jump around in that section. If that is not the case then we could possibly Optimize the resulting feature ptops before converting them to curves. Optimize was covered in Tutorial: Optimizing FeaturePtop Objects. These functions also generate open sections, such as for a surface, but the first point could be added at the end to close each feature such as for a solid as well.</p>
<p>The important thing is to look at your data, and write code appropriate to how it is organized.</p>
<p>For example, maybe we do not need to be concerned with the coordinates of the points. Suppose we are given a mesh of points such that the points are in order. The points go along a certain direction, so we know when we come to a point that lies in the opposite direction, it is the start of a new curve. After we get the curves in that first direction, we can simply take the first point in each curve as being in the first curve in the second direction, the second point in each of the curves in the first direction as being in the second curve in the second direction, and so on.</p>
<div class="tab"> <div class="tablinks3" onclick="openTab(event, &apos;CShsnippet3&apos;, &apos;tabcontent3&apos;, &apos;tablinks3&apos;)">C#</div> </div><div id="CShsnippet3" class="tabcontent3"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> CreateXYMesh()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (Document.Group.Count == 0)</div>
<div class="line">            {</div>
<div class="line">                System.Windows.MessageBox.Show(<span class="stringliteral">&quot;Please group points before running this function.&quot;</span>, <span class="stringliteral">&quot;CrossSectionSurfaceMeshCurvesTutorial&quot;</span>, MessageBoxButton.OK);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            Esprit.Point prevPoint = <span class="keyword">null</span>;</div>
<div class="line">            Esprit.Point currentPoint = <span class="keyword">null</span>;</div>
<div class="line">            List&lt;Esprit.FeaturePtop&gt; featurePtops = <span class="keyword">new</span> List&lt;Esprit.FeaturePtop&gt;();</div>
<div class="line">            <span class="keywordflow">for</span> (var i = 1; i &lt;= Document.Group.Count; i++)</div>
<div class="line">            {</div>
<div class="line">                var graphicObject = Document.Group[i] as Esprit.IGraphicObject;</div>
<div class="line">                <span class="keywordflow">if</span> (graphicObject == <span class="keyword">null</span> || graphicObject.GraphicObjectType != EspritConstants.espGraphicObjectType.espPoint)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">continue</span>;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                <span class="keywordtype">string</span> primaryDirection = <span class="keywordtype">string</span>.Empty;</div>
<div class="line">                var point = graphicObject as Esprit.Point;</div>
<div class="line">                <span class="keywordflow">if</span> (prevPoint == <span class="keyword">null</span>)</div>
<div class="line">                {</div>
<div class="line">                    prevPoint = point;</div>
<div class="line">                    featurePtops.Add(Document.FeaturePtops.Add(prevPoint));</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">if</span> (currentPoint == <span class="keyword">null</span>)</div>
<div class="line">                    {</div>
<div class="line">                        currentPoint = point;</div>
<div class="line">                        var deltaX = currentPoint.X - prevPoint.X;</div>
<div class="line">                        var deltaY = currentPoint.Y - prevPoint.Y;</div>
<div class="line"> </div>
<div class="line">                        <span class="keywordflow">if</span> (Math.Abs(deltaX) &gt; Math.Abs(deltaY))</div>
<div class="line">                        {</div>
<div class="line">                            primaryDirection = (deltaX &gt; 0)</div>
<div class="line">                                ? <span class="stringliteral">&quot;+X&quot;</span></div>
<div class="line">                                : <span class="stringliteral">&quot;-X&quot;</span>;</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">else</span></div>
<div class="line">                        {</div>
<div class="line">                            primaryDirection = (deltaY &gt; 0)</div>
<div class="line">                                ? <span class="stringliteral">&quot;+Y&quot;</span></div>
<div class="line">                                : <span class="stringliteral">&quot;-Y&quot;</span>;</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">else</span></div>
<div class="line">                    {</div>
<div class="line">                        prevPoint = currentPoint;</div>
<div class="line">                        currentPoint = point;</div>
<div class="line">                    }</div>
<div class="line"> </div>
<div class="line">                    <span class="keywordflow">if</span> (currentPoint != <span class="keyword">null</span> &amp;&amp; prevPoint != <span class="keyword">null</span>)</div>
<div class="line">                    {</div>
<div class="line">                        <span class="keywordtype">bool</span> isDirectionChanged = <span class="keyword">false</span>;</div>
<div class="line">                        <span class="keywordflow">switch</span> (primaryDirection)</div>
<div class="line">                        {</div>
<div class="line">                            <span class="keywordflow">case</span> <span class="stringliteral">&quot;+X&quot;</span>: <span class="keywordflow">if</span> (currentPoint.X &lt; prevPoint.X) isDirectionChanged = <span class="keyword">true</span>; <span class="keywordflow">break</span>;</div>
<div class="line">                            <span class="keywordflow">case</span> <span class="stringliteral">&quot;-X&quot;</span>: <span class="keywordflow">if</span> (currentPoint.X &gt; prevPoint.X) isDirectionChanged = <span class="keyword">true</span>; <span class="keywordflow">break</span>;</div>
<div class="line">                            <span class="keywordflow">case</span> <span class="stringliteral">&quot;+Y&quot;</span>: <span class="keywordflow">if</span> (currentPoint.Y &lt; prevPoint.Y) isDirectionChanged = <span class="keyword">true</span>; <span class="keywordflow">break</span>;</div>
<div class="line">                            <span class="keywordflow">case</span> <span class="stringliteral">&quot;-Y&quot;</span>: <span class="keywordflow">if</span> (currentPoint.Y &gt; prevPoint.Y) isDirectionChanged = <span class="keyword">true</span>; <span class="keywordflow">break</span>;</div>
<div class="line">                        }</div>
<div class="line"> </div>
<div class="line">                        <span class="keywordflow">if</span> (isDirectionChanged)</div>
<div class="line">                        {</div>
<div class="line">                            featurePtops.Add(Document.FeaturePtops.Add(currentPoint));</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">else</span></div>
<div class="line">                        {</div>
<div class="line">                            featurePtops[featurePtops.Count-1].Add(currentPoint);</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line">                    </div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            var maxCount = 0;</div>
<div class="line">            <span class="keywordflow">for</span> (var i = 0; i &lt; featurePtops.Count; i++)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (maxCount &lt; featurePtops[i].Count)</div>
<div class="line">                {</div>
<div class="line">                    maxCount = featurePtops[i].Count;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            var featurePtops2 = <span class="keyword">new</span> Esprit.FeaturePtop[maxCount];</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (var i = 0; i &lt; maxCount; i++)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (i &lt; featurePtops[0].Count)</div>
<div class="line">                {</div>
<div class="line">                    featurePtops2[i] = Document.FeaturePtops.Add(featurePtops[0].Item[i+1] as Esprit.Point);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                    featurePtops2[i] = Document.FeaturePtops.Add(featurePtops[0].Item[featurePtops[0].Count] as Esprit.Point);</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">for</span> (var j = 1; j &lt; featurePtops.Count; j++)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">if</span> (i &lt; featurePtops[j].Count)</div>
<div class="line">                    {</div>
<div class="line">                        featurePtops2[i].Add(featurePtops2[j].Item[i + 1]);</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">else</span></div>
<div class="line">                    {</div>
<div class="line">                        featurePtops2[i].Add(featurePtops2[j].Item[featurePtops[0].Count]);</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (var i = 0; i &lt; featurePtops.Count; i++)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">try</span></div>
<div class="line">                {</div>
<div class="line">                    GraphicObjectHelper.SetDefaultAttributes(Document.Curves.AddFromElement(featurePtops[i]) as Esprit.GraphicObject, EspritApplication.Configuration);</div>
<div class="line">                    Document.FeaturePtops.Remove(featurePtops[i].Key);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">catch</span>(Exception)</div>
<div class="line">                {</div>
<div class="line">                    EspritApplication.EventWindow.AddMessage(EspritConstants.espMessageType.espMessageTypeWarning, <span class="stringliteral">&quot;CrossSectionSurfaceMeshCurvesTutorial&quot;</span>, $<span class="stringliteral">&quot;Creating curve [{i}] from featurePtop failed&quot;</span>);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (var i = 0; i &lt; featurePtops2.Length; i++)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">try</span></div>
<div class="line">                {</div>
<div class="line">                    GraphicObjectHelper.SetDefaultAttributes(Document.Curves.AddFromElement(featurePtops2[i]) as Esprit.GraphicObject, EspritApplication.Configuration);</div>
<div class="line">                    Document.FeaturePtops.Remove(featurePtops2[i].Key);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">catch</span> (Exception)</div>
<div class="line">                {</div>
<div class="line">                    EspritApplication.EventWindow.AddMessage(EspritConstants.espMessageType.espMessageTypeWarning, <span class="stringliteral">&quot;CrossSectionSurfaceMeshCurvesTutorial&quot;</span>, $<span class="stringliteral">&quot;Creating curve [{i}] from featurePtop failed&quot;</span>);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            Document.Refresh();</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>Again, if you do not have a file that contains a cloud of points, you could make a simple one by using the Point Array command on the geometry toolbar to create several lines of points. Each line should have the same number of points and should go in the same primary direction, but their angle and distance between points could vary. Then examine the mesh of curves that result. You could go on to put a surface through these curves using the Curve Mesh Surface command on the Surfaces toolbar. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/>
<script type="text/javascript" src="restoreTabs.js"></script>
</body>
</html>
