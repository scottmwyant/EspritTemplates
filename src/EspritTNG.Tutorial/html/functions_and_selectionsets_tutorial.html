<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: More Fun With Functions and SelectionSets</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="tutorial.css" rel="stylesheet" type="text/css" />
<link href="tab.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="tab.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">More Fun With Functions and SelectionSets </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The Tutorial: Fun with Functions expanded upon functions and showed functions that returned values such as Long integer and Boolean, as well as functions which returned objects such as Point and Layer. In this tutorial we will write functions that create many GraphicObject objects at once. For them, we will want to return a SelectionSet object.</p>
<ul>
<li>Create SelectionSet with a unique name.</li>
</ul>
<div class="tab"> <div class="tablinks1" onclick="openTab(event, &apos;CShsnippet1&apos;, &apos;tabcontent1&apos;, &apos;tablinks1&apos;)">C#</div> </div><div id="CShsnippet1" class="tabcontent1"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> SelectionSet AddUniqueSelectionSet(ISelectionSets selectionSets, <span class="keywordtype">string</span> baseName)</div>
<div class="line">        {</div>
<div class="line">            var suffix = 0;</div>
<div class="line">            <span class="keywordflow">foreach</span> (SelectionSet <span class="keyword">set</span> <span class="keywordflow">in</span> selectionSets)</div>
<div class="line">            {</div>
<div class="line">                var setName = <span class="keyword">set</span>.Name;</div>
<div class="line">                <span class="keywordflow">if</span> (setName.Length &gt; baseName.Length &amp;&amp; setName.StartsWith(baseName) &amp;&amp; setName[baseName.Length] == <span class="charliteral">&#39;_&#39;</span>)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">if</span> (Int32.TryParse(setName.Substring(baseName.Length + 1), out var index))</div>
<div class="line">                    {</div>
<div class="line">                        <span class="keywordflow">if</span> (index &gt;= suffix)</div>
<div class="line">                        {</div>
<div class="line">                            suffix = index + 1;</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            var name = $<span class="stringliteral">&quot;{baseName}_{suffix}&quot;</span>;</div>
<div class="line">            <span class="keywordflow">return</span> selectionSets.Add(name);</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><ul>
<li>Create a bolthole pattern:</li>
</ul>
<div class="tab"> <div class="tablinks2" onclick="openTab(event, &apos;CShsnippet2&apos;, &apos;tabcontent2&apos;, &apos;tablinks2&apos;)">C#</div> </div><div id="CShsnippet2" class="tabcontent2"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> BoltHoleDemo()</div>
<div class="line">        {</div>
<div class="line">            Esprit.Point point = <span class="keyword">null</span>;</div>
<div class="line"> </div>
<div class="line">            _form.Hide();</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                point = Document.GetPoint(<span class="stringliteral">&quot;Select Bolt Hole Center&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// Element was not set</span></div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (point != <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                var patternRadius = 10.0;</div>
<div class="line">                var holeRadius = 1.0;</div>
<div class="line">                var numberOfHoles = 6;</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (RequestUserInput(<span class="stringliteral">&quot;Enter Pattern Radius&quot;</span>, <span class="stringliteral">&quot;Pattern Radius&quot;</span>, ref patternRadius) &amp;&amp;</div>
<div class="line">                    RequestUserInput(<span class="stringliteral">&quot;Enter Hole Radius&quot;</span>, <span class="stringliteral">&quot;Hole Radius&quot;</span>, ref holeRadius) &amp;&amp;</div>
<div class="line">                    RequestUserInput(<span class="stringliteral">&quot;Enter Number of Holes&quot;</span>, <span class="stringliteral">&quot;Number of Holes&quot;</span>, ref numberOfHoles))</div>
<div class="line">                {</div>
<div class="line">                    FeatureHelper.BoltHolePattern(Document, point, patternRadius, holeRadius, numberOfHoles);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            Document.Refresh();</div>
<div class="line"> </div>
<div class="line">            _form.Show();</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> SelectionSet BoltHolePattern(Document document, Point center, <span class="keywordtype">double</span> patternRadius, <span class="keywordtype">double</span> holeRadius, <span class="keywordtype">int</span> numberOfHoles)</div>
<div class="line">        {</div>
<div class="line">            var boltHolePattern = SelectionSetHelper.AddUniqueSelectionSet(document.SelectionSets, <span class="stringliteral">&quot;BoltHole&quot;</span>);</div>
<div class="line">            FeaturePtop featurePtop = <span class="keyword">null</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (var i = 0; i &lt; numberOfHoles; i++)</div>
<div class="line">            {</div>
<div class="line">                var angle = i * 2 * Math.PI / numberOfHoles;</div>
<div class="line">                var x = patternRadius * Math.Cos(angle) + center.X;</div>
<div class="line">                var y = patternRadius * Math.Sin(angle) + center.Y;</div>
<div class="line"> </div>
<div class="line">                var hole = document.Circles.Add(document.GetPoint(x, y, center.Z), holeRadius);</div>
<div class="line">                boltHolePattern.Add(hole);</div>
<div class="line">                <span class="keywordflow">if</span> (featurePtop == <span class="keyword">null</span>)</div>
<div class="line">                {</div>
<div class="line">                    featurePtop = document.FeaturePtops.Add(hole.CenterPoint);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                    featurePtop.Add(hole.CenterPoint);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (featurePtop != <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                boltHolePattern.Add(featurePtop);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> boltHolePattern;</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><ul>
<li>Fill a large circular mold with as many holes as will fit. The holes will be in a hexagonal pattern, with a specified amount of spacing between them. Be sure to create a circle for the outside boundary before running the code.</li>
</ul>
<div class="tab"> <div class="tablinks3" onclick="openTab(event, &apos;CShsnippet3&apos;, &apos;tabcontent3&apos;, &apos;tablinks3&apos;)">C#</div> </div><div id="CShsnippet3" class="tabcontent3"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> MoldHoleDemo()</div>
<div class="line">        {</div>
<div class="line">            Esprit.Circle circle = <span class="keyword">null</span>;</div>
<div class="line"> </div>
<div class="line">            _form.Hide();</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                circle = Document.GetCircle(<span class="stringliteral">&quot;Pick BoundaryCircle&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// Element was not set</span></div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (circle != <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                var holeRadius = circle.Radius / 10.0;</div>
<div class="line">                var spacing = circle.Radius / 100.0;</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (RequestUserInput(<span class="stringliteral">&quot;Enter Hole Radius&quot;</span>, <span class="stringliteral">&quot;Hole Radius&quot;</span>, ref holeRadius) &amp;&amp;</div>
<div class="line">                    RequestUserInput(<span class="stringliteral">&quot;Enter Spacing&quot;</span>, <span class="stringliteral">&quot;Spacing&quot;</span>, ref spacing))</div>
<div class="line">                {</div>
<div class="line">                    FeatureHelper.MoldHolePattern(Document, circle.CenterPoint, circle.Radius, holeRadius, spacing);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            Document.Refresh();</div>
<div class="line"> </div>
<div class="line">            _form.Show();</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> SelectionSet MoldHolePattern(Document document, Point center, <span class="keywordtype">double</span> boundaryRadius, <span class="keywordtype">double</span> holeRadius, <span class="keywordtype">double</span> spacing)</div>
<div class="line">        {</div>
<div class="line">            var moldHolePattern = SelectionSetHelper.AddUniqueSelectionSet(document.SelectionSets, <span class="stringliteral">&quot;MoldHole&quot;</span>);</div>
<div class="line">            <span class="keywordflow">if</span> (boundaryRadius &lt; holeRadius)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span> moldHolePattern;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            var hole = document.Circles.Add(center, holeRadius);</div>
<div class="line">            moldHolePattern.Add(hole);</div>
<div class="line"> </div>
<div class="line">            var centerDistance = spacing + 2 * holeRadius;</div>
<div class="line">            uint ring = 0;</div>
<div class="line">            var holesOnRing = 0;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">do</span></div>
<div class="line">            {</div>
<div class="line">                ring++;</div>
<div class="line">                holesOnRing = 0;</div>
<div class="line">                var x = center.X + ring * centerDistance;</div>
<div class="line">                var y = center.Y;</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">for</span> (var sideAngleInDegrees = 120; sideAngleInDegrees &lt;= 420; sideAngleInDegrees += 60)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">for</span> (var holeOnSide = 1; holeOnSide &lt;= ring; holeOnSide++)</div>
<div class="line">                    {</div>
<div class="line">                        x = x + centerDistance * Math.Cos(sideAngleInDegrees * Math.PI / 180);</div>
<div class="line">                        y = y + centerDistance * Math.Sin(sideAngleInDegrees * Math.PI / 180);</div>
<div class="line"> </div>
<div class="line">                        var outerTangent = Geometry.Distance(x, y, center.X, center.Y) + holeRadius + spacing;</div>
<div class="line">                        <span class="keywordflow">if</span> (outerTangent &lt; boundaryRadius)</div>
<div class="line">                        {</div>
<div class="line">                            hole = document.Circles.Add(document.GetPoint(x, y, center.Z), holeRadius);</div>
<div class="line">                            moldHolePattern.Add(hole);</div>
<div class="line">                            holesOnRing++;</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line"> </div>
<div class="line">                }</div>
<div class="line">            } <span class="keywordflow">while</span> (holesOnRing != 0);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> moldHolePattern;</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><ul>
<li>Put a FeatureChain on all circles in a SelectionSet.</li>
</ul>
<div class="tab"> <div class="tablinks4" onclick="openTab(event, &apos;CShsnippet4&apos;, &apos;tabcontent4&apos;, &apos;tablinks4&apos;)">C#</div> </div><div id="CShsnippet4" class="tabcontent4"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> ChainCirclesDemo()</div>
<div class="line">        {</div>
<div class="line">            Esprit.Circle circle = <span class="keyword">null</span>;</div>
<div class="line"> </div>
<div class="line">            _form.Hide();</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                circle = Document.GetCircle(<span class="stringliteral">&quot;Pick Boundary Circle&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// Element was not set</span></div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (circle != <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                var holeRadius = circle.Radius / 10.0;</div>
<div class="line">                var spacing = circle.Radius / 100.0;</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (RequestUserInput(<span class="stringliteral">&quot;Enter Hole Radius&quot;</span>, <span class="stringliteral">&quot;Hole Radius&quot;</span>, ref holeRadius) &amp;&amp;</div>
<div class="line">                    RequestUserInput(<span class="stringliteral">&quot;Enter Spacing&quot;</span>, <span class="stringliteral">&quot;Spacing&quot;</span>, ref spacing))</div>
<div class="line">                {</div>
<div class="line">                    var pattern = FeatureHelper.MoldHolePattern(Document, circle.CenterPoint, circle.Radius, holeRadius, spacing);</div>
<div class="line">                    FeatureHelper.ChainCircles(Document, pattern, 0);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            Document.Refresh();</div>
<div class="line"> </div>
<div class="line">            _form.Show();</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> SelectionSet ChainCircles(Document document, SelectionSet selectionSet, <span class="keywordtype">double</span> startAngle)</div>
<div class="line">        {</div>
<div class="line">            var chainCircles = SelectionSetHelper.AddUniqueSelectionSet(document.SelectionSets, <span class="stringliteral">&quot;ChainCircles&quot;</span>);</div>
<div class="line">            <span class="keywordflow">for</span> (var i = 1; i &lt;= selectionSet.Count; i++)</div>
<div class="line">            {</div>
<div class="line">                var graphicObject = selectionSet[i] as IGraphicObject;</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (graphicObject.GraphicObjectType != espGraphicObjectType.espCircle)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">continue</span>;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                var circle = graphicObject as Circle;</div>
<div class="line">                var featureChain = document.FeatureChains.Add(document.GetPoint(circle.CenterPoint.X + circle.Radius * Math.Cos(startAngle), circle.CenterPoint.Y + circle.Radius * Math.Sin(startAngle), circle.CenterPoint.Z));</div>
<div class="line">                featureChain.Add(document.GetArc(circle.CenterPoint, circle.Radius, startAngle, startAngle + 2 * Math.PI));</div>
<div class="line">                chainCircles.Add(featureChain);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> chainCircles;</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>Essentially, any combination of graphic objects can be associated as a SelectionSet, and by giving each one a unique name, you are labeling them in the same way that other graphic objects are labeled. This means that later on, there is the potential for someone to pick one of these items (such as a BoltHole) and view or even edit the parameters that were used to create it. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/>
<script type="text/javascript" src="restoreTabs.js"></script>
</body>
</html>
