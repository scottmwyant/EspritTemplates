<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Create Hole Processing Info</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="tutorial.css" rel="stylesheet" type="text/css" />
<link href="tab.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="tab.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Create Hole Processing Info </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This tutorial shows how to create Leader objects and Notes, combine those two and place notes that have hole processing information near chosen circles or arcs with leaders pointing from the notes to the circle or arc.</p>
<div class="tab"> <div class="tablinks" onclick="openTab(event, &apos;CShsnippet&apos;, &apos;tabcontent1&apos;, &apos;tablinks&apos;)">C#</div> </div><div id="CShsnippet" class="tabcontent1"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">void</span> HoleProcessingInfo()</div>
<div class="line">        {</div>
<div class="line">            var text = <span class="stringliteral">&quot;Describe Center Drill / Drill / Tap or Any Other Info Here&quot;</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (!RequestUserInput(<span class="stringliteral">&quot;Enter Processing Info&quot;</span>, <span class="stringliteral">&quot;Processing Info&quot;</span>, ref text))</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            var configuration = EspritApplication.Configuration;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">foreach</span> (Esprit.Circle circule in Document.Circles)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (!circule.Grouped)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">continue</span>;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                var point1 = Document.GetPoint(circule.X + circule.Radius * Math.Cos(Math.PI / 4), circule.Y + circule.Radius * Math.Sin(Math.PI / 4), circule.Z);</div>
<div class="line">                var point2 = Document.GetPoint(circule.X + 1.5 * circule.Radius, circule.Y + 1.5 * circule.Radius, circule.Z);</div>
<div class="line">                var point3 = Document.GetPoint(circule.X + 1.75 * circule.Radius, circule.Y + 1.5 * circule.Radius, circule.Z);</div>
<div class="line">                var leader = Document.Annotations.AddLeader(point1, point2);</div>
<div class="line"> </div>
<div class="line">                leader.LeaderPoints.Add(point3);</div>
<div class="line">                leader.Color = configuration.ConfigurationDimensions.Color;</div>
<div class="line">                leader.LineType = configuration.ConfigurationDimensions.LineType;</div>
<div class="line"> </div>
<div class="line">                var notes = Document.Annotations.AddNotes();</div>
<div class="line">                notes.Color = configuration.ConfigurationNotes.Color;</div>
<div class="line">                var note = notes.Add();</div>
<div class="line">                note.Font.Name = <span class="stringliteral">&quot;Arial&quot;</span>;</div>
<div class="line">                note.Font.Size = 6;</div>
<div class="line">                note.Font.Bold = <span class="keyword">true</span>;</div>
<div class="line">                note.RotationAngle = configuration.ConfigurationAnnotation.RotationAngle;</div>
<div class="line"> </div>
<div class="line">                note.String = $<span class="stringliteral">&quot;R{circule.Radius}&quot;</span>;</div>
<div class="line">                note.X = point3.X + 0.1 * circule.Radius;</div>
<div class="line">                note.Y = point3.Y;</div>
<div class="line">                note.Z = point3.Z;</div>
<div class="line"> </div>
<div class="line">                note = notes.Add();</div>
<div class="line">                note.Font.Name = <span class="stringliteral">&quot;Arial&quot;</span>;</div>
<div class="line">                note.Font.Size = 6;</div>
<div class="line">                note.Font.Bold = <span class="keyword">true</span>;</div>
<div class="line">                note.RotationAngle = configuration.ConfigurationAnnotation.RotationAngle;</div>
<div class="line">                note.String = text;</div>
<div class="line">                note.X = point3.X + 0.1 * circule.Radius;</div>
<div class="line">                note.Y = point3.Y - note.Height;</div>
<div class="line">                note.Z = point3.Z;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">foreach</span> (Esprit.Arc arc in Document.Arcs)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (!arc.Grouped || Math.Abs(arc.EndAngle - arc.StartAngle) != 2 * Math.PI)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">continue</span>;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                var point1 = Document.GetPoint(arc.X + arc.Radius * Math.Cos(Math.PI / 4), arc.Y + arc.Radius * Math.Sin(Math.PI / 4), arc.Z);</div>
<div class="line">                var point2 = Document.GetPoint(arc.X + 1.5 * arc.Radius, arc.Y + 1.5 * arc.Radius, arc.Z);</div>
<div class="line">                var point3 = Document.GetPoint(arc.X + 1.75 * arc.Radius, arc.Y + 1.5 * arc.Radius, arc.Z);</div>
<div class="line">                var leader = Document.Annotations.AddLeader(point1, point2);</div>
<div class="line"> </div>
<div class="line">                leader.LeaderPoints.Add(point3);</div>
<div class="line">                leader.Color = configuration.ConfigurationDimensions.Color;</div>
<div class="line">                leader.LineType = configuration.ConfigurationDimensions.LineType;</div>
<div class="line"> </div>
<div class="line">                var notes = Document.Annotations.AddNotes();</div>
<div class="line">                notes.Color = configuration.ConfigurationNotes.Color;</div>
<div class="line">                var note = notes.Add();</div>
<div class="line">                note.Font.Name = <span class="stringliteral">&quot;Arial&quot;</span>;</div>
<div class="line">                note.Font.Size = 6;</div>
<div class="line">                note.Font.Bold = <span class="keyword">true</span>;</div>
<div class="line">                note.RotationAngle = configuration.ConfigurationAnnotation.RotationAngle;</div>
<div class="line"> </div>
<div class="line">                note.String = $<span class="stringliteral">&quot;R{arc.Radius}&quot;</span>;</div>
<div class="line">                note.X = point3.X + 0.1 * arc.Radius;</div>
<div class="line">                note.Y = point3.Y + 0.5 * configuration.ConfigurationAnnotation.HeightSpacing * note.Height;</div>
<div class="line">                note.Z = point3.Z;</div>
<div class="line"> </div>
<div class="line">                note = notes.Add();</div>
<div class="line">                note.Font.Name = <span class="stringliteral">&quot;Arial&quot;</span>;</div>
<div class="line">                note.Font.Size = 6;</div>
<div class="line">                note.Font.Bold = <span class="keyword">true</span>;</div>
<div class="line">                note.RotationAngle = configuration.ConfigurationAnnotation.RotationAngle;</div>
<div class="line">                note.String = text;</div>
<div class="line">                note.X = point3.X + 0.1 * arc.Radius;</div>
<div class="line">                note.Y = point3.Y - note.Height - 0.5 * configuration.ConfigurationAnnotation.HeightSpacing * note.Height;</div>
<div class="line">                note.Z = point3.Z;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>Be sure to group some circles or 360 degree arcs before running this code, then enter an appropriate description for a hole processing task, and examine the results. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/>
<script type="text/javascript" src="restoreTabs.js"></script>
</body>
</html>
