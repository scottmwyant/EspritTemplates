<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Creating Curves from Any Equation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="tutorial.css" rel="stylesheet" type="text/css" />
<link href="tab.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="tab.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Creating Curves from Any Equation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The Tutorial: Exponential and Sine Wave Curves showed how to make simple exponential and sine wave curves. The format of the code was very similar. We looped through an independent variable from a start value to an end value by a certain step, evaluated a dependent variable at that location, and then added that position to a FeaturePtop, which we later converted to a Curve with the AddFromElement method.</p>
<p>Suppose, for example, that you grind lenses. Sometimes the curve of the lens is a fourth order polynomial, of the form y = Ax^4 + Bx^3 + Cx^2 + Dx + E, while other times it is parabolic of the form y = Ax^2 + Bx + C. Or perhaps your company makes polynomial cams, where the radius of the pitch curve is a function of the rotation angle. Such cams could be anywhere from sixth to tenth order polynomials.</p>
<p>In this tutorial we will create a form that allows the user to choose the type of equation to evaluate.</p>
<p>Arrange the control on the form and align them if you like. When you are finished, your form should look similar to the one below.</p>
<div class="image">
<img src="CreatingCurvesFromAnyEquationTutorial.png" alt=""/>
</div>
<p>Set the properties of each control to the following values:</p>
<center> <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Object Type </th><th class="markdownTableHeadCenter">Name </th><th class="markdownTableHeadCenter">Properties  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">UserForm </td><td class="markdownTableBodyCenter">frmCurvesFromEquationTutorial </td><td class="markdownTableBodyCenter">Caption = Curve From Equation  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">OptionButton </td><td class="markdownTableBodyCenter">optXYCurve </td><td class="markdownTableBodyCenter">Caption = XY Curve  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">OptionButton </td><td class="markdownTableBodyCenter">optCamCurve </td><td class="markdownTableBodyCenter">Caption = Cam Curve  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">Label </td><td class="markdownTableBodyCenter">lblStartValue </td><td class="markdownTableBodyCenter">Caption = Start Value  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">Label </td><td class="markdownTableBodyCenter">lblEndValue </td><td class="markdownTableBodyCenter">Caption = End Value  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">Label </td><td class="markdownTableBodyCenter">lblStepValue </td><td class="markdownTableBodyCenter">Caption = Step Value  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">Label </td><td class="markdownTableBodyCenter">lblEquation </td><td class="markdownTableBodyCenter">Caption = Equation  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">TextBox </td><td class="markdownTableBodyCenter">txtStartValue </td><td class="markdownTableBodyCenter"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">TextBox </td><td class="markdownTableBodyCenter">txtEndValue </td><td class="markdownTableBodyCenter"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">TextBox </td><td class="markdownTableBodyCenter">txtStepValue </td><td class="markdownTableBodyCenter"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">TextBox </td><td class="markdownTableBodyCenter">txtEquation </td><td class="markdownTableBodyCenter"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">CommandButton </td><td class="markdownTableBodyCenter">cmdApply </td><td class="markdownTableBodyCenter">Caption = Apply  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">CommandButton </td><td class="markdownTableBodyCenter">cmdCancel </td><td class="markdownTableBodyCenter">Caption = Cancel  </td></tr>
</table>
</center><p>We need to define 2 functions to evaluate:</p><ul>
<li>XY curve, Y = F(X), Y = 1 * X ^ 2 + 2 * X + 3</li>
<li>Cam curve, R = F(A), where A is in radians. After we evaluate R, we simply need to convert those coordinates to X, Y coordinates to plot the points in the curve. X will be R * Cos(A), and Y is R * Sin(A).</li>
</ul>
<div class="tab"> <div class="tablinks1" onclick="openTab(event, &apos;CShsnippet1&apos;, &apos;tabcontent1&apos;, &apos;tablinks1&apos;)">C#</div> </div><div id="CShsnippet1" class="tabcontent1"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">double</span> EvaluateY(<span class="keywordtype">double</span> x)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">return</span> x * x + 2 * x + 3;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> XYCurve(<span class="keywordtype">double</span> startX, <span class="keywordtype">double</span> endX, <span class="keywordtype">double</span> stepX)</div>
<div class="line">        {</div>
<div class="line">            stepX = Math.Abs(stepX) * Math.Sign(endX - startX);</div>
<div class="line">            Esprit.FeaturePtop featurePtop = <span class="keyword">null</span>;</div>
<div class="line">            var x = startX;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (x = startX; x &lt;= endX; x+=stepX)</div>
<div class="line">            {</div>
<div class="line">                var y = EvaluateY(x);</div>
<div class="line">                var point = Document.GetPoint(x, y, 0);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (featurePtop == <span class="keyword">null</span>)</div>
<div class="line">                {</div>
<div class="line">                    featurePtop = Document.FeaturePtops.Add(point);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                    featurePtop.Add(point);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (x != endX)</div>
<div class="line">            {</div>
<div class="line">                var y = EvaluateY(endX);</div>
<div class="line">                var point = Document.GetPoint(endX, y, 0);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (featurePtop == <span class="keyword">null</span>)</div>
<div class="line">                {</div>
<div class="line">                    featurePtop = Document.FeaturePtops.Add(point);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                    featurePtop.Add(point);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (featurePtop != <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">try</span></div>
<div class="line">                {</div>
<div class="line">                    Esprit.Curve curve = Document.Curves.AddFromElement(featurePtop);</div>
<div class="line">                    GraphicObjectHelper.SetDefaultAttributes(curve as Esprit.GraphicObject, EspritApplication.Configuration);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">                { }</div>
<div class="line"> </div>
<div class="line">                Document.FeaturePtops.Remove(featurePtop.Key);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> CamCurve(<span class="keywordtype">double</span> startAngle, <span class="keywordtype">double</span> endAngle, <span class="keywordtype">double</span> stepAngle)</div>
<div class="line">        {</div>
<div class="line">            stepAngle = Math.Abs(stepAngle) * Math.Sign(endAngle - startAngle);</div>
<div class="line">            Esprit.FeaturePtop featurePtop = <span class="keyword">null</span>;</div>
<div class="line">            var a = startAngle;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (a = startAngle; a &lt;= endAngle; a += stepAngle)</div>
<div class="line">            {</div>
<div class="line">                var r = EvaluateY(a);</div>
<div class="line">                var point = Document.GetPoint(r * Math.Cos(a), r * Math.Sin(a), 0);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (featurePtop == <span class="keyword">null</span>)</div>
<div class="line">                {</div>
<div class="line">                    featurePtop = Document.FeaturePtops.Add(point);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                    featurePtop.Add(point);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (a != endAngle)</div>
<div class="line">            {</div>
<div class="line">                var r = EvaluateY(endAngle);</div>
<div class="line">                var point = Document.GetPoint(r * Math.Cos(endAngle), r * Math.Sin(endAngle), 0);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (featurePtop == <span class="keyword">null</span>)</div>
<div class="line">                {</div>
<div class="line">                    featurePtop = Document.FeaturePtops.Add(point);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                    featurePtop.Add(point);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (featurePtop != <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">try</span></div>
<div class="line">                {</div>
<div class="line">                    var curve = Document.Curves.AddFromElement(featurePtop);</div>
<div class="line">                    GraphicObjectHelper.SetDefaultAttributes(curve as Esprit.GraphicObject, EspritApplication.Configuration);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">                { }</div>
<div class="line"> </div>
<div class="line">                Document.FeaturePtops.Remove(featurePtop.Key);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">void</span> SetDefaultAttributes(Esprit.GraphicObject graphicObject, Esprit.Configuration config)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">switch</span> (graphicObject.GraphicObjectType)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espAnnotation:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationNotes.Color;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espArc:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationArcs.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationArcs.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationArcs.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espCircle:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationCircles.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationCircles.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationCircles.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espCurve:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationCurves.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationCurves.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationCurves.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espDimension:</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espHatch:</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espLeader:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationDimensions.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationDimensions.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationDimensions.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espFeatureChain:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationFeatureChains.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationFeatureChains.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationFeatureChains.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espFeaturePtop:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationFeaturePtops.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationFeaturePtops.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationFeaturePtops.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espLine:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationLines.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationLines.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationLines.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espOperation:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationOperations.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationOperations.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationOperations.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espPoint:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationPoints.Color;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationPoints.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espSegment:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationSegments.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationSegments.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationSegments.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espSolidModel:</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espSTL_Model:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationPoints.Color;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>If you need another type of equation, just modify the EvaluateY function.</p>
<p>Then assosiate the following event procedures with the form:</p>
<ul>
<li>Apply Button:</li>
</ul>
<div class="tab"> <div class="tablinks2" onclick="openTab(event, &apos;CShsnippet2&apos;, &apos;tabcontent2&apos;, &apos;tablinks2&apos;)">C#</div> </div><div id="CShsnippet2" class="tabcontent2"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnApplyButtonClick(<span class="keywordtype">object</span> sender, RoutedEventArgs e)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">double</span> startValue = 0.0;</div>
<div class="line">            <span class="keywordtype">double</span> endValue = 0.0;</div>
<div class="line">            <span class="keywordtype">double</span> stepValue = 0.0;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (!<span class="keywordtype">double</span>.TryParse(_dialog.StartValue.Text, out startValue) ||</div>
<div class="line">                !<span class="keywordtype">double</span>.TryParse(_dialog.EndValue.Text, out endValue) || </div>
<div class="line">                !<span class="keywordtype">double</span>.TryParse(_dialog.StepValue.Text, out stepValue))</div>
<div class="line">            {</div>
<div class="line">                MessageBox.Show(<span class="stringliteral">&quot;Incorrect input values.&quot;</span>, <span class="stringliteral">&quot;CreateCurvesFromAnyEquationTutorial&quot;</span>, MessageBoxButton.OK);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            _dialog.Close();</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (_dialog.Cam.IsChecked.HasValue &amp;&amp; _dialog.Cam.IsChecked.Value)</div>
<div class="line">            {</div>
<div class="line">                startValue *= (Math.PI / 180.0);</div>
<div class="line">                endValue *= (Math.PI / 180.0);</div>
<div class="line">                stepValue *= (Math.PI / 180.0);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (startValue == endValue)</div>
<div class="line">            {</div>
<div class="line">                MessageBox.Show(<span class="stringliteral">&quot;Start Value and End Value cannot be the same.&quot;</span>, <span class="stringliteral">&quot;CreateCurvesFromAnyEquationTutorial&quot;</span>, MessageBoxButton.OK);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span> (stepValue == 0)</div>
<div class="line">            {</div>
<div class="line">                MessageBox.Show(<span class="stringliteral">&quot;Step Value cannot be zero.&quot;</span>, <span class="stringliteral">&quot;CreateCurvesFromAnyEquationTutorial&quot;</span>, MessageBoxButton.OK);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (_dialog.Cam.IsChecked.HasValue &amp;&amp; _dialog.Cam.IsChecked.Value)</div>
<div class="line">            {</div>
<div class="line">                CamCurve(startValue, endValue, stepValue);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                XYCurve(startValue, endValue, stepValue);</div>
<div class="line">            }</div>
<div class="line">                </div>
<div class="line">            Document.Refresh();</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/>
<script type="text/javascript" src="restoreTabs.js"></script>
</body>
</html>
