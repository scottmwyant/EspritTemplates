<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Using Class Modules to Respond to ESPRIT Events</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="tutorial.css" rel="stylesheet" type="text/css" />
<link href="tab.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="tab.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Using Class Modules to Respond to ESPRIT Events </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>An advantage of using classes is that they can also contain event procedures. Event procedures are predefined for certain objects and are triggered when something happens to or with that object. The code inside the event procedure is what responds to the occurrence of that event.</p>
<p>For example, for the Application object, some of the events are AfterDocumentClose, AfterDocumentOpen and BeforeQuit.</p>
<p>Let us experiment with some of these events. In order to do so, in our class we will have to declare a variable of the ESPRIT.Application type.</p>
<div class="tab"> <div class="tablinks" onclick="openTab(event, &apos;CShsnippet&apos;, &apos;tabcontent1&apos;, &apos;tablinks&apos;)">C#</div> </div><div id="CShsnippet" class="tabcontent1"> <div class="fragment"><div class="line"> </div>
<div class="line">    <span class="keyword">class </span>RespondToEspritEventsHandler</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">private</span> readonly Esprit.Application _espritApplication;</div>
<div class="line">        <span class="keyword">public</span> RespondToEspritEventsHandler(Esprit.Application app)</div>
<div class="line">        {</div>
<div class="line">            _espritApplication = app;</div>
<div class="line">            app.AfterCommandRun += AfterCommandRun;</div>
<div class="line">            app.AfterDocumentClose += AfterDocumentClose;</div>
<div class="line">            app.AfterDocumentOpen += AfterDocumentOpen;</div>
<div class="line">            app.AfterNewDocumentOpen += AfterNewDocumentOpen;</div>
<div class="line">            app.AfterTemplateOpen += AfterTemplateOpen;</div>
<div class="line">            app.BeforeCommandRun += BeforeCommandRun;</div>
<div class="line">            app.BeforeQuit += BeforeQuit;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> BeforeQuit()</div>
<div class="line">        {</div>
<div class="line">            _espritApplication.EventWindow.AddMessage(EspritConstants.espMessageType.espMessageTypeInformation, <span class="stringliteral">&quot;RespondToEspritEventsTutorial&quot;</span>, <span class="stringliteral">&quot;BeforeQuit Event&quot;</span>);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> BeforeCommandRun(<span class="keywordtype">int</span> nCmdId, <span class="keywordtype">int</span> nAuxId, ref <span class="keywordtype">bool</span> bOverride)</div>
<div class="line">        {</div>
<div class="line">            _espritApplication.EventWindow.AddMessage(EspritConstants.espMessageType.espMessageTypeInformation, <span class="stringliteral">&quot;RespondToEspritEventsTutorial&quot;</span>, $<span class="stringliteral">&quot;BeforeCommandRun Event, nCmdID = {nCmdId}, nAuxId = {nAuxId}&quot;</span>);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> AfterNewDocumentOpen()</div>
<div class="line">        {</div>
<div class="line">            _espritApplication.EventWindow.AddMessage(EspritConstants.espMessageType.espMessageTypeInformation, <span class="stringliteral">&quot;RespondToEspritEventsTutorial&quot;</span>, <span class="stringliteral">&quot;AfterNewDocumentOpen Event&quot;</span>);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> AfterDocumentOpen(<span class="keywordtype">string</span> fileName)</div>
<div class="line">        {</div>
<div class="line">            _espritApplication.EventWindow.AddMessage(EspritConstants.espMessageType.espMessageTypeInformation, <span class="stringliteral">&quot;RespondToEspritEventsTutorial&quot;</span>, $<span class="stringliteral">&quot;AfterDocumentOpen Event, FileName = {fileName}&quot;</span>);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> AfterTemplateOpen(<span class="keywordtype">string</span> fileName)</div>
<div class="line">        {</div>
<div class="line">            _espritApplication.EventWindow.AddMessage(EspritConstants.espMessageType.espMessageTypeInformation, <span class="stringliteral">&quot;RespondToEspritEventsTutorial&quot;</span>, $<span class="stringliteral">&quot;AfterTemplateOpen Event, FileName = {fileName}&quot;</span>);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> AfterDocumentClose()</div>
<div class="line">        {</div>
<div class="line">            _espritApplication.EventWindow.AddMessage(EspritConstants.espMessageType.espMessageTypeInformation, <span class="stringliteral">&quot;RespondToEspritEventsTutorial&quot;</span>, $<span class="stringliteral">&quot;AfterDocumentClose Event&quot;</span>);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> AfterCommandRun(<span class="keywordtype">int</span> nCmdId, <span class="keywordtype">int</span> nAuxId)</div>
<div class="line">        {</div>
<div class="line">            _espritApplication.EventWindow.AddMessage(EspritConstants.espMessageType.espMessageTypeInformation, <span class="stringliteral">&quot;RespondToEspritEventsTutorial&quot;</span>, $<span class="stringliteral">&quot;AfterCommandRun Event, nCmdID = {nCmdId}, nAuxId = {nAuxId}&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>Now we can use this class in the following code:</p>
<div class="tab"> <div class="tablinks2" onclick="openTab(event, &apos;CShsnippet2&apos;, &apos;tabcontent2&apos;, &apos;tablinks2&apos;)">C#</div> </div><div id="CShsnippet2" class="tabcontent2"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> RespondToEspritEventsHandler _testObject;</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">void</span> ApplicationEventExample()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (_testObject == <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                EspritApplication.EventWindow.Visible = <span class="keyword">true</span>;</div>
<div class="line">                _testObject = <span class="keyword">new</span> RespondToEspritEventsHandler(EspritApplication);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>The class that we defined displays messages to the Output Window, so be sure that is visible. Then choose some commands, like fit, or create some geometry. You will see a BeforeCommandRun event followed by an AfterCommandRun event every time that you select a command. Then try to open new or an existing file. Do you get the messages for those events?</p>
<p>Tutorial outputs information to the EventWindow :</p>
<div class="image">
<img src="RespondToEspritEventsEventWindow.png" alt=""/>
</div>
 </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/>
<script type="text/javascript" src="restoreTabs.js"></script>
</body>
</html>
