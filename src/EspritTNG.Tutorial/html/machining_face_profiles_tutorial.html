<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Machining Face Profiles</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="tutorial.css" rel="stylesheet" type="text/css" />
<link href="tab.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="tab.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Machining Face Profiles </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The Tutorial: Feature Recognition: Face Profile Features introduced the CreateFaceProfileFeatures method of FeatureRecognition and discussed how it can produce both FeatureChain objects on profiles and FeaturePtop objects connecting holes. This tutorial will show how to take both types of features and automatically machine on them.</p>
<p>Suppose, for example, that your solid parts typically have circular bores and cutouts of other shapes. On bores that are above a certain minimum diameter, you first need to drill a start hole, but then you want pocket both the bores and the cutouts using the same tool and settings. The only difference will be that we will plunge into the bores at the center where the drill hole was, but not bother with entering at a drill hole for the cutouts (for now at least).</p>
<p>Notice in the code below how the various Configuration settings are used to define and limit the scope of feature recognition. The configuration settings that apply are found in three objects, ConfigurationFeatureRecognition, ConfigurationHoleRecognition, and ConfigurationProfileRecognition.</p>
<div class="tab"> <div class="tablinks" onclick="openTab(event, &apos;CShsnippet&apos;, &apos;tabcontent1&apos;, &apos;tablinks&apos;)">C#</div> </div><div id="CShsnippet" class="tabcontent1"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">void</span> MachineHoleProfiles()</div>
<div class="line">        {</div>
<div class="line">            var plane = Document.ActivePlane;</div>
<div class="line">            <span class="keywordflow">if</span> (plane.Name == <span class="keywordtype">string</span>.Empty || plane.Name == <span class="stringliteral">&quot;UVW&quot;</span>)</div>
<div class="line">            {</div>
<div class="line">                MessageBox.Show(<span class="stringliteral">&quot;Must activate a named plane. This code cannot use UVW.&quot;</span>, <span class="stringliteral">&quot;MachiningFaceProfilesTutorial&quot;</span>, MessageBoxButton.OK);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            var <span class="keyword">set</span> = SelectionSetHelper.GetSelectionSet(Document, <span class="stringliteral">&quot;Temp&quot;</span>);</div>
<div class="line">            <span class="keyword">set</span>.RemoveAll();</div>
<div class="line"> </div>
<div class="line">            Esprit.Solid solid = <span class="keyword">null</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                solid = Document.GetAnyElement(<span class="stringliteral">&quot;Select Reference Solid&quot;</span>, EspritConstants.espGraphicObjectType.espSolidModel) as Esprit.Solid;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span>(System.Runtime.InteropServices.COMException)</div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// Element was not set</span></div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (solid == <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            var minPocketDiameter = (Document.SystemUnit == EspritConstants.espUnitType.espInch)</div>
<div class="line">                ? 2.0</div>
<div class="line">                : 50.0;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (!RequestUserInput(<span class="stringliteral">&quot;Enter the Minimum Diameter for Pocketing&quot;</span>, <span class="stringliteral">&quot;Minimum Diameter&quot;</span>, ref minPocketDiameter))</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            EspritApplication.Configuration.ConfigurationFeatureRecognition.Tolerance = (Document.SystemUnit == EspritConstants.espUnitType.espInch)</div>
<div class="line">                ? 0.0001</div>
<div class="line">                : 0.0025;</div>
<div class="line"> </div>
<div class="line">            EspritApplication.Configuration.ConfigurationHoleRecognition.ConnectAllHoles = <span class="keyword">true</span>;</div>
<div class="line">            EspritApplication.Configuration.ConfigurationHoleRecognition.MaxDiameterDefined = <span class="keyword">false</span>;</div>
<div class="line">            EspritApplication.Configuration.ConfigurationHoleRecognition.MinDiameterDefined = <span class="keyword">true</span>;</div>
<div class="line">            EspritApplication.Configuration.ConfigurationHoleRecognition.MinDiameter = minPocketDiameter;</div>
<div class="line"> </div>
<div class="line">            EspritApplication.Configuration.ConfigurationProfileRecognition.CreateHoles = <span class="keyword">true</span>;</div>
<div class="line">            EspritApplication.Configuration.ConfigurationProfileRecognition.CreateProfilesOnHoles = <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">set</span>.Add(solid);</div>
<div class="line"> </div>
<div class="line">            Array faceFeatures = <span class="keyword">null</span>;</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                faceFeatures = Document.FeatureRecognition.CreateFaceProfileFeatures(<span class="keyword">set</span>, <span class="keyword">new</span> Esprit.Plane[1] { plane });</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span>(Exception)</div>
<div class="line">            {</div>
<div class="line">                MessageBox.Show(<span class="stringliteral">&quot;Fail on creationg face profile features.&quot;</span>, <span class="stringliteral">&quot;MachiningFaceProfilesTutorial&quot;</span>, MessageBoxButton.OK);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            Esprit.FeatureChain outsideProfile = <span class="keyword">null</span>;</div>
<div class="line">            <span class="keywordtype">double</span> outsideArea = 0;</div>
<div class="line">            Esprit.FeaturePtop drillFeature = <span class="keyword">null</span>;</div>
<div class="line">            var holeProfiles = <span class="keyword">new</span> List&lt;Esprit.FeatureChain&gt;();</div>
<div class="line">            var cutoutProfiles = <span class="keyword">new</span> List&lt;Esprit.FeatureChain&gt;();</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (var i = faceFeatures.GetLowerBound(0); i &lt;= faceFeatures.GetUpperBound(0); i++)</div>
<div class="line">            {</div>
<div class="line">                var graphicObject = faceFeatures.GetValue(i) as Esprit.GraphicObject;</div>
<div class="line">                <span class="keywordflow">switch</span> (graphicObject.GraphicObjectType)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espFeatureChain:</div>
<div class="line">                        var featureChain = graphicObject as Esprit.FeatureChain;</div>
<div class="line">                        <span class="keywordflow">if</span> (featureChain.Area &gt; outsideArea)</div>
<div class="line">                        {</div>
<div class="line">                            <span class="keywordflow">if</span> (outsideProfile != <span class="keyword">null</span>)</div>
<div class="line">                            {</div>
<div class="line">                                <span class="keywordflow">if</span> (outsideProfile.IsClosed &amp;&amp; outsideProfile.Count == 1)</div>
<div class="line">                                {</div>
<div class="line">                                    holeProfiles.Add(outsideProfile);</div>
<div class="line">                                }</div>
<div class="line">                                <span class="keywordflow">else</span></div>
<div class="line">                                {</div>
<div class="line">                                    cutoutProfiles.Add(outsideProfile);</div>
<div class="line">                                }</div>
<div class="line">                            }</div>
<div class="line">                            outsideProfile = featureChain;</div>
<div class="line">                            outsideArea = outsideProfile.Area;</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">else</span></div>
<div class="line">                        {</div>
<div class="line">                            <span class="keywordflow">if</span> (featureChain.IsClosed &amp;&amp; featureChain.Count == 1)</div>
<div class="line">                            {</div>
<div class="line">                                holeProfiles.Add(featureChain);</div>
<div class="line">                            }</div>
<div class="line">                            <span class="keywordflow">else</span></div>
<div class="line">                            {</div>
<div class="line">                                cutoutProfiles.Add(featureChain);</div>
<div class="line">                            }</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espFeaturePtop:</div>
<div class="line">                        var featurePtop = graphicObject as Esprit.FeaturePtop;</div>
<div class="line">                        <span class="keywordflow">if</span> (drillFeature == <span class="keyword">null</span>)</div>
<div class="line">                        {</div>
<div class="line">                            drillFeature = featurePtop;</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (featurePtop.Count &gt; drillFeature.Count)</div>
<div class="line">                        {</div>
<div class="line">                            drillFeature = featurePtop;</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (holeProfiles.Count == 0 &amp;&amp; cutoutProfiles.Count == 0)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (drillFeature != <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                var drill = <span class="keyword">new</span> EspritTechnology.TechMillDrill();</div>
<div class="line">                <span class="keywordflow">if</span> (Document.GUI.EditTechnology(drill) == EspritConstants.espGuiReturnVal.espGuiComplete)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">try</span></div>
<div class="line">                    {</div>
<div class="line">                        var obj = Document.PartOperations.Add(drill, drillFeature) as Esprit.GraphicObject;</div>
<div class="line">                        GraphicObjectHelper.SetDefaultAttributes(obj, EspritApplication.Configuration);</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">catch</span>(System.Runtime.InteropServices.COMException e)</div>
<div class="line">                    {</div>
<div class="line">                        MessageBox.Show(e.Message);</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            EspritTechnology.TechMillPocket2 millPocket1 = <span class="keyword">new</span> EspritTechnology.TechMillPocket2();</div>
<div class="line">            EspritTechnology.TechMillPocket2 millPocket2 = <span class="keyword">new</span> EspritTechnology.TechMillPocket2();</div>
<div class="line">            EspritTechnology.TechMillPocket2 millPocket3 = <span class="keyword">new</span> EspritTechnology.TechMillPocket2();</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (Document.GUI.EditTechnology(millPocket1) == EspritConstants.espGuiReturnVal.espGuiCancel)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line">            var genericTech = millPocket1 as EspritTechnology.Technology;</div>
<div class="line">            genericTech.CopyTo(millPocket2 as EspritTechnology.Technology, <span class="keyword">true</span>);</div>
<div class="line">            genericTech.CopyTo(millPocket3 as EspritTechnology.Technology, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (var i = 0; i &lt; holeProfiles.Count; i++)</div>
<div class="line">            {</div>
<div class="line">                millPocket2.EntryMode = EspritConstants.espMillPocketEntryMode.espMillPocketEntryModePlungeAtPoint;</div>
<div class="line">                millPocket2.TotalDepth = holeProfiles[i].Depth;</div>
<div class="line"> </div>
<div class="line">                var arc = holeProfiles[i].Item[1] as Esprit.Arc;</div>
<div class="line">                holeProfiles[i].LeadInPoint = arc.CenterPoint;</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">try</span></div>
<div class="line">                {</div>
<div class="line">                    var op = Document.PartOperations.Add(millPocket2, holeProfiles[i]);</div>
<div class="line">                    GraphicObjectHelper.SetDefaultAttributes(op as Esprit.GraphicObject, EspritApplication.Configuration);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">catch</span> (Exception e)</div>
<div class="line">                {</div>
<div class="line">                    MessageBox.Show(e.Message);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">for</span> (var i = 0; i &lt; cutoutProfiles.Count; i++)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (millPocket3.EntryMode == EspritConstants.espMillPocketEntryMode.espMillPocketEntryModeHelicalAtPoint)</div>
<div class="line">                {</div>
<div class="line">                    millPocket3.EntryMode = EspritConstants.espMillPocketEntryMode.espMillPocketEntryModeHelixProtected;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (millPocket3.EntryMode == EspritConstants.espMillPocketEntryMode.espMillPocketEntryModePlungeAtPoint)</div>
<div class="line">                {</div>
<div class="line">                    millPocket3.EntryMode = EspritConstants.espMillPocketEntryMode.espMillPocketEntryModePlunge;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                millPocket3.TotalDepth = cutoutProfiles[i].Depth;</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">try</span></div>
<div class="line">                {</div>
<div class="line">                    var op = Document.PartOperations.Add(millPocket3, cutoutProfiles[i]);</div>
<div class="line">                    GraphicObjectHelper.SetDefaultAttributes(op as Esprit.GraphicObject, EspritApplication.Configuration);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">catch</span> (Exception e)</div>
<div class="line">                {</div>
<div class="line">                    MessageBox.Show(e.Message);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            Document.SelectionSets.Remove(<span class="keyword">set</span>.Name);</div>
<div class="line">            Document.Refresh();</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> SelectionSet GetOrAddSelectionSet(ISelectionSets selectionSets, <span class="keywordtype">string</span> name)</div>
<div class="line">        {</div>
<div class="line">            var <span class="keyword">set</span> = selectionSets[name] ?? selectionSets.Add(name);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">set</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">void</span> SetDefaultAttributes(Esprit.GraphicObject graphicObject, Esprit.Configuration config)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">switch</span> (graphicObject.GraphicObjectType)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espAnnotation:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationNotes.Color;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espArc:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationArcs.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationArcs.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationArcs.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espCircle:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationCircles.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationCircles.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationCircles.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espCurve:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationCurves.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationCurves.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationCurves.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espDimension:</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espHatch:</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espLeader:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationDimensions.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationDimensions.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationDimensions.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espFeatureChain:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationFeatureChains.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationFeatureChains.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationFeatureChains.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espFeaturePtop:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationFeaturePtops.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationFeaturePtops.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationFeaturePtops.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espLine:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationLines.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationLines.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationLines.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espOperation:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationOperations.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationOperations.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationOperations.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espPoint:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationPoints.Color;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationPoints.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espSegment:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationSegments.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationSegments.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationSegments.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espSolidModel:</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espSTL_Model:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationPoints.Color;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>Before running the code open a file that contains a solid, or create one in the Solid Modeler. Hopefully the solid has both holes and pocket cavities in it.</p>
<p>Examine the features and operations created. Is only the FeaturePtop connecting all of the holes drilled? Do the pocket operations on the holes start in the center? Note how the LeadInPoint property of the FeatureChain was used for the entry point.</p>
<p>This tutorial, as well as the other tutorials on feature recognition, is only meant to demonstrate the power and capabilities of ESPRIT. They may not be practical examples. For instance, there is no contingency in this code for the pockets having islands. This particular code is only suitable for simple pockets with no islands. For complex pockets, we should use the CreatePocketFeatures method of FeatureRecognition. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/>
<script type="text/javascript" src="restoreTabs.js"></script>
</body>
</html>
