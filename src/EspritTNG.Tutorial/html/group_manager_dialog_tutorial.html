<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Group Manager Dialog</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="tutorial.css" rel="stylesheet" type="text/css" />
<link href="tab.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="tab.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Group Manager Dialog </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>In the Tutorial: Naming And Recalling Groups we were able to use the SelectionSet object to name and recall groups. Now we are going to improve the interface and build a complete dialog around those code to manage our groups.</p>
<p>The interface will consist of a ListBox control to list the named groups and several CommandButton controls to perform various tasks:</p>
<div class="image">
<img src="GroupManagerDialogTutorial.png" alt=""/>
</div>
<p>At the very least, we need one CommandButton for when we want to name a new group, and we need another CommandButton for when we want to recall or activate an existing group. For activating a group, the user will select a name in the list and click the Activate button. The user is allowed to select multiple group names from the list to be activated. The user also can activate a group by double clicking it in the ListBox. There is one Activate procedure that will be called both by clicking the Activate CommandButton and by double clicking the ListBox.</p>
<p>Another options available for the user are replace, rename and delete a group from the list. Delete will only remove the named selection set from the list and from the SelectionSets collection. It will not remove the GraphicObject elements that were contained in that SelectionSet from the graphics.</p>
<p>Remember that the (Name) property is the most critical property of each control, as well as of the form itself, because it is by this name that we refer to the control.</p>
<p>The properties of each control should have the following values:</p>
<center> <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Object Type </th><th class="markdownTableHeadCenter">Name </th><th class="markdownTableHeadCenter">Properties  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">UserForm </td><td class="markdownTableBodyCenter">frmGroupManagerDialogTutorial </td><td class="markdownTableBodyCenter">Caption = Groups  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter"></td><td class="markdownTableBodyCenter"></td><td class="markdownTableBodyCenter">ShowModal = False  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">ListBox </td><td class="markdownTableBodyCenter">lstGroups </td><td class="markdownTableBodyCenter">MultiSelect = 2 - fmMultiSelectExtended  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">CommandButton </td><td class="markdownTableBodyCenter">cmdActivate </td><td class="markdownTableBodyCenter">Caption = Activate  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">CommandButton </td><td class="markdownTableBodyCenter">cmdNew </td><td class="markdownTableBodyCenter">Caption = New ...  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">CommandButton </td><td class="markdownTableBodyCenter">cmdDelete </td><td class="markdownTableBodyCenter">Caption = Delete  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">CommandButton </td><td class="markdownTableBodyCenter">cmdReplace </td><td class="markdownTableBodyCenter">Caption = Replace  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">CommandButton </td><td class="markdownTableBodyCenter">cmdRename </td><td class="markdownTableBodyCenter">Caption = Rename  </td></tr>
</table>
</center><p>Arrange the control on the form and align them if you like. When you are finished, assosiate the following event procedures with the form:</p>
<ul>
<li>Activate button:</li>
</ul>
<div class="tab"> <div class="tablinks" onclick="openTab(event, &apos;CShsnippet&apos;, &apos;tabcontent1&apos;, &apos;tablinks&apos;)">C#</div> </div><div id="CShsnippet" class="tabcontent1"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnActiveButtonClick(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            Document.Group.Clear();</div>
<div class="line"> </div>
<div class="line">            var selectedItems = _listBox.SelectedItems;</div>
<div class="line">            <span class="keywordflow">for</span> (var i = selectedItems.Count - 1; i &gt;= 0; i--)</div>
<div class="line">            {</div>
<div class="line">                var <span class="keyword">set</span> = Document.SelectionSets[selectedItems[i]];</div>
<div class="line">                <span class="keywordflow">for</span> (var j = 1; j &lt;= <span class="keyword">set</span>.Count; j++)</div>
<div class="line">                {</div>
<div class="line">                    var obj = <span class="keyword">set</span>[j] as Esprit.GraphicObject;</div>
<div class="line">                    obj.Grouped = <span class="keyword">true</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            Document.Refresh();</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><ul>
<li>New button:</li>
</ul>
<div class="tab"> <div class="tablinks2" onclick="openTab(event, &apos;CShsnippet2&apos;, &apos;tabcontent2&apos;, &apos;tablinks2&apos;)">C#</div> </div><div id="CShsnippet2" class="tabcontent2"> <div> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnNewButtonClick(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            var groupName = $<span class="stringliteral">&quot;Group {Document.SelectionSets.Count + 1}&quot;</span>;</div>
<div class="line">            Esprit.SelectionSet <span class="keyword">set</span> = <span class="keyword">null</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">do</span></div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (!RequestUserInput(<span class="stringliteral">&quot;Enter Group Name&quot;</span>, <span class="stringliteral">&quot;Group Name&quot;</span>, ref groupName) || groupName.Length == 0)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">return</span>;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (GroupNameExists(groupName))</div>
<div class="line">                {</div>
<div class="line">                    var result = System.Windows.MessageBox.Show($<span class="stringliteral">&quot;{groupName} already exists. Do you wish to replace it?&quot;</span>, <span class="stringliteral">&quot;GroupManagerDialogTutorial&quot;</span>, MessageBoxButton.YesNoCancel);</div>
<div class="line">                    <span class="keywordflow">switch</span> (result)</div>
<div class="line">                    {</div>
<div class="line">                        <span class="keywordflow">case</span> MessageBoxResult.Yes:</div>
<div class="line">                            <span class="keyword">set</span> = Document.SelectionSets[groupName];</div>
<div class="line">                            <span class="keyword">set</span>.RemoveAll();</div>
<div class="line">                            <span class="keywordflow">break</span>;</div>
<div class="line">                        <span class="keywordflow">case</span> MessageBoxResult.No:</div>
<div class="line">                            <span class="keywordflow">break</span>;</div>
<div class="line">                        <span class="keywordflow">case</span> MessageBoxResult.Cancel:</div>
<div class="line">                            <span class="keywordflow">return</span>;</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                    <span class="keyword">set</span> = Document.SelectionSets.Add(groupName);</div>
<div class="line">                    _listBox.Items.Add(groupName);</div>
<div class="line">                }</div>
<div class="line">            } <span class="keywordflow">while</span> (<span class="keyword">set</span> == <span class="keyword">null</span>);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (var i = 1; i &lt;= Document.Group.Count; i++)</div>
<div class="line">            {</div>
<div class="line">                <span class="keyword">set</span>.Add(Document.Group[i]);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div> <div> The following function is used to check if such group already exists: </div> <div> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">bool</span> GroupNameExists(<span class="keywordtype">string</span> groupName)</div>
<div class="line">        {</div>
<div class="line">            var result = <span class="keyword">false</span>;</div>
<div class="line">            <span class="keywordflow">foreach</span> (Esprit.SelectionSet <span class="keyword">set</span> in Document.SelectionSets)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (<span class="keyword">set</span>.Name == groupName)</div>
<div class="line">                {</div>
<div class="line">                    result = <span class="keyword">true</span>;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> result;</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div> </div><ul>
<li>Delete button:</li>
</ul>
<div class="tab"> <div class="tablinks3" onclick="openTab(event, &apos;CShsnippet3&apos;, &apos;tabcontent3&apos;, &apos;tablinks3&apos;)">C#</div> </div><div id="CShsnippet3" class="tabcontent3"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnDeleteButtonClick(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            var selectedItems = _listBox.SelectedItems;</div>
<div class="line">            <span class="keywordflow">for</span> (var i = selectedItems.Count -1; i &gt;= 0; i--)</div>
<div class="line">            {</div>
<div class="line">                Document.SelectionSets.Remove(selectedItems[i] as <span class="keywordtype">string</span>);</div>
<div class="line">                _listBox.Items.Remove(selectedItems[i]);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><ul>
<li>Rename button:</li>
</ul>
<div class="tab"> <div class="tablinks4" onclick="openTab(event, &apos;CShsnippet4&apos;, &apos;tabcontent4&apos;, &apos;tablinks4&apos;)">C#</div> </div><div id="CShsnippet4" class="tabcontent4"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnRenameButtonClick(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (_listBox.SelectedItems.Count != 1)</div>
<div class="line">            {</div>
<div class="line">                System.Windows.MessageBox.Show(<span class="stringliteral">&quot;Please select one and only one Group for Rename.&quot;</span>, <span class="stringliteral">&quot;GroupManagerDialogTutorial&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                var oldName = _listBox.SelectedItem as string;</div>
<div class="line">                var newName = oldName;</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">do</span></div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">if</span> (!RequestUserInput(<span class="stringliteral">&quot;Enter Group Name&quot;</span>, <span class="stringliteral">&quot;Group Name&quot;</span>, ref newName))</div>
<div class="line">                    {</div>
<div class="line">                        <span class="keywordflow">return</span>;</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">if</span> (newName == <span class="keywordtype">string</span>.Empty)</div>
<div class="line">                    {</div>
<div class="line">                        System.Windows.MessageBox.Show(<span class="stringliteral">&quot;Name cannot be empty. Please enter group name.&quot;</span>, <span class="stringliteral">&quot;GroupManagerDialogTutorial&quot;</span>, MessageBoxButton.OKCancel);</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!GroupNameExists(newName))</div>
<div class="line">                    {</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (System.Windows.MessageBox.Show($<span class="stringliteral">&quot;{newName} already exists. Please choose another name.&quot;</span>, <span class="stringliteral">&quot;GroupManagerDialogTutorial&quot;</span>, MessageBoxButton.OKCancel) == MessageBoxResult.Cancel)</div>
<div class="line">                    {</div>
<div class="line">                        <span class="keywordflow">return</span>;</div>
<div class="line">                    }</div>
<div class="line">                } <span class="keywordflow">while</span> (<span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (newName.Length &gt; 0)</div>
<div class="line">                {</div>
<div class="line">                    Document.SelectionSets[_listBox.SelectedItem].Name = newName;</div>
<div class="line">                    _listBox.Items[_listBox.SelectedIndex] = newName;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><ul>
<li>Replace button:</li>
</ul>
<div class="tab"> <div class="tablinks5" onclick="openTab(event, &apos;CShsnippet5&apos;, &apos;tabcontent5&apos;, &apos;tablinks5&apos;)">C#</div> </div><div id="CShsnippet5" class="tabcontent5"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnReplaceButtonClick(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (_listBox.SelectedItems.Count != 1)</div>
<div class="line">            {</div>
<div class="line">                System.Windows.MessageBox.Show(<span class="stringliteral">&quot;Please select one and only one Group for Replace.&quot;</span>, <span class="stringliteral">&quot;GroupManagerDialogTutorial&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                var <span class="keyword">set</span> = Document.SelectionSets[_listBox.SelectedItem];</div>
<div class="line">                <span class="keyword">set</span>.RemoveAll();</div>
<div class="line">                <span class="keywordflow">for</span> (var i = 1; i &lt;= Document.Group.Count; i++)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keyword">set</span>.Add(Document.Group[i]);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>Initialise the list box on the form with the existing group names:</p>
<div class="tab"> <div class="tablinks6" onclick="openTab(event, &apos;CShsnippet6&apos;, &apos;tabcontent6&apos;, &apos;tablinks6&apos;)">C#</div> </div><div id="CShsnippet6" class="tabcontent6"> <div class="fragment"><div class="line"> </div>
<div class="line">            <span class="keywordflow">foreach</span> (Esprit.SelectionSet <span class="keyword">set</span> in Document.SelectionSets)</div>
<div class="line">            {</div>
<div class="line">                _listBox.Items.Add(<span class="keyword">set</span>.Name);</div>
<div class="line">            }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>With the dialog open, group elements and then use the New button to give the group a name. After naming several groups, try out the functions on the other buttons. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/>
<script type="text/javascript" src="restoreTabs.js"></script>
</body>
</html>
