<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Introduction to Using UserForms</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="tutorial.css" rel="stylesheet" type="text/css" />
<link href="tab.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="tab.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Introduction to Using UserForms </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This tutorial shows the key points how forms can be integrated into ESPRIT code, how to use different types of controls and actually turn processing of the program over to the form.</p>
<p>Just like the objects in ESPRIT, forms and the controls on forms all have properties, methods, and events.</p>
<p>This tutorial works with a simple form that only asks for the Number of Passes, Initial Stock, and Final Stock, and gives the user a button to Edit Technology, and for OK and Cancel:</p>
<div class="image">
<img src="UserFormsTutorial.png" alt=""/>
</div>
<p>Set the properties of each control to the following values:</p>
<center> <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Object Type </th><th class="markdownTableHeadCenter">Name </th><th class="markdownTableHeadCenter">Properties  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">UserForm </td><td class="markdownTableBodyCenter">frmUserFormsTutorial </td><td class="markdownTableBodyCenter">Caption = Multi Pass Contour  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">Label </td><td class="markdownTableBodyCenter">lblNumberOfPasses </td><td class="markdownTableBodyCenter">Caption = Number of Passes  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">Label </td><td class="markdownTableBodyCenter">lblInitialStock </td><td class="markdownTableBodyCenter">Caption = Initial Stock  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">Label </td><td class="markdownTableBodyCenter">lblFinalStock </td><td class="markdownTableBodyCenter">Caption = Final Stock  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">TextBox </td><td class="markdownTableBodyCenter">txtNumberOfPasses </td><td class="markdownTableBodyCenter">TextAlign = 3 - fmTextAlignRight  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">TextBox </td><td class="markdownTableBodyCenter">txtInitialStock </td><td class="markdownTableBodyCenter">TextAlign = 3 - fmTextAlignRight  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">TextBox </td><td class="markdownTableBodyCenter">txtFinalStock </td><td class="markdownTableBodyCenter">TextAlign = 3 - fmTextAlignRight  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">CommandButton </td><td class="markdownTableBodyCenter">cmdEditTechnology </td><td class="markdownTableBodyCenter">Caption = Edit Technology  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">CommandButton </td><td class="markdownTableBodyCenter">cmdOK </td><td class="markdownTableBodyCenter">Caption = OK  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">CommandButton </td><td class="markdownTableBodyCenter">cmdCancel </td><td class="markdownTableBodyCenter">Caption = Cancel  </td></tr>
</table>
</center><p>The (Name) property is the most critical property of each control, as well as of the form itself, because it is by this name that we refer to the control.</p>
<p>Arrange the control on the form and align them if you like. When you are finished, assosiate the following event procedures with the form:</p>
<p><a class="anchor" id="AnchorOnButtonOkClick"></a></p><ul>
<li>OK Button:</li>
</ul>
<div class="tab"> <div class="tablinks1" onclick="openTab(event, &apos;CShsnippet1&apos;, &apos;tabcontent1&apos;, &apos;tablinks1&apos;)">C#</div> </div><div id="CShsnippet1" class="tabcontent1"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnButtonOkClick(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (_techMillContour1.ToolID == <span class="keywordtype">string</span>.Empty)</div>
<div class="line">            {</div>
<div class="line">                MessageBox.Show(<span class="stringliteral">&quot;No tool was found. Press Edit Technology button to select a tool&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (!<span class="keywordtype">int</span>.TryParse(txtNumberOfPasses.Text, out var numberOfPasses))</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (numberOfPasses &gt; 0)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordtype">double</span>.TryParse(txtInitialStock.Text, out var initialStock);</div>
<div class="line">                <span class="keywordtype">double</span>.TryParse(txtFinalStock.Text, out var finalStock);</div>
<div class="line"> </div>
<div class="line">                CloseForm();</div>
<div class="line"> </div>
<div class="line">                Esprit.FeatureChain featureChain = <span class="keyword">null</span>;</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">try</span></div>
<div class="line">                {</div>
<div class="line">                    featureChain = Document.GetAnyElement(<span class="stringliteral">&quot;Select Reference Feature&quot;</span>, EspritConstants.espGraphicObjectType.espFeatureChain) as Esprit.FeatureChain;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">                {</div>
<div class="line">                    <span class="comment">// Element was not set</span></div>
<div class="line">                    <span class="keywordflow">return</span>;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (featureChain == <span class="keyword">null</span>)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">return</span>;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> ((_techMillContour1.LeadInType == EspritConstants.espMillLeadinType.espMillLeadinPosition) ||</div>
<div class="line">                                    (_techMillContour1.LeadInType == EspritConstants.espMillLeadinType.espMillLeadinPositionRadius) ||</div>
<div class="line">                                    (_techMillContour1.LeadInType == EspritConstants.espMillLeadinType.espMillLeadinPositionRadiusNormal))</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">try</span></div>
<div class="line">                    {</div>
<div class="line">                        featureChain.LeadInPoint = Document.GetPoint(<span class="stringliteral">&quot;Select Entry Point&quot;</span>);</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">                    {</div>
<div class="line">                        <span class="comment">// Element was not set</span></div>
<div class="line">                        <span class="keywordflow">return</span>;</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> ((_techMillContour1.LeadOutType == EspritConstants.espMillLeadoutType.espMillLeadoutPosition) ||</div>
<div class="line">                    (_techMillContour1.LeadOutType == EspritConstants.espMillLeadoutType.espMillLeadoutPositionRadius) ||</div>
<div class="line">                    (_techMillContour1.LeadOutType == EspritConstants.espMillLeadoutType.espMillLeadoutPositionRadiusNormal))</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">try</span></div>
<div class="line">                    {</div>
<div class="line">                        featureChain.LeadOutPoint = Document.GetPoint(<span class="stringliteral">&quot;Select Exit Point&quot;</span>);</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">                    {</div>
<div class="line">                        <span class="comment">// Element was not set</span></div>
<div class="line">                        <span class="keywordflow">return</span>;</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                <span class="keywordtype">double</span> stockIncrement = numberOfPasses == 1 ? 0 : (initialStock - finalStock) / (numberOfPasses - 1);</div>
<div class="line">                <span class="keywordflow">for</span> (var i = 0; i &lt; numberOfPasses; i++)</div>
<div class="line">                {</div>
<div class="line">                    _techMillContour1.StockAllowance = initialStock - i * stockIncrement;</div>
<div class="line">                    <span class="keywordflow">try</span></div>
<div class="line">                    {</div>
<div class="line">                        Document.PartOperations.Add(_techMillContour1, featureChain);</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">                    {</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                Document.Refresh();</div>
<div class="line"> </div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><ul>
<li>Cancel Button:</li>
</ul>
<div class="tab"> <div class="tablinks2" onclick="openTab(event, &apos;CShsnippet2&apos;, &apos;tabcontent2&apos;, &apos;tablinks2&apos;)">C#</div> </div><div id="CShsnippet2" class="tabcontent2"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnCancelButtonClick(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            CloseForm();</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keywordtype">void</span> CloseForm()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (_form != <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                _form.Close();</div>
<div class="line">                _form = <span class="keyword">null</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p><a class="anchor" id="AnchorOnEditTechnologyButtonClick"></a></p><ul>
<li>Edit Technology Button:</li>
</ul>
<div class="tab"> <div class="tablinks3" onclick="openTab(event, &apos;CShsnippet3&apos;, &apos;tabcontent3&apos;, &apos;tablinks3&apos;)">C#</div> </div><div id="CShsnippet3" class="tabcontent3"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnEditTechnologyButtonClick(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            var tools = Document.Tools as EspritTools.Tools;</div>
<div class="line"> </div>
<div class="line">            EspritConstants.espGuiReturnVal res = EspritConstants.espGuiReturnVal.espGuiComplete;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (tools.Count == 0)</div>
<div class="line">            {</div>
<div class="line">                var technologyUtility = Document.TechnologyUtility as EspritTechnology.TechnologyUtility;</div>
<div class="line">                var toolEndMill = technologyUtility.CreateTechnology(EspritConstants.espTechnologyType.espToolMillEndMill, Document.SystemUnit);</div>
<div class="line"> </div>
<div class="line">                var parameter = toolEndMill.FindParameter(<span class="stringliteral">&quot;ToolID&quot;</span>);</div>
<div class="line">                <span class="keywordflow">if</span> (parameter != <span class="keyword">null</span>)</div>
<div class="line">                {</div>
<div class="line">                    parameter.Value = <span class="stringliteral">&quot;EM 3&quot;</span>;</div>
<div class="line">                }</div>
<div class="line">                parameter = toolEndMill.FindParameter(<span class="stringliteral">&quot;Comment&quot;</span>);</div>
<div class="line">                <span class="keywordflow">if</span> (parameter != <span class="keyword">null</span>)</div>
<div class="line">                {</div>
<div class="line">                    parameter.Value = <span class="stringliteral">&quot;This endmill was added by tutorial extension&quot;</span>;</div>
<div class="line">                }</div>
<div class="line">                parameter = toolEndMill.FindParameter(<span class="stringliteral">&quot;ToolNumber&quot;</span>);</div>
<div class="line">                <span class="keywordflow">if</span> (parameter != <span class="keyword">null</span>)</div>
<div class="line">                {</div>
<div class="line">                    parameter.Value = 3;</div>
<div class="line">                }</div>
<div class="line">                parameter = toolEndMill.FindParameter(<span class="stringliteral">&quot;Coolant&quot;</span>);</div>
<div class="line">                <span class="keywordflow">if</span> (parameter != <span class="keyword">null</span>)</div>
<div class="line">                {</div>
<div class="line">                    parameter.Value = EspritConstants.espCoolantType.espCoolantOn;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                res = Document.GUI.EditTool(toolEndMill);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (res != EspritConstants.espGuiReturnVal.espGuiCancel)</div>
<div class="line">                {</div>
<div class="line">                    tools.Add(toolEndMill);</div>
<div class="line">                    _techMillContour1.ToolID = toolEndMill.Caption;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (res != EspritConstants.espGuiReturnVal.espGuiCancel)</div>
<div class="line">            {</div>
<div class="line">                Document.GUI.EditTechnology(_techMillContour1);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>To launch the tutorial execute the following code in your main procedure:</p>
<div class="tab"> <div class="tablinks5" onclick="openTab(event, &apos;CShsnippet5&apos;, &apos;tabcontent5&apos;, &apos;tablinks5&apos;)">C#</div> </div><div id="CShsnippet5" class="tabcontent5"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">void</span> MultiPassContourForm()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (_techMillContour1 == <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                _techMillContour1 = <span class="keyword">new</span> EspritTechnology.TechMillContour1();</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (_form == <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                Show();</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/>
<script type="text/javascript" src="restoreTabs.js"></script>
</body>
</html>
