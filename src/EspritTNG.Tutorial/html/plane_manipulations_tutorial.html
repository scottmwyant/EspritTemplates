<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: More Work Plane Manipulations</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="tutorial.css" rel="stylesheet" type="text/css" />
<link href="tab.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="tab.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">More Work Plane Manipulations </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The Tutorial: Introduction to Plane Manipulation Methods showed how to change the location of the current active work plane. This was done via the Translate and Parallel methods. This tutorial will show how to create copies of the current plane at several locations, and it will introduce the Rotate and RotateUVW methods. With Rotate and RotateUVW the direction vectors of the plane can easily be changed.</p>
<p>For the first example, suppose that we want to create parallel planes at several locations. These locations will be represented by a group of points. We would need a function that took a point as an argument and returned a new plane with a unique name.</p>
<div class="tab"> <div class="tablinks" onclick="openTab(event, &apos;CShsnippet&apos;, &apos;tabcontent1&apos;, &apos;tablinks&apos;)">C#</div> </div><div id="CShsnippet" class="tabcontent1"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> CopyWorkPlaneToPointDemo()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">for</span> (var i = 1; i &lt;= Document.Group.Count; i++)</div>
<div class="line">            {</div>
<div class="line">                var graphicObject = Document.Group[i] as Esprit.IGraphicObject;</div>
<div class="line">                <span class="keywordflow">if</span> (graphicObject.GraphicObjectType == EspritConstants.espGraphicObjectType.espPoint)</div>
<div class="line">                {</div>
<div class="line">                    PlaneHelper.CopyWorkPlaneToPoint(Document.Planes, Document.ActivePlane, graphicObject as Esprit.Point);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> Esprit.Plane CopyWorkPlaneToPoint(Esprit.IPlanes planes, Esprit.IPlane planeToCopy, Esprit.Point point)</div>
<div class="line">        {</div>
<div class="line">            var plane = (planeToCopy.Name == <span class="keywordtype">string</span>.Empty)</div>
<div class="line">                ? AddUniquePlane(planes, <span class="stringliteral">&quot;UVW Copy&quot;</span>)</div>
<div class="line">                : AddUniquePlane(planes, $<span class="stringliteral">&quot;{planeToCopy.Name} Copy&quot;</span>);</div>
<div class="line"> </div>
<div class="line">            plane.IsWork = <span class="keyword">true</span>;</div>
<div class="line">            plane.Ux = planeToCopy.Ux;</div>
<div class="line">            plane.Uy = planeToCopy.Uy;</div>
<div class="line">            plane.Uz = planeToCopy.Uz;</div>
<div class="line">            plane.Vx = planeToCopy.Vx;</div>
<div class="line">            plane.Vy = planeToCopy.Vy;</div>
<div class="line">            plane.Vz = planeToCopy.Vz;</div>
<div class="line">            plane.Wx = planeToCopy.Wx;</div>
<div class="line">            plane.Wy = planeToCopy.Wy;</div>
<div class="line">            plane.Wz = planeToCopy.Wz;</div>
<div class="line">            plane.X = point.X;</div>
<div class="line">            plane.Y = point.Y;</div>
<div class="line">            plane.Z = point.Z;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> plane;</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>In ESPRIT, create a group of points. You can then run the code. Make sure your UVW Axis is visible (View &gt; UVW Axis) and then go to the Work Planes pull-down and select each of the copies. You should see the position of the work plane switch to one of the points in the group.</p>
<p>Suppose that the location of these planes is correct, but the UVW orientation is not quite right. For example, maybe some of them need to be rotated 90 degrees about W, so that the U axis goes where the V axis was. The RotateUVW method is provided to rotate a plane about its own U, V, and W axes. The following code will rotate the active plane 90 degrees about W.</p>
<div class="tab"> <div class="tablinks2" onclick="openTab(event, &apos;CShsnippet2&apos;, &apos;tabcontent2&apos;, &apos;tablinks2&apos;)">C#</div> </div><div id="CShsnippet2" class="tabcontent2"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> RotateActivePlanePlus90()</div>
<div class="line">        {</div>
<div class="line">            Document.ActivePlane.RotateUVW(0, 0, 90 * Math.PI / 180);</div>
<div class="line">            Document.ActivePlane.Activate();</div>
<div class="line">            Document.Refresh();</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> RotateActivePlaneMinus90()</div>
<div class="line">        {</div>
<div class="line">            Document.ActivePlane.RotateUVW(0, 0, -90 * Math.PI / 180);</div>
<div class="line">            Document.ActivePlane.Activate();</div>
<div class="line">            Document.Refresh();</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>Another common thing to see with planes is that perhaps you have the three vectors you want, but it is the wrong combination. For example, your U should be where the V is, V should be where W is, and W should be where U is. You need to flip U to V, V to W, and W to U. Well, we know how to get U to go where V was. For that we rotate 90 about W. Once we have that, we can get the other two vectors where we want by rotating 90 degrees about U. So for this application we will do RotateUVW twice. If we need to go the opposite direction, W to V, V to U, U to W, then we just change the order and sign of the rotation.</p>
<div class="tab"> <div class="tablinks3" onclick="openTab(event, &apos;CShsnippet3&apos;, &apos;tabcontent3&apos;, &apos;tablinks3&apos;)">C#</div> </div><div id="CShsnippet3" class="tabcontent3"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> FlipPlaneUtoVtoW()</div>
<div class="line">        {</div>
<div class="line">            Document.ActivePlane.RotateUVW(0, 0, 90 * Math.PI / 180);</div>
<div class="line">            Document.ActivePlane.RotateUVW(90 * Math.PI / 180, 0, 0);</div>
<div class="line">            Document.ActivePlane.Activate();</div>
<div class="line">            Document.Refresh();</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> FlipPlaneWtoVtoU()</div>
<div class="line">        {</div>
<div class="line">            Document.ActivePlane.RotateUVW(-90 * Math.PI / 180, 0, 0);</div>
<div class="line">            Document.ActivePlane.RotateUVW(0, 0, -90 * Math.PI / 180);</div>
<div class="line">            Document.ActivePlane.Activate();</div>
<div class="line">            Document.Refresh();</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>Notice that with RotateUVW, the work plane stays in the same location. Only the vectors change. Suppose that we have a part that we have created several work planes on. We are going to machine four of these parts on a tombstone. We are able to create rotated copies of the part around the tombstone, but this does not copy the work planes. Suppose that we want to have copies of the work planes, too. In this case, Rotate UVW would not work, because not only are the vectors changing, but the location is too. Here is where we can use the Rotate method to rotate the plane about a line in space. When the codeis run, the first copy (Copy 1) of each plane will be rotated 90 degrees about Z from the original, Copy 2 will be 180, and Copy 3 will be 270.</p>
<div class="tab"> <div class="tablinks4" onclick="openTab(event, &apos;CShsnippet4&apos;, &apos;tabcontent4&apos;, &apos;tablinks4&apos;)">C#</div> </div><div id="CShsnippet4" class="tabcontent4"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> CopyWorkPlanesAroundZ()</div>
<div class="line">        {</div>
<div class="line">            Esprit.Plane [] planes = <span class="keyword">new</span> Esprit.Plane [3];</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">foreach</span> (Esprit.Plane plane in Document.Planes)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (plane.IsWork)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">if</span> (plane.Name != <span class="stringliteral">&quot;XYZ&quot;</span> &amp;&amp; plane.Name != <span class="stringliteral">&quot;ZXY&quot;</span> &amp;&amp; plane.Name != <span class="stringliteral">&quot;YZX&quot;</span>)</div>
<div class="line">                    {</div>
<div class="line">                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++)</div>
<div class="line">                        {</div>
<div class="line">                            planes[i] = PlaneHelper.AddUniquePlane(Document.Planes, plane.Name + <span class="stringliteral">&quot; Copy &quot;</span>);</div>
<div class="line"> </div>
<div class="line">                            planes[i].IsWork = <span class="keyword">true</span>;</div>
<div class="line">                            planes[i].Ux = plane.Ux;</div>
<div class="line">                            planes[i].Uy = plane.Uy;</div>
<div class="line">                            planes[i].Uz = plane.Uz;</div>
<div class="line">                            planes[i].Vx = plane.Vx;</div>
<div class="line">                            planes[i].Vy = plane.Vy;</div>
<div class="line">                            planes[i].Vz = plane.Vz;</div>
<div class="line">                            planes[i].Wx = plane.Wx;</div>
<div class="line">                            planes[i].Wy = plane.Wy;</div>
<div class="line">                            planes[i].Wz = plane.Wz;</div>
<div class="line">                            planes[i].X = plane.X;</div>
<div class="line">                            planes[i].Y = plane.Y;</div>
<div class="line">                            planes[i].Z = plane.Z;</div>
<div class="line"> </div>
<div class="line">                            planes[i].Rotate(Document.GetLine(Document.GetPoint(0, 0, 0), 0, 0, 1), i * 90 * Math.PI / 180);</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> Esprit.Plane AddUniquePlane(Esprit.IPlanes planes, <span class="keywordtype">string</span> baseName)</div>
<div class="line">        {</div>
<div class="line">            var suffix = 0;</div>
<div class="line">            <span class="keywordflow">foreach</span> (Esprit.Plane plane in planes)</div>
<div class="line">            {</div>
<div class="line">                var planeName = plane.Name;</div>
<div class="line">                <span class="keywordflow">if</span> (planeName.Length &gt; baseName.Length &amp;&amp; planeName.StartsWith(baseName) &amp;&amp; planeName[baseName.Length] == <span class="charliteral">&#39;_&#39;</span>)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">if</span> (<span class="keywordtype">int</span>.TryParse(planeName.Substring(baseName.Length + 1), out var index))</div>
<div class="line">                    {</div>
<div class="line">                        <span class="keywordflow">if</span> (index &gt;= suffix)</div>
<div class="line">                        {</div>
<div class="line">                            suffix = index + 1;</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            var name = $<span class="stringliteral">&quot;{baseName}_{suffix}&quot;</span>;</div>
<div class="line">            <span class="keywordflow">return</span> planes.Add(name);</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/>
<script type="text/javascript" src="restoreTabs.js"></script>
</body>
</html>
