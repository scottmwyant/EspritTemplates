<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Break Leader</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="tutorial.css" rel="stylesheet" type="text/css" />
<link href="tab.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="tab.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Break Leader </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>In the Tutorial: Create Center Lines as Leaders we saw how to create Leader objects. The leaders we created only contained two LeaderPoints. A Leader may contain any number of LeaderPoints. What if you had previously created a leader, but now as you add to your drawing, you realize that leader is in the way of where you want to place other information. You do not want to remove the leader and recreate it; you just want to insert a point or two in the middle to move it out of the way. In this way you will break the leader or dogleg it around the other information that you wish to place.</p>
<p>Just like other objects that contain objects, the LeaderPoints has an Add method and both Count and Item properties.</p>
<div class="tab"> <div class="tablinks" onclick="openTab(event, &apos;CShsnippet&apos;, &apos;tabcontent1&apos;, &apos;tablinks&apos;)">C#</div> </div><div id="CShsnippet" class="tabcontent1"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">void</span> BreakLeader()</div>
<div class="line">        {</div>
<div class="line">            Esprit.Leader leader = <span class="keyword">null</span>;</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                leader = Document.GetAnyElement(<span class="stringliteral">&quot;Select Leader to Break&quot;</span>, EspritConstants.espGraphicObjectType.espLeader) as Esprit.Leader;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// Element was not set</span></div>
<div class="line">                MessageBox.Show(<span class="stringliteral">&quot;No leader was selected&quot;</span>, <span class="stringliteral">&quot;BreakLeaderTutorial&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (leader == <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            EspritApplication.EventWindow.AddMessage(EspritConstants.espMessageType.espMessageTypeInformation, <span class="stringliteral">&quot;BreakLeader&quot;</span>, $<span class="stringliteral">&quot;Selected Leader contains {leader.LeaderPoints.Count} points.&quot;</span>);</div>
<div class="line"> </div>
<div class="line">            var leaderPoints = <span class="keyword">new</span> List&lt;Esprit.Point&gt;();</div>
<div class="line">            <span class="keywordflow">for</span> (var i = 1; i &lt;= leader.LeaderPoints.Count; i++)</div>
<div class="line">            {</div>
<div class="line">                leaderPoints.Add(leader.LeaderPoints.Item[i]);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            var index = 2;</div>
<div class="line">            var mask = <span class="keyword">new</span> EspritConstants.espGraphicObjectType[2]</div>
<div class="line">                {</div>
<div class="line">                    EspritConstants.espGraphicObjectType.espLeader,</div>
<div class="line">                    EspritConstants.espGraphicObjectType.espPoint</div>
<div class="line">                };</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">do</span></div>
<div class="line">            {</div>
<div class="line">                Esprit.IGraphicObject graphicObject = <span class="keyword">null</span>;</div>
<div class="line">                <span class="keywordflow">try</span></div>
<div class="line">                {</div>
<div class="line">                    graphicObject = Document.GetAnyElement($<span class="stringliteral">&quot;Select New Leader Vertex {index} Reselect Leader To Move to Next Vertex&quot;</span>, mask);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">return</span>;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span>(graphicObject == <span class="keyword">null</span>)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">return</span>;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (graphicObject.GraphicObjectType == EspritConstants.espGraphicObjectType.espPoint)</div>
<div class="line">                {</div>
<div class="line">                    leaderPoints.Add(leaderPoints.Last());</div>
<div class="line"> </div>
<div class="line">                    <span class="keywordflow">for</span> (var j = leader.LeaderPoints.Count; j &gt;= index; j--)</div>
<div class="line">                    {</div>
<div class="line">                        leaderPoints[j] = leaderPoints[j - 1];</div>
<div class="line">                        leader.LeaderPoints.Remove(j);</div>
<div class="line">                    }</div>
<div class="line"> </div>
<div class="line">                    leaderPoints[index - 1] = graphicObject as Esprit.Point;</div>
<div class="line"> </div>
<div class="line">                    <span class="keywordflow">for</span> (var j = index; j &lt;= leaderPoints.Count; j++)</div>
<div class="line">                    {</div>
<div class="line">                        leader.LeaderPoints.Add(leaderPoints[j - 1]);</div>
<div class="line">                    }</div>
<div class="line"> </div>
<div class="line">                    Document.Refresh();</div>
<div class="line"> </div>
<div class="line">                    <span class="keywordflow">if</span> (MessageBox.Show(<span class="stringliteral">&quot;Continue to Break?&quot;</span>, <span class="stringliteral">&quot;Continue&quot;</span>, MessageBoxButton.YesNo) == MessageBoxResult.No)</div>
<div class="line">                    {</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                index++;</div>
<div class="line"> </div>
<div class="line">            } <span class="keywordflow">while</span> (index &lt;= leader.LeaderPoints.Count);</div>
<div class="line"> </div>
<div class="line">            EspritApplication.EventWindow.AddMessage(EspritConstants.espMessageType.espMessageTypeInformation, <span class="stringliteral">&quot;BreakLeader&quot;</span>, $<span class="stringliteral">&quot;After operation the Leader contains {leader.LeaderPoints.Count} points.&quot;</span>);</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>Make sure you watch the prompt and follow its instructions as you run the code. After you select a leader, you can select a new point to insert, or select on the leader again to move to the next vertex. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/>
<script type="text/javascript" src="restoreTabs.js"></script>
</body>
</html>
