<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Custom Iso View Dialog</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="tutorial.css" rel="stylesheet" type="text/css" />
<link href="tab.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="tab.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Custom Iso View Dialog </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>In Tutorial: Introduction to Creating Planes we saw how to create one isometric view. If you think about it, there are really 24 possible isometric views. Any one of the three axes, X, Y, or Z, could be vertical on the screen, with either their + or - end up. That is six combinations. For each of those six, the other two axes could be rotated so that we are looking from one of four possible quadrants. That gives 24 isometric views.</p>
<p>For all of those combinations, we know that the vertical axis will have a vector with components of +/-(-0.57735, -0.57735, 0.57735). The axis which goes from the lower left to the upper right will have components of +/-(0.70711, -0.70711, 0.0), and the axis which goes from lower right to upper left will have a vector with components of +/-(0.40825, 0.40825, 0.8165). Nine vector components for 24 planes is 216 values to get correct. Instead of doing all that work, though, let's go with one set of values and use the Rotate and RotateUVW methods of the plane to get the other combinations.</p>
<p>Arrange the control on the form and align them if you like. When you are finished, your form should look similar to the one below.</p>
<div class="image">
<img src="CustomIsoViewDialogTutorial.png" alt=""/>
</div>
<p>Set the properties of each control to the following values:</p>
<center> <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Object Type </th><th class="markdownTableHeadCenter">Name </th><th class="markdownTableHeadCenter">Properties  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">UserForm </td><td class="markdownTableBodyCenter">frmIsoViewTutorial </td><td class="markdownTableBodyCenter">Caption = CustomIsoViewDialogTutorial  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">GroupBox/Frame </td><td class="markdownTableBodyCenter">fraOrientation </td><td class="markdownTableBodyCenter">Caption = Orientation  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">CheckBox/ToggleButton </td><td class="markdownTableBodyCenter">tglXYZPlus </td><td class="markdownTableBodyCenter">Caption = XYZ+  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">CheckBox/ToggleButton </td><td class="markdownTableBodyCenter">tglXYZMinus </td><td class="markdownTableBodyCenter">Caption = XYZ-  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">CheckBox/ToggleButton </td><td class="markdownTableBodyCenter">tglZXYPlus </td><td class="markdownTableBodyCenter">Caption = ZXY+  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">CheckBox/ToggleButton </td><td class="markdownTableBodyCenter">tglZXYMinus </td><td class="markdownTableBodyCenter">Caption = ZXY-  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">CheckBox/ToggleButton </td><td class="markdownTableBodyCenter">tglYZXPlus </td><td class="markdownTableBodyCenter">Caption = YZX+  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">CheckBox/ToggleButton </td><td class="markdownTableBodyCenter">tglYZXMinus </td><td class="markdownTableBodyCenter">Caption = YZX-  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">GroupBox/Frame </td><td class="markdownTableBodyCenter">fraQuadrant </td><td class="markdownTableBodyCenter">Caption = Quadrant  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">CheckBox/ToggleButton </td><td class="markdownTableBodyCenter">tglQuadrant1 </td><td class="markdownTableBodyCenter">Caption = 1  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">CheckBox/ToggleButton </td><td class="markdownTableBodyCenter">tglQuadrant2 </td><td class="markdownTableBodyCenter">Caption = 2  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">CheckBox/ToggleButton </td><td class="markdownTableBodyCenter">tglQuadrant3 </td><td class="markdownTableBodyCenter">Caption = 3  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">CheckBox/ToggleButton </td><td class="markdownTableBodyCenter">tglQuadrant4 </td><td class="markdownTableBodyCenter">Caption = 4  </td></tr>
</table>
</center><p>First create a working plane:</p>
<div class="tab"> <div class="tablinks" onclick="openTab(event, &apos;CShsnippet&apos;, &apos;tabcontent1&apos;, &apos;tablinks&apos;)">C#</div> </div><div id="CShsnippet" class="tabcontent1"> <div class="fragment"><div class="line"> </div>
<div class="line">            _plane = PlaneHelper.GetPlane(Document, <span class="stringliteral">&quot;Custom Iso View&quot;</span>);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (_plane == <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                _form.Close();</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            _plane.IsWork = <span class="keyword">true</span>;</div>
<div class="line">            _plane.X = _plane.Y = _plane.Z = 0;</div>
<div class="line">            var point = Document.GetPoint(0, 0, 0);</div>
<div class="line">            _lines.Add(Document.GetLine(point, 1, 0, 0));</div>
<div class="line">            _lines.Add(Document.GetLine(point, 0, 1, 0));</div>
<div class="line">            _lines.Add(Document.GetLine(point, 0, 0, 1));</div>
<div class="line"> </div>
</div><!-- fragment --> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> Esprit.Plane GetPlane(Esprit.Document document, <span class="keywordtype">string</span> name)</div>
<div class="line">        {</div>
<div class="line">            Esprit.Plane plane = <span class="keyword">null</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">foreach</span> (Esprit.Plane p in document.Planes)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (p.Name == name)</div>
<div class="line">                {</div>
<div class="line">                    plane = p;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (plane == <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                plane = document.Planes.Add(name);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> plane;</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>Then assosiate the following event procedures with the form:</p>
<p><a class="anchor" id="AnchorSetPlane"></a> </p><div class="tab"> <div class="tablinks2" onclick="openTab(event, &apos;CShsnippet2&apos;, &apos;tabcontent2&apos;, &apos;tablinks2&apos;)">C#</div> </div><div id="CShsnippet2" class="tabcontent2"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> SetPlane()</div>
<div class="line">        {</div>
<div class="line">            _ignoreChanges = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (_orientation == 0 || _quadrant == 0)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">switch</span> (Math.Abs(_orientation))</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">case</span> 1:</div>
<div class="line">                    _plane.Ux = 0;</div>
<div class="line">                    _plane.Uy = 0.70711;</div>
<div class="line">                    _plane.Uz = -0.70711;</div>
<div class="line">                    _plane.Vx = 0.8165;</div>
<div class="line">                    _plane.Vy = 0.40825;</div>
<div class="line">                    _plane.Vz = 0.40825;</div>
<div class="line">                    _plane.Wx = 0.57735;</div>
<div class="line">                    _plane.Wy = -0.57735;</div>
<div class="line">                    _plane.Wz = -0.57735;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> 2:</div>
<div class="line">                    _plane.Ux = -0.70711;</div>
<div class="line">                    _plane.Uy = 0;</div>
<div class="line">                    _plane.Uz = 0.70711;</div>
<div class="line">                    _plane.Vx = 0.40825;</div>
<div class="line">                    _plane.Vy = 0.8165;</div>
<div class="line">                    _plane.Vz = 0.40825;</div>
<div class="line">                    _plane.Wx = -0.57735;</div>
<div class="line">                    _plane.Wy = 0.57735;</div>
<div class="line">                    _plane.Wz = -0.57735;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> 3:</div>
<div class="line">                    _plane.Ux = 0.70711;</div>
<div class="line">                    _plane.Uy = -0.70711;</div>
<div class="line">                    _plane.Uz = 0;</div>
<div class="line">                    _plane.Vx = 0.40825;</div>
<div class="line">                    _plane.Vy = 0.40825;</div>
<div class="line">                    _plane.Vz = 0.8165;</div>
<div class="line">                    _plane.Wx = -0.57735;</div>
<div class="line">                    _plane.Wy = -0.57735;</div>
<div class="line">                    _plane.Wz = 0.57735;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">switch</span> (Math.Sign(_orientation))</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">case</span> 1:</div>
<div class="line">                    <span class="keywordflow">switch</span> (_quadrant)</div>
<div class="line">                    {</div>
<div class="line">                        <span class="keywordflow">case</span> 1:</div>
<div class="line">                            _plane.Rotate(_lines[Math.Abs(_orientation)-1], Math.PI);</div>
<div class="line">                            <span class="keywordflow">break</span>;</div>
<div class="line">                        <span class="keywordflow">case</span> 2:</div>
<div class="line">                            _plane.Rotate(_lines[Math.Abs(_orientation) - 1], -Math.PI/2);</div>
<div class="line">                            <span class="keywordflow">break</span>;</div>
<div class="line">                        <span class="keywordflow">case</span> 4:</div>
<div class="line">                            _plane.Rotate(_lines[Math.Abs(_orientation) - 1], Math.PI / 2);</div>
<div class="line">                            <span class="keywordflow">break</span>;</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> -1:</div>
<div class="line">                    _plane.RotateUVW(Math.PI, 0, 0);</div>
<div class="line">                    <span class="keywordflow">switch</span> (_quadrant)</div>
<div class="line">                    {</div>
<div class="line">                        <span class="keywordflow">case</span> 1:</div>
<div class="line">                            _plane.Rotate(_lines[Math.Abs(_orientation) - 1], Math.PI / 2);</div>
<div class="line">                            <span class="keywordflow">break</span>;</div>
<div class="line">                        <span class="keywordflow">case</span> 2:</div>
<div class="line">                            _plane.Rotate(_lines[Math.Abs(_orientation) - 1], Math.PI);</div>
<div class="line">                            <span class="keywordflow">break</span>;</div>
<div class="line">                        <span class="keywordflow">case</span> 4:</div>
<div class="line">                            _plane.Rotate(_lines[Math.Abs(_orientation) - 1], -Math.PI / 2);</div>
<div class="line">                            <span class="keywordflow">break</span>;</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            _plane.Activate();</div>
<div class="line">            Document.Refresh();</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnTglXYZMinusClick(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (!_ignoreChanges)</div>
<div class="line">            {</div>
<div class="line">                _orientation = -3;</div>
<div class="line">                SwitchOrientation(sender as CheckBox);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnTglXYZPlusClick(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (!_ignoreChanges)</div>
<div class="line">            {</div>
<div class="line">                _orientation = 3;</div>
<div class="line">                SwitchOrientation(sender as CheckBox);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnTglYZXMinusClick(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (!_ignoreChanges)</div>
<div class="line">            {</div>
<div class="line">                _orientation = -1;</div>
<div class="line">                SwitchOrientation(sender as CheckBox);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnTglYZXPlusClick(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (!_ignoreChanges)</div>
<div class="line">            {</div>
<div class="line">                _orientation = 1;</div>
<div class="line">                SwitchOrientation(sender as CheckBox);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnTglZXYMinusClick(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (!_ignoreChanges)</div>
<div class="line">            {</div>
<div class="line">                _orientation = -2;</div>
<div class="line">                SwitchOrientation(sender as CheckBox);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnTglZXYPlusClick(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (!_ignoreChanges)</div>
<div class="line">            {</div>
<div class="line">                _orientation = 2;</div>
<div class="line">                SwitchOrientation(sender as CheckBox);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> SwitchQuadrant(CheckBox button)</div>
<div class="line">        {</div>
<div class="line">            _ignoreChanges = <span class="keyword">true</span>;</div>
<div class="line">            tglQuadrant1.Checked = <span class="keyword">false</span>;</div>
<div class="line">            tglQuadrant2.Checked = <span class="keyword">false</span>;</div>
<div class="line">            tglQuadrant3.Checked = <span class="keyword">false</span>;</div>
<div class="line">            tglQuadrant4.Checked = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">            button.Checked = <span class="keyword">true</span>;</div>
<div class="line">            SetPlane();</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> SwitchOrientation(CheckBox button)</div>
<div class="line">        {</div>
<div class="line">            _ignoreChanges = <span class="keyword">true</span>;</div>
<div class="line">            tglXYZMinus.Checked = <span class="keyword">false</span>;</div>
<div class="line">            tglXYZPlus.Checked = <span class="keyword">false</span>;</div>
<div class="line">            tglYZXMinus.Checked = <span class="keyword">false</span>;</div>
<div class="line">            tglYZXPlus.Checked = <span class="keyword">false</span>;</div>
<div class="line">            tglZXYMinus.Checked = <span class="keyword">false</span>;</div>
<div class="line">            tglZXYPlus.Checked = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">            button.Checked = <span class="keyword">true</span>;</div>
<div class="line">            SetPlane();</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnTglQuadrant1Click(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (!_ignoreChanges)</div>
<div class="line">            {</div>
<div class="line">                _quadrant = 1;</div>
<div class="line">                SwitchQuadrant(sender as CheckBox);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnTglQuadrant2Click(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (!_ignoreChanges)</div>
<div class="line">            {</div>
<div class="line">                _quadrant = 2;</div>
<div class="line">                SwitchQuadrant(sender as CheckBox);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnTglQuadrant3Click(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (!_ignoreChanges)</div>
<div class="line">            {</div>
<div class="line">                _quadrant = 3;</div>
<div class="line">                SwitchQuadrant(sender as CheckBox);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnTglQuadrant4Click(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (!_ignoreChanges)</div>
<div class="line">            {</div>
<div class="line">                _quadrant = 4;</div>
<div class="line">                SwitchQuadrant(sender as CheckBox);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>Select various combinations of orientation and Quadrant. You should see the UVW work plane change. To get the view to change, you currently must select that View name from the Views pull-down. Note that you may want to draw some geometry or open an existing file to help you visualize the results. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/>
<script type="text/javascript" src="restoreTabs.js"></script>
</body>
</html>
