<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Thrown for a Curve</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="tutorial.css" rel="stylesheet" type="text/css" />
<link href="tab.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="tab.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Thrown for a Curve </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>One of the few graphic objects that we have not looked at yet is the Curve object. Like other graphic objects, there is a Curves collection, and it has a Count property and an Item property. As with other collections, we can also use looping to go through the individual Curve objects. Those objects have certain properties in common with other objects, such as Length and IsClosed, but Curve objects also have many unique properties, such as MinCurvature and MaxCurvature and IsPeriodic. To begin with, let us just loop through the curves collection and display these properties:</p>
<p><a class="anchor" id="AnchorScanCurves"></a> </p><div class="tab"> <div class="tablinks" onclick="openTab(event, &apos;CShsnippet&apos;, &apos;tabcontent1&apos;, &apos;tablinks&apos;)">C#</div> </div><div id="CShsnippet" class="tabcontent1"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> ScanCurves()</div>
<div class="line">        {</div>
<div class="line">            var outputWindow = EspritApplication.EventWindow;</div>
<div class="line"> </div>
<div class="line">            outputWindow.Clear();</div>
<div class="line">            outputWindow.Visible = <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">foreach</span>(Esprit.Curve curve in Document.Curves)</div>
<div class="line">            {</div>
<div class="line">                outputWindow.AddMessage(EspritConstants.espMessageType.espMessageTypeInformation, <span class="stringliteral">&quot;ThrownForCurveTutorial&quot;</span>, $<span class="stringliteral">&quot;Curve {curve.Key} IsClosed = {curve.IsClosed}&quot;</span>);</div>
<div class="line">                outputWindow.AddMessage(EspritConstants.espMessageType.espMessageTypeInformation, <span class="stringliteral">&quot;ThrownForCurveTutorial&quot;</span>, $<span class="stringliteral">&quot;Curve {curve.Key} IsPeriodic = {curve.IsPeriodic}&quot;</span>);</div>
<div class="line">                outputWindow.AddMessage(EspritConstants.espMessageType.espMessageTypeInformation, <span class="stringliteral">&quot;ThrownForCurveTutorial&quot;</span>, $<span class="stringliteral">&quot;Curve {curve.Key} Layer Name = {curve.Layer.Name}&quot;</span>);</div>
<div class="line">                outputWindow.AddMessage(EspritConstants.espMessageType.espMessageTypeInformation, <span class="stringliteral">&quot;ThrownForCurveTutorial&quot;</span>, $<span class="stringliteral">&quot;Curve {curve.Key} Length = {Math.Round(curve.Length, 5)}&quot;</span>);</div>
<div class="line">                outputWindow.AddMessage(EspritConstants.espMessageType.espMessageTypeInformation, <span class="stringliteral">&quot;ThrownForCurveTutorial&quot;</span>, $<span class="stringliteral">&quot;Curve {curve.Key} MaxCurvature = {Math.Round(curve.MaxCurvature, 5)}&quot;</span>);</div>
<div class="line">                outputWindow.AddMessage(EspritConstants.espMessageType.espMessageTypeInformation, <span class="stringliteral">&quot;ThrownForCurveTutorial&quot;</span>, $<span class="stringliteral">&quot;Curve {curve.Key} MinCurvature = {Math.Round(curve.MinCurvature, 5)}&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>Before running the code, open a file that has curves in it or manually create some yourself. A 3D wireframe file, perhaps from another cad system via iges, would be a good choice as those often contain many curves.</p>
<p>Tutorial outputs information to the EventWindow :</p>
<div class="image">
<img src="ThrownForCurveEventWindow.png" alt=""/>
</div>
<p>The Curves collection does not have a single method for creating new curve objects. Instead there are the methods Add, AddFromElement, and AddHelix. Suppose we just want to create a curve through the grouped points. We simply need to build an array out of the points in the group, and then pass that array to the Add method.</p>
<div class="tab"> <div class="tablinks2" onclick="openTab(event, &apos;CShsnippet2&apos;, &apos;tabcontent2&apos;, &apos;tablinks2&apos;)">C#</div> </div><div id="CShsnippet2" class="tabcontent2"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> GroupedPointsToCurve()</div>
<div class="line">        {</div>
<div class="line">            var points = <span class="keyword">new</span> List&lt;Esprit.Point&gt;();</div>
<div class="line">            <span class="keywordflow">for</span> (var i = 1; i &lt;= Document.Group.Count; i++)</div>
<div class="line">            {</div>
<div class="line">                var graphicObject = Document.Group[i] as Esprit.IGraphicObject;</div>
<div class="line">                <span class="keywordflow">if</span> (graphicObject.GraphicObjectType == EspritConstants.espGraphicObjectType.espPoint)</div>
<div class="line">                {</div>
<div class="line">                    points.Add(graphicObject as Esprit.Point);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (points.Count != 0)</div>
<div class="line">            {</div>
<div class="line">                Document.Curves.Add(points.ToArray());</div>
<div class="line">                Document.Refresh();</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>Before running the code, create some points and then group them. Notice that the curve that is created is open. That is, it starts at the first point, and ends at the last. What if we only want to create closed curves that come back to the first point? Insert the code below to do just that.</p>
<p><a class="anchor" id="AnchorGroupedPointsToClosedCurve"></a> </p><div class="tab"> <div class="tablinks3" onclick="openTab(event, &apos;CShsnippet3&apos;, &apos;tabcontent3&apos;, &apos;tablinks3&apos;)">C#</div> </div><div id="CShsnippet3" class="tabcontent3"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> GroupedPointsToClosedCurve()</div>
<div class="line">        {</div>
<div class="line">            var points = <span class="keyword">new</span> List&lt;Esprit.Point&gt;();</div>
<div class="line">            <span class="keywordflow">for</span> (var i = 1; i &lt;= Document.Group.Count; i++)</div>
<div class="line">            {</div>
<div class="line">                var graphicObject = Document.Group[i] as Esprit.IGraphicObject;</div>
<div class="line">                <span class="keywordflow">if</span> (graphicObject.GraphicObjectType == EspritConstants.espGraphicObjectType.espPoint)</div>
<div class="line">                {</div>
<div class="line">                    points.Add(graphicObject as Esprit.Point);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (points.Count != 0)</div>
<div class="line">            {</div>
<div class="line">                points.Add(points[0]);</div>
<div class="line"> </div>
<div class="line">                Document.Curves.Add(points.ToArray());</div>
<div class="line">                Document.Refresh();</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>In ESPRIT you can not directly machine an ellipse. You need to convert the ellipse into a form the machine can recognize. The first function below takes an elliptical arc or circle and returns a curve. The second function below will check to see if a group is defined, and if it is it will convert all arcs and circles in the group, otherwise it prompts the user to select the ellipse.</p>
<p><a class="anchor" id="AnchorConvertEllipseToCurve"></a> </p><div class="tab"> <div class="tablinks4" onclick="openTab(event, &apos;CShsnippet4&apos;, &apos;tabcontent4&apos;, &apos;tablinks4&apos;)">C#</div> </div><div id="CShsnippet4" class="tabcontent4"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> Esprit.Curve ConvertEllipseToCurve(Esprit.IGraphicObject graphicObject)</div>
<div class="line">        {</div>
<div class="line">            Esprit.Curve curve = <span class="keyword">null</span>;</div>
<div class="line">            <span class="keywordflow">if</span> (graphicObject == <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span> curve;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                curve = Document.Curves.AddFromElement(graphicObject);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">            { }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (graphicObject.GraphicObjectType == EspritConstants.espGraphicObjectType.espArc)</div>
<div class="line">            {</div>
<div class="line">                Document.Arcs.Remove(graphicObject.Key);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (graphicObject.GraphicObjectType == EspritConstants.espGraphicObjectType.espCircle)</div>
<div class="line">            {</div>
<div class="line">                Document.Circles.Remove(graphicObject.Key);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> curve;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> ConvertEllipsesToCurves()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (Document.Group.Count == 0)</div>
<div class="line">            {</div>
<div class="line">                var mask = <span class="keyword">new</span> EspritConstants.espGraphicObjectType[2] { EspritConstants.espGraphicObjectType.espArc, EspritConstants.espGraphicObjectType.espCircle };</div>
<div class="line">                Esprit.IGraphicObject graphicObject = <span class="keyword">null</span>;</div>
<div class="line">                <span class="keywordflow">try</span></div>
<div class="line">                {</div>
<div class="line">                    graphicObject = Document.GetAnyElement(<span class="stringliteral">&quot;Pick the Ellipse&quot;</span>, mask);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">                {</div>
<div class="line">                    <span class="comment">// Element was not set</span></div>
<div class="line">                    <span class="keywordflow">return</span>;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (graphicObject == <span class="keyword">null</span>)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">return</span>;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                GraphicObjectHelper.SetDefaultAttributes(ConvertEllipseToCurve(graphicObject) as Esprit.GraphicObject, EspritApplication.Configuration);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">for</span> (var i = Document.Group.Count; i &gt; 0 ; i--)</div>
<div class="line">                {</div>
<div class="line">                    var graphicObject = Document.Group[i] as Esprit.IGraphicObject;</div>
<div class="line">                    <span class="keywordflow">if</span> (graphicObject.GraphicObjectType == EspritConstants.espGraphicObjectType.espArc || graphicObject.GraphicObjectType == EspritConstants.espGraphicObjectType.espCircle)</div>
<div class="line">                    {</div>
<div class="line">                        GraphicObjectHelper.SetDefaultAttributes(ConvertEllipseToCurve(graphicObject) as Esprit.GraphicObject, EspritApplication.Configuration);</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            Document.Refresh();</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>Before running the code, create some ellipses in ESPRIT. If you wanted to automatically convert these curves to segments and arcs, then you could use the CurveApproximation manipulation, which was demonstrated in Tutorial: Feature Chain Curve Approximations.</p>
<p>You can add a helix using the AddHelix method. The AxisPoint1 and AxisPoint2 arguments define the center axis of the helix. The curve then starts at the StartPoint and advances by the Lead value along the center axis with each full revolution.</p>
<p>Suppose that you do not like the values that the Helix Curve command prompts for, or the arguments that the AddHelix method asks for, for that matter. No matter combination of input you have for your helix, a code can be written to accommodate that information.</p>
<p>Say you are never given a start point. Instead you have a radius and the helix always starts at a zero degree angle. Let us suppose that instead of a TaperAngle, you are given the ending radius, and that your helix always takes one revolution for a specified depth. The following code will create just such a helix. Run this code, choose a center point, and enter the other parameters, then examine the helix that results.</p>
<div class="tab"> <div class="tablinks5" onclick="openTab(event, &apos;CShsnippet5&apos;, &apos;tabcontent5&apos;, &apos;tablinks5&apos;)">C#</div> </div><div id="CShsnippet5" class="tabcontent5"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OneRevolutionHelixFromCenterAndDepth()</div>
<div class="line">        {</div>
<div class="line">            Esprit.Point centerPoint = <span class="keyword">null</span>;</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                centerPoint = Document.GetPoint(<span class="stringliteral">&quot;Select Top Center Point&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// Point was not set</span></div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (centerPoint == <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            var depth = 2.0;</div>
<div class="line">            <span class="keywordflow">if</span> (!RequestUserInput(<span class="stringliteral">&quot;Enter Depth&quot;</span>, <span class="stringliteral">&quot;Depth&quot;</span>, ref depth) || depth == 0)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            var startRadius = 1.0;</div>
<div class="line">            <span class="keywordflow">if</span> (!RequestUserInput(<span class="stringliteral">&quot;Enter Starting Radius&quot;</span>, <span class="stringliteral">&quot;Starting Radius&quot;</span>, ref startRadius) || startRadius == 0)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            var endRadius = 10.0;</div>
<div class="line">            <span class="keywordflow">if</span> (!RequestUserInput(<span class="stringliteral">&quot;Enter Ending Radius&quot;</span>, <span class="stringliteral">&quot;Ending Radius&quot;</span>, ref endRadius) || endRadius == 0)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            var point = Document.GetPoint(centerPoint.X, centerPoint.Y, centerPoint.Z - depth);</div>
<div class="line">            var sPoint = Document.GetPoint(centerPoint.X + startRadius, centerPoint.Y, centerPoint.Z);</div>
<div class="line">            var taper = Math.Atan((endRadius - startRadius) / depth);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                GraphicObjectHelper.SetDefaultAttributes(Document.Curves.AddHelix(centerPoint, point, sPoint, depth, taper) as Esprit.GraphicObject, EspritApplication.Configuration);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">            { }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">void</span> SetDefaultAttributes(Esprit.GraphicObject graphicObject, Esprit.Configuration config)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">switch</span> (graphicObject.GraphicObjectType)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espAnnotation:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationNotes.Color;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espArc:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationArcs.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationArcs.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationArcs.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espCircle:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationCircles.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationCircles.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationCircles.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espCurve:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationCurves.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationCurves.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationCurves.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espDimension:</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espHatch:</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espLeader:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationDimensions.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationDimensions.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationDimensions.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espFeatureChain:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationFeatureChains.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationFeatureChains.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationFeatureChains.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espFeaturePtop:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationFeaturePtops.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationFeaturePtops.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationFeaturePtops.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espLine:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationLines.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationLines.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationLines.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espOperation:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationOperations.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationOperations.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationOperations.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espPoint:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationPoints.Color;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationPoints.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espSegment:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationSegments.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationSegments.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationSegments.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espSolidModel:</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espSTL_Model:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationPoints.Color;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>As another example, suppose you are given a segment for the center axis, and you just need to enter the number of revolutions and a constant radius. The following code will determine the necessary lead and make a helix with no taper.</p>
<div class="tab"> <div class="tablinks6" onclick="openTab(event, &apos;CShsnippet6&apos;, &apos;tabcontent6&apos;, &apos;tablinks6&apos;)">C#</div> </div><div id="CShsnippet6" class="tabcontent6"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> ConstantRadiusHelixFromCenterAxisSegment()</div>
<div class="line">        {</div>
<div class="line">            Esprit.Segment segment = <span class="keyword">null</span>;</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                segment = Document.GetSegment(<span class="stringliteral">&quot;Select Center Axis Segment&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// Element was not set</span></div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (segment == <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            var revolutions = 2.0;</div>
<div class="line">            <span class="keywordflow">if</span> (!RequestUserInput(<span class="stringliteral">&quot;Enter Number of Revolutions&quot;</span>, <span class="stringliteral">&quot;Revolutions&quot;</span>, ref revolutions) || revolutions == 0)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            var startRadius = 10.0;</div>
<div class="line">            <span class="keywordflow">if</span> (!RequestUserInput(<span class="stringliteral">&quot;Enter Radius&quot;</span>, <span class="stringliteral">&quot;Radius&quot;</span>, ref startRadius) || startRadius == 0)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            var point1 = segment.Extremity(EspritConstants.espExtremityType.espExtremityStart);</div>
<div class="line">            var point2 = segment.Extremity(EspritConstants.espExtremityType.espExtremityEnd);</div>
<div class="line">            var sPoint = Document.GetPoint(point1.X + startRadius, point1.Y, point1.Z);</div>
<div class="line">            var lead = segment.Length / revolutions;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                GraphicObjectHelper.SetDefaultAttributes(Document.Curves.AddHelix(point1, point2, sPoint, lead, 0) as Esprit.GraphicObject, EspritApplication.Configuration);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">            { }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>Run this code, choose a segment and enter the other parameters. Examine the helix that results. Note that this code, as well as the previous function, creates a start point assuming that the helix is perpendicular to the XY plane. The radius value is only added to the X coordinate of the center point to find the start point, so the radius that results will not be correct for helixes in other planes. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/>
<script type="text/javascript" src="restoreTabs.js"></script>
</body>
</html>
