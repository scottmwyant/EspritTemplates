<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Scan Annotations</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="tutorial.css" rel="stylesheet" type="text/css" />
<link href="tab.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="tab.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Scan Annotations </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This tutorial introduces Annotations collection - an important group of GraphicObject objects related to dimensioning, e.g. Notes, Leader, Hatch and Dimension objects. The example of code simply loops through the Annotations collection and displays certain information about each item.</p>
<p>As with several other collections, the object returned from the Annotations collection is a generic Annotation object. The Annotation object has both an AnnotationType enumerated property and a TypeName string to describe the specific type of object that it is. We can use either AnnotationType or TypeName to cast the Annotation as a specific Notes, Leader, Hatch, or Dimension object.</p>
<div class="tab"> <div class="tablinks" onclick="openTab(event, &apos;CShsnippet&apos;, &apos;tabcontent1&apos;, &apos;tablinks&apos;)">C#</div> </div><div id="CShsnippet" class="tabcontent1"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">void</span> ScanAnnotations()</div>
<div class="line">        {</div>
<div class="line">            EspritApplication.EventWindow.Clear();</div>
<div class="line">            EspritApplication.EventWindow.Visible = <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line">            var index = 0;</div>
<div class="line">            <span class="keywordflow">foreach</span>(Esprit.Annotation annotation in Document.Annotations)</div>
<div class="line">            {</div>
<div class="line">                index++;</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">switch</span> (annotation.AnnotationType)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">case</span> EspritConstants.espAnnotationType.espAnnotationDimension:</div>
<div class="line">                        var annotationDimension = annotation as Esprit.Dimension;</div>
<div class="line">                        EspritApplication.EventWindow.AddMessage(EspritConstants.espMessageType.espMessageTypeInformation, <span class="stringliteral">&quot;ScanAnnotationsTutorial&quot;</span>, $<span class="stringliteral">&quot;Item {index} is Dimension {annotation.Key}&quot;</span>);</div>
<div class="line">                        EspritApplication.EventWindow.AddMessage(EspritConstants.espMessageType.espMessageTypeInformation, <span class="stringliteral">&quot;ScanAnnotationsTutorial&quot;</span>, $<span class="stringliteral">&quot;Dimension {annotationDimension.Key} contains {annotationDimension.AnnotationSegments.Count} segment(s) and {annotationDimension.Notes.Count} note(s).&quot;</span>);</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">                    <span class="keywordflow">case</span> EspritConstants.espAnnotationType.espAnnotationHatch:</div>
<div class="line">                        var annotationHatch = annotation as Esprit.Hatch;</div>
<div class="line">                        EspritApplication.EventWindow.AddMessage(EspritConstants.espMessageType.espMessageTypeInformation, <span class="stringliteral">&quot;ScanAnnotationsTutorial&quot;</span>, $<span class="stringliteral">&quot;Item {index} is Hatch {annotation.Key}&quot;</span>);</div>
<div class="line">                        EspritApplication.EventWindow.AddMessage(EspritConstants.espMessageType.espMessageTypeInformation, <span class="stringliteral">&quot;ScanAnnotationsTutorial&quot;</span>, $<span class="stringliteral">&quot;{Environment.NewLine}Hatch {annotationHatch.Key} contains {annotationHatch.AnnotationSegments.Count} segment(s).&quot;</span>);</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">                    <span class="keywordflow">case</span> EspritConstants.espAnnotationType.espAnnotationLeader:</div>
<div class="line">                        var annotationLeader = annotation as Esprit.Leader;</div>
<div class="line">                        EspritApplication.EventWindow.AddMessage(EspritConstants.espMessageType.espMessageTypeInformation, <span class="stringliteral">&quot;ScanAnnotationsTutorial&quot;</span>, $<span class="stringliteral">&quot;Item {index} is Leader {annotation.Key}&quot;</span>);</div>
<div class="line">                        EspritApplication.EventWindow.AddMessage(EspritConstants.espMessageType.espMessageTypeInformation, <span class="stringliteral">&quot;ScanAnnotationsTutorial&quot;</span>, $<span class="stringliteral">&quot;{Environment.NewLine}Leader {annotationLeader.Key} contains {annotationLeader.LeaderPoints.Count} leader point(s).&quot;</span>);</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">                    <span class="keywordflow">case</span> EspritConstants.espAnnotationType.espAnnotationNote:</div>
<div class="line">                        var annotationNotes = annotation as Esprit.Notes;</div>
<div class="line">                        EspritApplication.EventWindow.AddMessage(EspritConstants.espMessageType.espMessageTypeInformation, <span class="stringliteral">&quot;ScanAnnotationsTutorial&quot;</span>, $<span class="stringliteral">&quot;Item {index} is Note {annotation.Key}&quot;</span>);</div>
<div class="line">                        EspritApplication.EventWindow.AddMessage(EspritConstants.espMessageType.espMessageTypeInformation, <span class="stringliteral">&quot;ScanAnnotationsTutorial&quot;</span>, $<span class="stringliteral">&quot;{Environment.NewLine}Note {annotationNotes.Key} contains {annotationNotes.Count} line(s) of text(s).&quot;</span>);</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (index == 0)</div>
<div class="line">            {</div>
<div class="line">                MessageBox.Show(<span class="stringliteral">&quot;There are no Annotations&quot;</span>, <span class="stringliteral">&quot;ScanAnnotationsTutorial&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>Tutorial outputs information to the EventWindow :</p>
<div class="image">
<img src="ScanAnnotationsEventWindow.png" alt=""/>
</div>
 </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/>
<script type="text/javascript" src="restoreTabs.js"></script>
</body>
</html>
