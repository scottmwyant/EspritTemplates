<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Traditional Milling</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="tutorial.css" rel="stylesheet" type="text/css" />
<link href="tab.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="tab.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Traditional Milling </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This tutorial shows how to import a CAD model, set up the machine and perform operations on the imported solid. Before running the tutorial, load "C:\Program Files\D.P.Technology\ESPRIT TNG\Help\1033\API Tutorial Samples\Data\TraditionalMillig\TraditionalMilling.esprit".</p>
<p>Import a CAD model and align it along the Z axis:</p>
<p><a class="anchor" id="AnchorImportCAD"></a> </p><div class="tab"> <div class="tablinks" onclick="openTab(event, &apos;CShsnippet&apos;, &apos;tabcontent1&apos;, &apos;tablinks&apos;)">C#</div> </div><div id="CShsnippet" class="tabcontent1"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> ImportCAD()</div>
<div class="line">        {</div>
<div class="line">            var projectDirectoryPath = Path.GetDirectoryName(Document.DocumentProperties.Path);</div>
<div class="line"> </div>
<div class="line">            var cadModelFilePath = Path.Combine(projectDirectoryPath, <span class="stringliteral">&quot;SumpPan.x_t&quot;</span>);</div>
<div class="line"> </div>
<div class="line">            Document.MergeFile2(cadModelFilePath, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (Document.Solids.Count != 1)</div>
<div class="line">            {</div>
<div class="line">                System.Windows.MessageBox.Show(<span class="stringliteral">&quot;Import solid error. The document must contain 1 solid.&quot;</span>, <span class="stringliteral">&quot;TraditionalMillingTutorial&quot;</span>, MessageBoxButton.OK);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            Esprit.Solid solid = Document.Solids[1];</div>
<div class="line">            solid.Grouped = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">            Document.PartSetup.BeginEdit();</div>
<div class="line">            var part = Document.Parts[1];</div>
<div class="line">            part.Geometry.Add(Document.Solids[1]);</div>
<div class="line">            Document.PartSetup.EndEdit();</div>
<div class="line"> </div>
<div class="line">            EspritSolids.SolidBody body = solid.SolidBody;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">foreach</span> (EspritSolids.SolidFace face in body.SolidFaces)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (face.Identity == 1)</div>
<div class="line">                {</div>
<div class="line">                    Document.Group.Add(face);</div>
<div class="line">                    Document.AlignAlongAxis(<span class="stringliteral">&quot;Z&quot;</span>);</div>
<div class="line">                    Document.Group.Remove(face);</div>
<div class="line">                    <span class="keywordflow">return</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p><a class="anchor" id="AnchorAddBlockStock"></a> Set up the part and create a stock model as an auto-sized block:</p>
<div class="tab"> <div class="tablinks2" onclick="openTab(event, &apos;CShsnippet2&apos;, &apos;tabcontent2&apos;, &apos;tablinks2&apos;)">C#</div> </div><div id="CShsnippet2" class="tabcontent2"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> Esprit.BlockStock AddBlockStock()</div>
<div class="line">        {</div>
<div class="line">            Document.PartSetup.BeginEdit();</div>
<div class="line"> </div>
<div class="line">            var wp = Document.Workpieces[1];</div>
<div class="line">            var bs = wp.Stocks.AddBlockStock();</div>
<div class="line"> </div>
<div class="line">            var alignment = <span class="keyword">new</span> EspritConstants.STOCKALIGNMENT()</div>
<div class="line">            {</div>
<div class="line">                AlignmentType = EspritConstants.espStockAlignmentType.espStockAlignmentTypeCentered</div>
<div class="line">            };</div>
<div class="line"> </div>
<div class="line">            bs.set_LengthAlignment(alignment);</div>
<div class="line">            bs.set_WidthAlignment(alignment);</div>
<div class="line">            bs.set_HeightAlignment(alignment);</div>
<div class="line"> </div>
<div class="line">            bs.AutoSize();</div>
<div class="line"> </div>
<div class="line">            Document.PartSetup.EndEdit();</div>
<div class="line">            <span class="keywordflow">return</span> bs;</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p><a class="anchor" id="AnchorCreateMachineSetupTM"></a> Set up the machine:</p>
<div class="tab"> <div class="tablinks4" onclick="openTab(event, &apos;CShsnippet4&apos;, &apos;tabcontent4&apos;, &apos;tablinks4&apos;)">C#</div> </div><div id="CShsnippet4" class="tabcontent4"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> CreateMachineSetup()</div>
<div class="line">        {</div>
<div class="line">            Document.InitialMachineSetup.BeginEdit();</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (var i = Document.InitialMachineSetup.MachineItems.Count; i &gt; 0; i--)</div>
<div class="line">            {</div>
<div class="line">                Document.InitialMachineSetup.MachineItems.Remove(i);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                Document.InitialMachineSetup.MachineFileName = EspritApplication.Configuration.GetFileDirectory(EspritConstants.espFileType.espFileTypeMachineSetup) + <span class="stringliteral">&quot;/Samples/Mill/Mill 3-axis/Mini_3x_Mill.mprj&quot;</span>;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">            {</div>
<div class="line">                System.Windows.MessageBox.Show(<span class="stringliteral">&quot;Fail on changing machine setup. To run this tutorial create a new document and try again.&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            var fixtureResourceDirectoryPath = EspritApplication.Configuration.GetFileDirectory(EspritConstants.espFileType.espFileTypeFixtures) + <span class="stringliteral">&quot;/Samples/mill_vice.gdml&quot;</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                var fixture = Document.InitialMachineSetup.MachineItems.AddFixture(fixtureResourceDirectoryPath) as Esprit.IFixture;</div>
<div class="line">                fixture.Name = <span class="stringliteral">&quot;Fixture&quot;</span>;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">            {</div>
<div class="line">                System.Windows.MessageBox.Show(<span class="stringliteral">&quot;Fail on adding fixture.&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            var workpieceItem = Document.InitialMachineSetup.MachineItems[1].MachineItems.AddWorkpieceInstance();</div>
<div class="line">            workpieceItem.Name = <span class="stringliteral">&quot;Workpiece 1&quot;</span>;</div>
<div class="line">            workpieceItem.WorkOffsets[1].WorkOffsetType = EspritConstants.espWorkOffsetType.espWorkOffsetTypeCustom;</div>
<div class="line">            workpieceItem.ZTranslation = 30;</div>
<div class="line">            Document.InitialMachineSetup.EndEdit();</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p><a class="anchor" id="AnchorPocketing"></a> The following code utilizes CreatePocketFeatures2 to recognize features on the solid:</p>
<div class="tab"> <div class="tablinks3" onclick="openTab(event, &apos;CShsnippet3&apos;, &apos;tabcontent3&apos;, &apos;tablinks3&apos;)">C#</div> </div><div id="CShsnippet3" class="tabcontent3"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> Pocketing()</div>
<div class="line">        {</div>
<div class="line">            var solidArray = <span class="keyword">new</span> List&lt;Esprit.IGraphicObject&gt;();</div>
<div class="line"> </div>
<div class="line">            solidArray.Add(Document.Solids[1]);</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                Document.FeatureRecognition.CreatePocketFeatures2(solidArray.ToArray(), Document.ActivePlane, out var comFaults);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">for</span> (var i = 1; i &lt;= comFaults.Count; i++)</div>
<div class="line">                {</div>
<div class="line">                    var msgType = comFaults[i].Severity == EspritComBase.espFaultSeverity.espFaultWarning ? EspritConstants.espMessageType.espMessageTypeWarning : EspritConstants.espMessageType.espMessageTypeError;</div>
<div class="line">                    EspritApplication.EventWindow.AddMessage(msgType, <span class="stringliteral">&quot;TraditionalMillingTutorial&quot;</span>, comFaults[i].Description);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (Exception)</div>
<div class="line">            {</div>
<div class="line">                System.Windows.MessageBox.Show(<span class="stringliteral">&quot;Error on Pocket Features recognition&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p><a class="anchor" id="AnchorPocketOperation"></a> Add milling tool and create Pocketing operation:</p>
<div class="tab"> <div class="tablinks5" onclick="openTab(event, &apos;CShsnippet5&apos;, &apos;tabcontent5&apos;, &apos;tablinks5&apos;)">C#</div> </div><div id="CShsnippet5" class="tabcontent5"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> CreateMill()</div>
<div class="line">        {</div>
<div class="line">            var toolAssemblies = Document.ToolAssemblies;</div>
<div class="line">            var machineSetup = Document.InitialMachineSetup;</div>
<div class="line"> </div>
<div class="line">            var projectDirectoryPath = Path.GetDirectoryName(Document.DocumentProperties.Path);</div>
<div class="line">            var adaptiveItemfilePath = Path.Combine(projectDirectoryPath, <span class="stringliteral">&quot;MillToolHolder_CAT-40.gdml&quot;</span>);</div>
<div class="line"> </div>
<div class="line">            var targetStation = machineSetup.MachineDefinition.Turrets[1].Stations[1];</div>
<div class="line">            var newMillToolAssembly = toolAssemblies.Add(adaptiveItemfilePath, targetStation);</div>
<div class="line">            var mountedAdaptiveItem = newMillToolAssembly.RootAdaptiveItem;</div>
<div class="line"> </div>
<div class="line">            var technologyUtility = Document.TechnologyUtility as EspritTechnology.TechnologyUtility;</div>
<div class="line">            var millTool = technologyUtility.CreateTechnology(EspritConstants.espTechnologyType.espToolMillEndMill, Document.SystemUnit);</div>
<div class="line"> </div>
<div class="line">            SetParameter(millTool, <span class="stringliteral">&quot;ToolID&quot;</span>, <span class="stringliteral">&quot;10mm Endmill&quot;</span>);</div>
<div class="line">            SetParameter(millTool, <span class="stringliteral">&quot;ToolNumber&quot;</span>, 3);</div>
<div class="line">            SetParameter(millTool, <span class="stringliteral">&quot;Coolant&quot;</span>, EspritConstants.espCoolantType.espCoolantOn);</div>
<div class="line">            SetParameter(millTool, <span class="stringliteral">&quot;InitialClearance&quot;</span>, 50);</div>
<div class="line">            SetParameter(millTool, <span class="stringliteral">&quot;LengthCompRegister&quot;</span>, 1);</div>
<div class="line">            SetParameter(millTool, <span class="stringliteral">&quot;ToolLength&quot;</span>, 80);</div>
<div class="line">            SetParameter(millTool, <span class="stringliteral">&quot;OverallLength&quot;</span>, 80);</div>
<div class="line">            SetParameter(millTool, <span class="stringliteral">&quot;ExtensionDiameter&quot;</span>, 35);</div>
<div class="line">            SetParameter(millTool, <span class="stringliteral">&quot;ShankDiameter&quot;</span>, 10);</div>
<div class="line">            SetParameter(millTool, <span class="stringliteral">&quot;CuttingLength&quot;</span>, 30);</div>
<div class="line">            SetParameter(millTool, <span class="stringliteral">&quot;ToolDiameter&quot;</span>, 10);</div>
<div class="line"> </div>
<div class="line">            mountedAdaptiveItem.ToolAdapters[1].MountTool(millTool);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> SetParameter&lt;T&gt;(EspritTechnology.ITechnology tool, <span class="keywordtype">string</span> name, T value)</div>
<div class="line">        {</div>
<div class="line">            var parameter = tool.FindParameter(name);</div>
<div class="line">            <span class="keywordflow">if</span> (parameter != <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                parameter.Value = value;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> CreatePocketingOperation()</div>
<div class="line">        {</div>
<div class="line">            EspritTechnology.TechMillPocket2 millPocketOperation = <span class="keyword">new</span> EspritTechnology.TechMillPocket2();</div>
<div class="line"> </div>
<div class="line">            millPocketOperation.OperationName = <span class="stringliteral">&quot;Pocketing&quot;</span>;</div>
<div class="line">            millPocketOperation.ToolID = <span class="stringliteral">&quot;10mm Endmill&quot;</span>;</div>
<div class="line">            millPocketOperation.FeedUnit = EspritConstants.espFeedUnit.espFeedPerMinute;</div>
<div class="line">            millPocketOperation.CalculateStock = <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line">            millPocketOperation.ToolMotionPattern = EspritConstants.espMillPocketPattern.espMillPocketPatternProfitMilling;</div>
<div class="line">            millPocketOperation.TrochoidTransitionFeedPercent = 500;</div>
<div class="line">            millPocketOperation.MinimumTrochoidRadius = 40;</div>
<div class="line">            millPocketOperation.MaxTrochoidWidthRatio = 400;</div>
<div class="line">            millPocketOperation.MinimumCornerRadius = 4;</div>
<div class="line">            millPocketOperation.TotalDepth = 25;</div>
<div class="line">            millPocketOperation.IncrementalDepth = 25;</div>
<div class="line"> </div>
<div class="line">            millPocketOperation.RetractForIdepth = EspritConstants.espRetractMode.espRetractClearanceAboveSurface;</div>
<div class="line">            millPocketOperation.IncrDepthCalculation = EspritConstants.espPocketIncrDepthCalculation.espPocketIncrDepthCalculationVarying;</div>
<div class="line"> </div>
<div class="line">            millPocketOperation.ProfitMillingIncrementalDepth = 10;</div>
<div class="line">            millPocketOperation.ProfitMillingSpindleSpeedRPM = 5000;</div>
<div class="line">            millPocketOperation.ProfitMillingXYFeedratePM = 500;</div>
<div class="line">            millPocketOperation.StayInsideFeature = <span class="keyword">true</span>;</div>
<div class="line">            millPocketOperation.OutputRoughPasses = <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line">            millPocketOperation.XYFeedratePM = 500;</div>
<div class="line">            millPocketOperation.ZFeedratePM = 500;</div>
<div class="line">            millPocketOperation.SpindleSpeedRPM = 5000;</div>
<div class="line">            millPocketOperation.MaximumFeedratePM = 25000;</div>
<div class="line"> </div>
<div class="line">            millPocketOperation.StepPercentOfDiameter = 50;</div>
<div class="line">            millPocketOperation.StepOver = 5;</div>
<div class="line"> </div>
<div class="line">            millPocketOperation.RapidPartialDepth = <span class="keyword">true</span>;</div>
<div class="line">            millPocketOperation.OpenEdgeOffset = 5.5;</div>
<div class="line"> </div>
<div class="line">            millPocketOperation.OpenPocketLeadIn = 5;</div>
<div class="line">            millPocketOperation.OpenPocketLeadOut = 5;</div>
<div class="line">            millPocketOperation.ReadTaperFromFeature = <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line">            millPocketOperation.EngagementAngle = 90;</div>
<div class="line">            millPocketOperation.EntryMode = EspritConstants.espMillPocketEntryMode.espMillPocketEntryModeRampAlongPass;</div>
<div class="line">            millPocketOperation.MinimumEntryWidth = 2.5;</div>
<div class="line">            millPocketOperation.MaximumEntryWidth = 20;</div>
<div class="line">            millPocketOperation.RampAngle = 10;</div>
<div class="line">            millPocketOperation.EdgeClearance = 1;</div>
<div class="line">            millPocketOperation.EntryFailure = EspritConstants.espMillPocketEntryFailure.espMillPocketEntryFailureSkip;</div>
<div class="line">            millPocketOperation.ExitMode = EspritConstants.espMillPocketExitMode.espMillPocketExitModeRamp;</div>
<div class="line">            millPocketOperation.RetractDistance = 2;</div>
<div class="line">            millPocketOperation.Clearance = 2;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">foreach</span> (Esprit.FeatureSet <span class="keyword">set</span> in Document.FeatureSets)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (<span class="keyword">set</span>.Name == <span class="stringliteral">&quot;3 Pocket&quot;</span>)</div>
<div class="line">                {</div>
<div class="line">                    Document.Group.Add(<span class="keyword">set</span>);</div>
<div class="line">                    Document.PartOperations.Add(millPocketOperation, <span class="keyword">set</span>);</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p><a class="anchor" id="AnchorFacing"></a> Add a face mill tool and create Facing operation. Reoder operations in order to set facing operation before the pocketing:</p>
<div class="tab"> <div class="tablinks6" onclick="openTab(event, &apos;CShsnippet6&apos;, &apos;tabcontent6&apos;, &apos;tablinks6&apos;)">C#</div> </div><div id="CShsnippet6" class="tabcontent6"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> AddFaceMill()</div>
<div class="line">        {</div>
<div class="line">            var projectDirectoryPath = Path.GetDirectoryName(Document.DocumentProperties.Path);</div>
<div class="line">            var adaptiveItemfilePath = Path.Combine(projectDirectoryPath, <span class="stringliteral">&quot;MillToolHolder_CAT-40.gdml&quot;</span>);</div>
<div class="line"> </div>
<div class="line">            var toolAssemblies = Document.ToolAssemblies;</div>
<div class="line">            var machineSetup = Document.InitialMachineSetup;</div>
<div class="line">            var targetStation = machineSetup.MachineDefinition.Turrets[1].Stations[1];</div>
<div class="line">            var newMillToolAssembly = toolAssemblies.Add(adaptiveItemfilePath, targetStation);</div>
<div class="line"> </div>
<div class="line">            var mountedAdaptiveItem = newMillToolAssembly.RootAdaptiveItem;</div>
<div class="line"> </div>
<div class="line">            var technologyUtility = Document.TechnologyUtility as EspritTechnology.TechnologyUtility;</div>
<div class="line">            var faceMillTool = technologyUtility.CreateTechnology(EspritConstants.espTechnologyType.espToolMillFaceMill, Document.SystemUnit);</div>
<div class="line"> </div>
<div class="line">            SetParameter(faceMillTool, <span class="stringliteral">&quot;ToolID&quot;</span>, <span class="stringliteral">&quot;Facemill&quot;</span>);</div>
<div class="line">            SetParameter(faceMillTool, <span class="stringliteral">&quot;SpindleDirection&quot;</span>, EspritConstants.espSpindleDirection.espSpindleCW);</div>
<div class="line">            SetParameter(faceMillTool, <span class="stringliteral">&quot;InitialClearance&quot;</span>, 50);</div>
<div class="line">            SetParameter(faceMillTool, <span class="stringliteral">&quot;Coolant&quot;</span>, EspritConstants.espCoolantType.espCoolantOn);</div>
<div class="line">            SetParameter(faceMillTool, <span class="stringliteral">&quot;ExtensionImageDiameter&quot;</span>, 35);</div>
<div class="line">            SetParameter(faceMillTool, <span class="stringliteral">&quot;OverallLength&quot;</span>, 80);</div>
<div class="line">            SetParameter(faceMillTool, <span class="stringliteral">&quot;ToolLength&quot;</span>, 80);</div>
<div class="line">            SetParameter(faceMillTool, <span class="stringliteral">&quot;ShankType&quot;</span>, EspritConstants.espToolMillFaceShankType.espToolMillFaceShankReverseConical);</div>
<div class="line">            SetParameter(faceMillTool, <span class="stringliteral">&quot;ShankDiameter&quot;</span>, 73);</div>
<div class="line">            SetParameter(faceMillTool, <span class="stringliteral">&quot;CuttingLength&quot;</span>, 10);</div>
<div class="line">            SetParameter(faceMillTool, <span class="stringliteral">&quot;ShankTopDiameter&quot;</span>, 30);</div>
<div class="line">            SetParameter(faceMillTool, <span class="stringliteral">&quot;ShankBottomLength&quot;</span>, 20);</div>
<div class="line">            SetParameter(faceMillTool, <span class="stringliteral">&quot;ShankAngle&quot;</span>, 75);</div>
<div class="line">            SetParameter(faceMillTool, <span class="stringliteral">&quot;ToolDiameter&quot;</span>, 75);</div>
<div class="line">            SetParameter(faceMillTool, <span class="stringliteral">&quot;BottomClearance&quot;</span>, 1);</div>
<div class="line">            SetParameter(faceMillTool, <span class="stringliteral">&quot;InsertType&quot;</span>, EspritConstants.espToolMillInsertType.espToolMillInsertSquare);</div>
<div class="line">            SetParameter(faceMillTool, <span class="stringliteral">&quot;CornerRadius&quot;</span>, 0.5);</div>
<div class="line">            SetParameter(faceMillTool, <span class="stringliteral">&quot;ICDiameter&quot;</span>, 10);</div>
<div class="line">            SetParameter(faceMillTool, <span class="stringliteral">&quot;OrientationAngle&quot;</span>, 0);</div>
<div class="line">            SetParameter(faceMillTool, <span class="stringliteral">&quot;NumberOfInserts&quot;</span>, 6);</div>
<div class="line"> </div>
<div class="line">            mountedAdaptiveItem.ToolAdapters[mountedAdaptiveItem.ToolAdapters.Count].MountTool(faceMillTool);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> AddFacingOperation()</div>
<div class="line">        {</div>
<div class="line">            Document.Group.Clear();</div>
<div class="line"> </div>
<div class="line">            EspritTechnology.TechMillFace millFaceOperation = <span class="keyword">new</span> EspritTechnology.TechMillFace();</div>
<div class="line"> </div>
<div class="line">            millFaceOperation.OperationName = <span class="stringliteral">&quot;Facing&quot;</span>;</div>
<div class="line">            millFaceOperation.ToolID = <span class="stringliteral">&quot;Facemill&quot;</span>;</div>
<div class="line">            millFaceOperation.XYFeedratePM = 2000;</div>
<div class="line">            millFaceOperation.ZFeedratePM = 2000;</div>
<div class="line">            millFaceOperation.SpindleSpeedRPM = 10000;</div>
<div class="line">            millFaceOperation.FeedUnit = EspritConstants.espFeedUnit.espFeedPerMinute;</div>
<div class="line">            millFaceOperation.CalculateStock = <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line">            millFaceOperation.OptimalCuttingAngle = <span class="keyword">true</span>;</div>
<div class="line">            millFaceOperation.StepOver = 37.5;</div>
<div class="line">            millFaceOperation.StepPercentOfDiameter = 50;</div>
<div class="line">            millFaceOperation.OverhangDirection = EspritConstants.espMillFaceOverhangDirection.espMillFaceOverhangDirectionOneWay;</div>
<div class="line">            millFaceOperation.Overhang = 37.5;</div>
<div class="line">            millFaceOperation.PercentOfToolOverhang = 50;</div>
<div class="line">            millFaceOperation.IncrDepthCalculation = EspritConstants.espFaceIncrDepthCalculation.espFaceIncrDepthCalculationVarying;</div>
<div class="line"> </div>
<div class="line">            millFaceOperation.Clearance = 2;</div>
<div class="line">            millFaceOperation.EntryMode = EspritConstants.espMillFaceEntryMode.espMillFaceEntryDownThenOver;</div>
<div class="line">            millFaceOperation.LeadInDistance = 39.5;</div>
<div class="line">            millFaceOperation.ExitMode = EspritConstants.espMillFaceExitMode.espMillFaceExitOverThenUp;</div>
<div class="line">            millFaceOperation.LeadOutDistance = 39.5;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">foreach</span> (Esprit.FeatureChain chain in Document.FeatureChains)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (chain.Name == <span class="stringliteral">&quot;1 Boundary&quot;</span>)</div>
<div class="line">                {</div>
<div class="line">                    Document.Group.Add(chain);</div>
<div class="line">                    </div>
<div class="line">                    Document.PartOperations.Add(millFaceOperation, chain);</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            var operations = <span class="keyword">new</span> List&lt;Esprit.PartOperation&gt;();</div>
<div class="line">            operations.Add(Document.PartOperations[2]);</div>
<div class="line">            Document.PartOperations.Reorder(operations.ToArray(), 1, <span class="keyword">true</span>);</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p><a class="anchor" id="AnchorDrilling"></a> The following code utilizes CreateHoleFeatures2 to create holes and sets up all drilling operations:</p>
<div class="tab"> <div class="tablinks7" onclick="openTab(event, &apos;CShsnippet7&apos;, &apos;tabcontent7&apos;, &apos;tablinks7&apos;)">C#</div> </div><div id="CShsnippet7" class="tabcontent7"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> AddDrillingTools()</div>
<div class="line">        {</div>
<div class="line">            var toolAssemblies = Document.ToolAssemblies;</div>
<div class="line">            var projectDirectoryPath = Path.GetDirectoryName(Document.DocumentProperties.Path);</div>
<div class="line">            var drillingToolsFilePath = Path.Combine(projectDirectoryPath, <span class="stringliteral">&quot;DrillingTools.gdml&quot;</span>);</div>
<div class="line">            toolAssemblies.Import(drillingToolsFilePath);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> RecognizeHoles()</div>
<div class="line">        {</div>
<div class="line">            var solidArray = <span class="keyword">new</span> List&lt;Esprit.IGraphicObject&gt;();</div>
<div class="line"> </div>
<div class="line">            solidArray.Add(Document.Solids[1]);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                var conf = EspritApplication.Configuration.ConfigurationHoleRecognition2;</div>
<div class="line">                conf.MaxDiameterInch = 20.49579;</div>
<div class="line">                conf.MaxDiameterMetric = 20.49579;</div>
<div class="line">                conf.MinDiameterInch = 0;</div>
<div class="line">                conf.MinDiameterMetric = 0;</div>
<div class="line">                conf.MinimumHoleOpeningInch = 180;</div>
<div class="line">                conf.MinimumHoleOpeningMetric = 180;</div>
<div class="line"> </div>
<div class="line">                conf.CombineCoaxialHoles = <span class="keyword">true</span>;</div>
<div class="line">                conf.PropagateHoleFace = <span class="keyword">true</span>;</div>
<div class="line">                conf.ActiveWorkplaneOnly = <span class="keyword">false</span>;</div>
<div class="line">                conf.SplitCustomHole = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">                conf.GroupByCadFeature = <span class="keyword">false</span>;</div>
<div class="line">                conf.GroupBySameHoleType = <span class="keyword">true</span>;</div>
<div class="line">                conf.GroupBySameDiameters = <span class="keyword">true</span>;</div>
<div class="line">                conf.GroupBySameDepths = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">                conf.GroupBySameDirection = <span class="keyword">false</span>;</div>
<div class="line">                conf.GroupBySameAltitude = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">                Document.FeatureRecognition.CreateHoleFeatures2(solidArray.ToArray(), out var comFaults);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">for</span> (var i = 1; i &lt;= comFaults.Count; i++)</div>
<div class="line">                {</div>
<div class="line">                    var msgType = comFaults[i].Severity == EspritComBase.espFaultSeverity.espFaultWarning ? EspritConstants.espMessageType.espMessageTypeWarning : EspritConstants.espMessageType.espMessageTypeError;</div>
<div class="line">                    EspritApplication.EventWindow.AddMessage(msgType, <span class="stringliteral">&quot;TraditionalMillingTutorial&quot;</span>, comFaults[i].Description);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (Exception)</div>
<div class="line">            {</div>
<div class="line">                System.Windows.MessageBox.Show(<span class="stringliteral">&quot;Error on Hole Features recognition&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> AddDrillingOperations()</div>
<div class="line">        {</div>
<div class="line">            EspritTechnology.TechMillHoleMachining centerDrillingOperation = <span class="keyword">new</span> EspritTechnology.TechMillHoleMachining();</div>
<div class="line"> </div>
<div class="line">            centerDrillingOperation.OperationName = <span class="stringliteral">&quot;Pilot Drilling&quot;</span>;</div>
<div class="line">            centerDrillingOperation.ToolID = <span class="stringliteral">&quot;Center Drill&quot;</span>;</div>
<div class="line">            centerDrillingOperation.SpindleSpeedRPM = 5000;</div>
<div class="line">            centerDrillingOperation.ZFeedratePM = 500;</div>
<div class="line">            centerDrillingOperation.CalculateStock = <span class="keyword">true</span>;</div>
<div class="line">            centerDrillingOperation.MachiningStrategy = EspritConstants.espCenterHoleMachiningStrategy.espCenterHoleMachiningStrategyToolSpinning;</div>
<div class="line">            centerDrillingOperation.TotalDepth = 2;</div>
<div class="line">            centerDrillingOperation.DepthFromFeature = <span class="keyword">false</span>;</div>
<div class="line">            centerDrillingOperation.DwellTime = 1;</div>
<div class="line">            centerDrillingOperation.Clearance = 2;</div>
<div class="line">            centerDrillingOperation.CycleType = EspritConstants.espHoleCycleType.espHoleCycleTypeSpotDrilling;</div>
<div class="line"> </div>
<div class="line">            Document.Group.Clear();</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">foreach</span> (Esprit.HolesFeature hole in Document.HolesFeatures)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> ((hole.Diameter == 8 &amp;&amp; hole.Name == <span class="stringliteral">&quot;1 Simple Hole Ø8. ↧17.7&quot;</span>) || hole.Name == <span class="stringliteral">&quot;4 Countersink Ø6.6 ↧25.4&quot;</span> || hole.Name == <span class="stringliteral">&quot;3 Simple Hole Ø20.49579 ↧10.&quot;</span>)</div>
<div class="line">                {</div>
<div class="line">                    Document.Group.Add(hole);</div>
<div class="line">                    Document.PartOperations.Add(centerDrillingOperation, hole);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            EspritTechnology.TechMillHoleMachining drill8mmOperation = <span class="keyword">new</span> EspritTechnology.TechMillHoleMachining();</div>
<div class="line"> </div>
<div class="line">            drill8mmOperation.OperationName = <span class="stringliteral">&quot;Drilling&quot;</span>;</div>
<div class="line">            drill8mmOperation.ToolID = <span class="stringliteral">&quot;8mm Drill&quot;</span>;</div>
<div class="line">            drill8mmOperation.SpindleSpeedRPM = 5000;</div>
<div class="line">            drill8mmOperation.ZFeedratePM = 500;</div>
<div class="line">            drill8mmOperation.CalculateStock = <span class="keyword">true</span>;</div>
<div class="line">            drill8mmOperation.MachiningStrategy = EspritConstants.espCenterHoleMachiningStrategy.espCenterHoleMachiningStrategyToolSpinning;</div>
<div class="line">            drill8mmOperation.DepthFromFeature = <span class="keyword">true</span>;</div>
<div class="line">            drill8mmOperation.DwellTime = 1;</div>
<div class="line">            drill8mmOperation.Clearance = 2;</div>
<div class="line">            drill8mmOperation.CycleType = EspritConstants.espHoleCycleType.espHoleCycleTypeDrillingWithChipRemoval;</div>
<div class="line">            drill8mmOperation.PeckingMode = EspritConstants.espHolePeckingMode.espHolePeckingModeConstant;</div>
<div class="line">            drill8mmOperation.PeckIncrement = 10;</div>
<div class="line">            drill8mmOperation.PeckClearance = 1;</div>
<div class="line"> </div>
<div class="line">            Document.Group.Clear();</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">foreach</span> (Esprit.HolesFeature hole in Document.HolesFeatures)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> ((hole.Diameter == 8 &amp;&amp; hole.Name == <span class="stringliteral">&quot;1 Simple Hole Ø8. ↧17.7&quot;</span>) || hole.Name == <span class="stringliteral">&quot;4 Countersink Ø6.6 ↧25.4&quot;</span> )</div>
<div class="line">                {</div>
<div class="line">                    Document.Group.Add(hole);</div>
<div class="line">                    Document.PartOperations.Add(drill8mmOperation, hole);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            EspritTechnology.TechMillHoleMachining chamferMillOperation = <span class="keyword">new</span> EspritTechnology.TechMillHoleMachining();</div>
<div class="line"> </div>
<div class="line">            chamferMillOperation.OperationName = <span class="stringliteral">&quot;Countersink&quot;</span>;</div>
<div class="line">            chamferMillOperation.ToolID = <span class="stringliteral">&quot;Chamfer Mill&quot;</span>;</div>
<div class="line">            chamferMillOperation.SpindleSpeedRPM = 5000;</div>
<div class="line">            chamferMillOperation.ZFeedratePM = 500;</div>
<div class="line">            chamferMillOperation.CalculateStock = <span class="keyword">true</span>;</div>
<div class="line">            chamferMillOperation.MachiningStrategy = EspritConstants.espCenterHoleMachiningStrategy.espCenterHoleMachiningStrategyToolSpinning;</div>
<div class="line">            chamferMillOperation.DepthFromFeature = <span class="keyword">true</span>;</div>
<div class="line">            chamferMillOperation.DwellTime = 1;</div>
<div class="line">            chamferMillOperation.Clearance = 2;</div>
<div class="line">            chamferMillOperation.CycleType = EspritConstants.espHoleCycleType.espHoleCycleTypeSpotDrilling;</div>
<div class="line"> </div>
<div class="line">            Document.Group.Clear();</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">foreach</span> (Esprit.HolesFeature hole in Document.HolesFeatures)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (hole.Name == <span class="stringliteral">&quot;4 Countersink Ø6.6 ↧25.4&quot;</span>)</div>
<div class="line">                {</div>
<div class="line">                    Document.Group.Add(hole);</div>
<div class="line">                    Document.PartOperations.Add(chamferMillOperation, hole);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            EspritTechnology.TechMillHoleMachining drill20mmOperation = <span class="keyword">new</span> EspritTechnology.TechMillHoleMachining();</div>
<div class="line"> </div>
<div class="line">            drill20mmOperation.OperationName = <span class="stringliteral">&quot;Large Hole Drilling&quot;</span>;</div>
<div class="line">            drill20mmOperation.ToolID = <span class="stringliteral">&quot;20mm Drill&quot;</span>;</div>
<div class="line">            drill20mmOperation.SpindleSpeedRPM = 1500;</div>
<div class="line">            drill20mmOperation.ZFeedratePM = 200;</div>
<div class="line">            drill20mmOperation.CalculateStock = <span class="keyword">true</span>;</div>
<div class="line">            drill20mmOperation.MachiningStrategy = EspritConstants.espCenterHoleMachiningStrategy.espCenterHoleMachiningStrategyToolSpinning;</div>
<div class="line">            drill20mmOperation.DepthFromFeature = <span class="keyword">true</span>;</div>
<div class="line">            drill20mmOperation.ThroughDepth = 2;</div>
<div class="line">            drill20mmOperation.DwellTime = 1;</div>
<div class="line">            drill20mmOperation.Clearance = 2;</div>
<div class="line">            drill20mmOperation.CycleType = EspritConstants.espHoleCycleType.espHoleCycleTypeDrillingWithChipBreaking;</div>
<div class="line">            drill20mmOperation.ReturnPlane = EspritConstants.espHoleReturnPlane.espHoleReturnPlaneFullClearance;</div>
<div class="line">            Document.Group.Clear();</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">foreach</span> (Esprit.HolesFeature hole in Document.HolesFeatures)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (hole.Name == <span class="stringliteral">&quot;3 Simple Hole Ø20.49579 ↧10.&quot;</span>)</div>
<div class="line">                {</div>
<div class="line">                    Document.Group.Add(hole);</div>
<div class="line">                    Document.PartOperations.Add(drill20mmOperation, hole);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p><a class="anchor" id="AnchorSimulation"></a> After all set up is done, start the simulation:</p>
<div class="tab"> <div class="tablinks8" onclick="openTab(event, &apos;CShsnippet8&apos;, &apos;tabcontent8&apos;, &apos;tablinks8&apos;)">C#</div> </div><div id="CShsnippet8" class="tabcontent8"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> StartSimulation()</div>
<div class="line">        {</div>
<div class="line">            Document.Simulation.SetCollisions(<span class="keyword">true</span>);</div>
<div class="line">            Document.Simulation.Play();</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>You can use the Masks on the Heads-Up Toolbar in Machine View to hide the machine components. Make sure that Part Violation Detection is unchecked during the simulation.</p>
<p>When simulation is over, push "Stop". To analyze the toolpath, switch to Part View and select the pocketing operation and click Toolpath (Analysis tab). If you want to see the operations tool assembly, check "Show Tool" and "Show Holder". </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/>
<script type="text/javascript" src="restoreTabs.js"></script>
</body>
</html>
