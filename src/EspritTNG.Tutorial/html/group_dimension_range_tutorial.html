<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Group Dimension Range</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="tutorial.css" rel="stylesheet" type="text/css" />
<link href="tab.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="tab.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Group Dimension Range </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>We saw in the Tutorial: Scan Dimension and Notes Text how to find the text string of a dimension. Knowing that, we can take the value of that string and find which dimensions fall within a certain range. This may be useful, for example, to eventually locate geometry or features that will have common machining applied to them.</p>
<p>If circle and arc dimensions have a diameter symbol or R in front of them, that symbol is the first note, and the value follows in the next note. This code example checks for such characters in the first note and then looks for the value in the following notes.</p>
<div class="tab"> <div class="tablinks" onclick="openTab(event, &apos;CShsnippet&apos;, &apos;tabcontent1&apos;, &apos;tablinks&apos;)">C#</div> </div><div id="CShsnippet" class="tabcontent1"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">void</span> GroupDimensionRange()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (Document.Annotations.Count == 0)</div>
<div class="line">            {</div>
<div class="line">                MessageBox.Show(<span class="stringliteral">&quot;There are no Annotations&quot;</span>, <span class="stringliteral">&quot;GroupDimensionRangeTutorial&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            var lowerLimit = 0.0;</div>
<div class="line">            <span class="keywordflow">if</span> (!RequestUserInput(<span class="stringliteral">&quot;Enter Lower Dimension Limit for Group&quot;</span>, <span class="stringliteral">&quot;Lower Limit&quot;</span>, ref lowerLimit))</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line">            var upperLimit = lowerLimit;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (!RequestUserInput(<span class="stringliteral">&quot;Enter Upper Dimension Limit for Group&quot;</span>, <span class="stringliteral">&quot;Upper Limit&quot;</span>, ref upperLimit))</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            var count = 0;</div>
<div class="line">            <span class="keywordflow">foreach</span>(Esprit.Annotation annotation in Document.Annotations)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (annotation.AnnotationType != EspritConstants.espAnnotationType.espAnnotationDimension)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">continue</span>;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                count++;</div>
<div class="line"> </div>
<div class="line">                var annotationDimension = annotation as Esprit.Dimension;</div>
<div class="line">                var firstLeterCode = Encoding.ASCII.GetBytes(annotationDimension.Notes.Item[1].String).First();</div>
<div class="line">                <span class="keywordtype">int</span> valueNote = ((firstLeterCode == 82) || (firstLeterCode == 216))</div>
<div class="line">                    ? 2</div>
<div class="line">                    : 1;</div>
<div class="line"> </div>
<div class="line">                var currentValue = 0.0;</div>
<div class="line">                <span class="keywordflow">if</span> (annotationDimension.Notes.Count == 1 + valueNote)</div>
<div class="line">                {</div>
<div class="line">                    var firstLeterOfSecondLineCode = Encoding.ASCII.GetBytes(annotationDimension.Notes.Item[2].String).First();</div>
<div class="line">                    <span class="keywordflow">if</span> (firstLeterOfSecondLineCode == 177)</div>
<div class="line">                    {</div>
<div class="line">                        <span class="keywordtype">double</span>.TryParse(annotationDimension.Notes.Item[valueNote].String, out currentValue);</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">else</span></div>
<div class="line">                    {</div>
<div class="line">                        <span class="keywordtype">double</span>.TryParse(annotationDimension.Notes.Item[valueNote].String, out var value1);</div>
<div class="line">                        <span class="keywordtype">double</span>.TryParse(annotationDimension.Notes.Item[valueNote + 1].String, out var value2);</div>
<div class="line">                        currentValue = (value1 + value2) / 2.0;</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordtype">double</span>.TryParse(annotationDimension.Notes.Item[valueNote].String, out currentValue);</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> ((lowerLimit &lt;= currentValue) &amp;&amp; (currentValue &lt;= upperLimit))</div>
<div class="line">                {</div>
<div class="line">                    annotationDimension.Grouped = <span class="keyword">true</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (count == 0)</div>
<div class="line">            {</div>
<div class="line">                System.Windows.MessageBox.Show(<span class="stringliteral">&quot;There are no Dimension Annotations&quot;</span>, <span class="stringliteral">&quot;GroupDimensionRangeTutorial&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                Document.Refresh();</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/>
<script type="text/javascript" src="restoreTabs.js"></script>
</body>
</html>
