<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: A Closer Look at the Parameter Object</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="tutorial.css" rel="stylesheet" type="text/css" />
<link href="tab.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="tab.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">A Closer Look at the Parameter Object </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Every Technology object is made up of a set of parameters. The Count property of the Technology contains the number of parameters in that Technology, and Item can be used to look at individual parameters. The CreateTechnology method of the TechnologyUtility can be used to create any technology by passing the appropriate parameters. The first parameter gives the TechType as the enumeration espTechnologyType. Well, an enumeration just gives names to integer values. This means we should be able to set up a loop to go through all of the TechType values and create every technology!</p>
<p>The Parameter object contains not only the Value of that parameter, but many other useful properties such as the property Name used in the API, the Caption that is shown on the interface, and the CLCode that corresponds to that setting in the Post Processor. One application, then, of looping through all of the technologies would be to get a list of property names and CL codes that could be used as a reference when writing macros or post processors. We will output the lists as .csv files.</p>
<ul>
<li>Export all Technology parameters:</li>
</ul>
<div class="tab"> <div class="tablinks" onclick="openTab(event, &apos;CShsnippet&apos;, &apos;tabcontent1&apos;, &apos;tablinks&apos;)">C#</div> </div><div id="CShsnippet" class="tabcontent1"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> FindAllCLCodes()</div>
<div class="line">        {</div>
<div class="line">            var filePath = Path.Combine(EspritApplication.TempDir, Guid.NewGuid().ToString() + <span class="stringliteral">&quot;.csv&quot;</span>);</div>
<div class="line">            <span class="keyword">using</span> (var outStream = <span class="keyword">new</span> StreamWriter(filePath))</div>
<div class="line">            {</div>
<div class="line">                outStream.WriteLine(<span class="stringliteral">&quot;Tech Type&quot;</span> + <span class="stringliteral">&quot;,&quot;</span> + <span class="stringliteral">&quot;Technology Object Name&quot;</span> + <span class="stringliteral">&quot;,&quot;</span> + <span class="stringliteral">&quot;CL Code&quot;</span> + <span class="stringliteral">&quot;,&quot;</span> + <span class="stringliteral">&quot;Property Name&quot;</span> + <span class="stringliteral">&quot;,&quot;</span> + <span class="stringliteral">&quot;Caption&quot;</span> + <span class="stringliteral">&quot;,&quot;</span> + <span class="stringliteral">&quot;Default Value&quot;</span>);</div>
<div class="line">                var technologyUtility = Document.TechnologyUtility as EspritTechnology.TechnologyUtility;</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">foreach</span> (espTechnologyType technologyType <span class="keywordflow">in</span> Enum.GetValues(typeof(espTechnologyType)))</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">try</span></div>
<div class="line">                    {</div>
<div class="line">                        var technology = technologyUtility.CreateTechnology(technologyType, Document.SystemUnit);</div>
<div class="line">                        <span class="keywordflow">if</span> (technology != <span class="keyword">null</span>)</div>
<div class="line">                        {</div>
<div class="line">                            var techName = Microsoft.VisualBasic.Information.TypeName(technology);</div>
<div class="line">                            <span class="keywordflow">for</span> (var j = 1; j &lt;= technology.Count; j++)</div>
<div class="line">                            {</div>
<div class="line">                                var param = technology[j];</div>
<div class="line">                                outStream.WriteLine($<span class="stringliteral">&quot;{technologyType},{techName},{param.ClCode},{param.Name},{param.Caption},{param.Value}&quot;</span>);</div>
<div class="line">                            }</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">catch</span>(Exception)</div>
<div class="line">                    { }</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                EspritApplication.EventWindow.AddMessage(espMessageType.espMessageTypeInformation, <span class="stringliteral">&quot;ParameterObjectTutorial&quot;</span>, $<span class="stringliteral">&quot;File with All CLCodes created: {filePath}&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>The function TypeName returns those names with the "I" prefix, which stands for interface. The actual names of those objects are, of course, TechMillDrillInsert and TechMillInsert. The above is not the friendliest format. Suppose we want to condense this to just list each CL Code. We could then make an array to store all of the Technology objects to which that CL Code applies.</p>
<ul>
<li>Export all Technology unique parameters:</li>
</ul>
<div class="tab"> <div class="tablinks2" onclick="openTab(event, &apos;CShsnippet2&apos;, &apos;tabcontent2&apos;, &apos;tablinks2&apos;)">C#</div> </div><div id="CShsnippet2" class="tabcontent2"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> FindAllUniqueCLCodes()</div>
<div class="line">        {</div>
<div class="line">            var technologyUtility = Document.TechnologyUtility as EspritTechnology.TechnologyUtility;</div>
<div class="line">            var infos = <span class="keyword">new</span> Dictionary&lt;int, ClInfo&gt;();</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">foreach</span> (espTechnologyType technologyType <span class="keywordflow">in</span> Enum.GetValues(typeof(espTechnologyType)))</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">try</span></div>
<div class="line">                {</div>
<div class="line">                    var technology = technologyUtility.CreateTechnology(technologyType, Document.SystemUnit);</div>
<div class="line">                    <span class="keywordflow">if</span> (technology != <span class="keyword">null</span>)</div>
<div class="line">                    {</div>
<div class="line">                        var techName = Microsoft.VisualBasic.Information.TypeName(technology);</div>
<div class="line">                        <span class="keywordflow">for</span> (var j = 1; j &lt;= technology.Count; j++)</div>
<div class="line">                        {</div>
<div class="line">                            var param = technology[j];</div>
<div class="line">                            <span class="keywordflow">if</span> (infos.Keys.Contains(param.ClCode))</div>
<div class="line">                            {</div>
<div class="line">                                var tmp = infos[param.ClCode];</div>
<div class="line">                                tmp.TechName = $<span class="stringliteral">&quot;{infos[param.ClCode].TechName }, {techName}&quot;</span>;</div>
<div class="line">                                infos[param.ClCode] = tmp;</div>
<div class="line">                            }</div>
<div class="line">                            <span class="keywordflow">else</span></div>
<div class="line">                            {</div>
<div class="line">                                ClInfo info = <span class="keyword">new</span> ClInfo()</div>
<div class="line">                                {</div>
<div class="line">                                    ClCode = param.ClCode,</div>
<div class="line">                                    Caption = param.Caption,</div>
<div class="line">                                    Name = param.Name,</div>
<div class="line">                                    TechName = techName</div>
<div class="line">                                };</div>
<div class="line"> </div>
<div class="line">                                infos.Add(param.ClCode, info);</div>
<div class="line">                            }</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">catch</span> (Exception)</div>
<div class="line">                { }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            var filePath = Path.Combine(EspritApplication.TempDir, Guid.NewGuid().ToString() + <span class="stringliteral">&quot;.csv&quot;</span>);</div>
<div class="line">            <span class="keyword">using</span> (var outStream = <span class="keyword">new</span> StreamWriter(filePath))</div>
<div class="line">            {</div>
<div class="line">                outStream.WriteLine(<span class="stringliteral">&quot;CL Code&quot;</span> + <span class="stringliteral">&quot;,&quot;</span> + <span class="stringliteral">&quot;Property Name&quot;</span> + <span class="stringliteral">&quot;,&quot;</span> + <span class="stringliteral">&quot;Caption&quot;</span> + <span class="stringliteral">&quot;,&quot;</span> + <span class="stringliteral">&quot;Technology Object Names&quot;</span>);</div>
<div class="line">                <span class="keywordflow">foreach</span>(var info <span class="keywordflow">in</span> infos.Values)</div>
<div class="line">                {</div>
<div class="line">                    outStream.WriteLine($<span class="stringliteral">&quot;{info.ClCode},{info.Name},{info.Caption},{info.TechName}&quot;</span>);</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                EspritApplication.EventWindow.AddMessage(espMessageType.espMessageTypeInformation, <span class="stringliteral">&quot;ParameterObjectTutorial&quot;</span>, $<span class="stringliteral">&quot;File with Unique CLCodes created: {filePath}&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/>
<script type="text/javascript" src="restoreTabs.js"></script>
</body>
</html>
