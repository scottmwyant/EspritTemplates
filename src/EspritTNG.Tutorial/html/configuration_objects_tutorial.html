<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Introduction to the Configuration Object</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="tutorial.css" rel="stylesheet" type="text/css" />
<link href="tab.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="tab.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Introduction to the Configuration Object </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>We briefly used the Configuration object in Tutorial: Create Center Lines as Leaders and Tutorial: Create Hole Processing Info. In those cases we accessed the ConfigurationDimensions and ConfigurationAnnotation objects to get the default attributes for Leaders and Notes. Every type of GraphicObject has a corresponding configuration object. For example, ConfigurationCircles contains the attributes configured for Circle objects. For the most part, the configuration objects will contain Color, LineType, and LineWeight properties, as well as any special properties pertaining to that object. For example, ConfigurationPoints does not need LineType, because Point objects do not have a LineType, while the ConfigurationHatch object only has Angle and Step properties (because like Leaders, Hatch objects get their Color, LineType, and LineWeight from ConfigurationDimensions).</p>
<p>This tutorial introduces modified functions from Tutorial: More Fun With Functions and SelectionSets - the difference is the Circle and FeaturePtop objects are created using the configuration settings found in ConfigurationCircles and ConfigurationFeaturePtops.</p>
<ul>
<li>Create Bolt Hole:</li>
</ul>
<div class="tab"> <div class="tablinks1" onclick="openTab(event, &apos;CShsnippet1&apos;, &apos;tabcontent1&apos;, &apos;tablinks1&apos;)">C#</div> </div><div id="CShsnippet1" class="tabcontent1"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> BoltHoleImprovedDemo(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            Esprit.Point point = <span class="keyword">null</span>;</div>
<div class="line"> </div>
<div class="line">            _form.Hide();</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                point = Document.GetPoint(<span class="stringliteral">&quot;Select Bolt Hole Center&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// Element was not set</span></div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (point != <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                var patternRadius = 10.0;</div>
<div class="line">                var holeRadius = 1.0;</div>
<div class="line">                var numberOfHoles = 6;</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (RequestUserInput(<span class="stringliteral">&quot;Enter Pattern Radius&quot;</span>, <span class="stringliteral">&quot;Pattern Radius&quot;</span>, ref patternRadius) &amp;&amp;</div>
<div class="line">                    RequestUserInput(<span class="stringliteral">&quot;Enter Hole Radius&quot;</span>, <span class="stringliteral">&quot;Hole Radius&quot;</span>, ref holeRadius) &amp;&amp;</div>
<div class="line">                    RequestUserInput(<span class="stringliteral">&quot;Enter Number of Holes&quot;</span>, <span class="stringliteral">&quot;Number of Holes&quot;</span>, ref numberOfHoles))</div>
<div class="line">                {</div>
<div class="line">                    FeatureHelper.BoltHoleImproved(Document, EspritApplication.Configuration, point, patternRadius, holeRadius, numberOfHoles);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            _form.Show();</div>
<div class="line"> </div>
<div class="line">            Document.Refresh();</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> SelectionSet BoltHoleImproved(Document document, Configuration config, Point center, <span class="keywordtype">double</span> patternRadius, <span class="keywordtype">double</span> holeRadius, <span class="keywordtype">int</span> numberOfHoles)</div>
<div class="line">        {</div>
<div class="line">            var boltHolePattern = SelectionSetHelper.AddUniqueSelectionSet(document.SelectionSets, <span class="stringliteral">&quot;BoltHole&quot;</span>);</div>
<div class="line">            FeaturePtop featurePtop = <span class="keyword">null</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (var i = 0; i &lt; numberOfHoles; i++)</div>
<div class="line">            {</div>
<div class="line">                var angle = i * 2 * Math.PI / numberOfHoles;</div>
<div class="line">                var x = patternRadius * Math.Cos(angle) + center.X;</div>
<div class="line">                var y = patternRadius * Math.Sin(angle) + center.Y;</div>
<div class="line"> </div>
<div class="line">                var hole = document.Circles.Add(document.GetPoint(x, y, center.Z), holeRadius);</div>
<div class="line">                hole.Color = config.ConfigurationCircles.Color;</div>
<div class="line">                hole.LineType = config.ConfigurationCircles.LineType;</div>
<div class="line">                hole.LineWeight = config.ConfigurationCircles.LineWeight;</div>
<div class="line"> </div>
<div class="line">                boltHolePattern.Add(hole);</div>
<div class="line">                <span class="keywordflow">if</span> (featurePtop == <span class="keyword">null</span>)</div>
<div class="line">                {</div>
<div class="line">                    featurePtop = document.FeaturePtops.Add(hole.CenterPoint);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                    featurePtop.Add(hole.CenterPoint);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (featurePtop != <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                featurePtop.Color = config.ConfigurationFeaturePtops.Color;</div>
<div class="line">                featurePtop.LineType = config.ConfigurationFeaturePtops.LineType;</div>
<div class="line">                featurePtop.LineWeight = config.ConfigurationFeaturePtops.LineWeight;</div>
<div class="line">                boltHolePattern.Add(featurePtop);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> boltHolePattern;</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><ul>
<li>Create a function that will take any GraphicObject and set it to the default attributes for that type of object.</li>
</ul>
<div class="tab"> <div class="tablinks2" onclick="openTab(event, &apos;CShsnippet2&apos;, &apos;tabcontent2&apos;, &apos;tablinks2&apos;)">C#</div> </div><div id="CShsnippet2" class="tabcontent2"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">void</span> SetDefaultAttributes(Esprit.GraphicObject graphicObject, Esprit.Configuration config)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">switch</span> (graphicObject.GraphicObjectType)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espAnnotation:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationNotes.Color;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espArc:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationArcs.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationArcs.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationArcs.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espCircle:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationCircles.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationCircles.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationCircles.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espCurve:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationCurves.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationCurves.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationCurves.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espDimension:</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espHatch:</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espLeader:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationDimensions.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationDimensions.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationDimensions.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espFeatureChain:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationFeatureChains.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationFeatureChains.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationFeatureChains.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espFeaturePtop:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationFeaturePtops.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationFeaturePtops.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationFeaturePtops.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espLine:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationLines.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationLines.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationLines.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espOperation:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationOperations.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationOperations.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationOperations.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espPoint:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationPoints.Color;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationPoints.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espSegment:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationSegments.Color;</div>
<div class="line">                    graphicObject.LineType = config.ConfigurationSegments.LineType;</div>
<div class="line">                    graphicObject.LineWeight = config.ConfigurationSegments.LineWeight;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espSolidModel:</div>
<div class="line">                <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espSTL_Model:</div>
<div class="line">                    graphicObject.Color = config.ConfigurationPoints.Color;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><ul>
<li>Loop through all graphic objects in the Selection Set and set them to the default attributes:</li>
</ul>
<div class="tab"> <div class="tablinks3" onclick="openTab(event, &apos;CShsnippet3&apos;, &apos;tabcontent3&apos;, &apos;tablinks3&apos;)">C#</div> </div><div id="CShsnippet3" class="tabcontent3"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> SelectionSet DefaultAttributesSet(SelectionSet <span class="keyword">set</span>, Configuration config)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">for</span> (var i = 1; i &lt;= <span class="keyword">set</span>.Count; i++)</div>
<div class="line">            {</div>
<div class="line">                GraphicObjectHelper.SetDefaultAttributes(<span class="keyword">set</span>[i], config);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">set</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><ul>
<li>Create Chain Circles:</li>
</ul>
<div class="tab"> <div class="tablinks4" onclick="openTab(event, &apos;CShsnippet4&apos;, &apos;tabcontent4&apos;, &apos;tablinks4&apos;)">C#</div> </div><div id="CShsnippet4" class="tabcontent4"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> ChainCirclesImprovedDemo(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            Esprit.Circle circle = <span class="keyword">null</span>;</div>
<div class="line"> </div>
<div class="line">            _form.Hide();</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                circle = Document.GetCircle(<span class="stringliteral">&quot;Pick Boundary Circle&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// Element was not set</span></div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (circle != <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                var spacing = circle.Radius / 100.0;</div>
<div class="line">                var holeRadius = circle.Radius / 10.0;</div>
<div class="line">                var startAngle = 0.0;</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (RequestUserInput(<span class="stringliteral">&quot;Enter Hole Radius&quot;</span>, <span class="stringliteral">&quot;Hole Radius&quot;</span>, ref holeRadius) &amp;&amp;</div>
<div class="line">                    RequestUserInput(<span class="stringliteral">&quot;Enter Spacing&quot;</span>, <span class="stringliteral">&quot;Spacing&quot;</span>, ref spacing) &amp;&amp;</div>
<div class="line">                    RequestUserInput(<span class="stringliteral">&quot;Enter Start Angle&quot;</span>, <span class="stringliteral">&quot;Start Angle&quot;</span>, ref startAngle))</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">try</span></div>
<div class="line">                    {</div>
<div class="line">                        var v = SelectionSetHelper.DefaultAttributesSet(FeatureHelper.MoldHolePattern(Document, circle.CenterPoint, circle.Radius, holeRadius, spacing), EspritApplication.Configuration);</div>
<div class="line">                        SelectionSetHelper.DefaultAttributesSet(FeatureHelper.ChainCircles(Document, v, startAngle * Math.PI / 180), EspritApplication.Configuration);</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">                    {</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            _form.Show();</div>
<div class="line"> </div>
<div class="line">            Document.Refresh();</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> SelectionSet ChainCircles(Document document, SelectionSet selectionSet, <span class="keywordtype">double</span> startAngle)</div>
<div class="line">        {</div>
<div class="line">            var chainCircles = SelectionSetHelper.AddUniqueSelectionSet(document.SelectionSets, <span class="stringliteral">&quot;ChainCircles&quot;</span>);</div>
<div class="line">            <span class="keywordflow">for</span> (var i = 1; i &lt;= selectionSet.Count; i++)</div>
<div class="line">            {</div>
<div class="line">                var graphicObject = selectionSet[i] as IGraphicObject;</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (graphicObject.GraphicObjectType != espGraphicObjectType.espCircle)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">continue</span>;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                var circle = graphicObject as Circle;</div>
<div class="line">                var featureChain = document.FeatureChains.Add(document.GetPoint(circle.CenterPoint.X + circle.Radius * Math.Cos(startAngle), circle.CenterPoint.Y + circle.Radius * Math.Sin(startAngle), circle.CenterPoint.Z));</div>
<div class="line">                featureChain.Add(document.GetArc(circle.CenterPoint, circle.Radius, startAngle, startAngle + 2 * Math.PI));</div>
<div class="line">                chainCircles.Add(featureChain);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> chainCircles;</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> SelectionSet MoldHolePattern(Document document, Point center, <span class="keywordtype">double</span> boundaryRadius, <span class="keywordtype">double</span> holeRadius, <span class="keywordtype">double</span> spacing)</div>
<div class="line">        {</div>
<div class="line">            var moldHolePattern = SelectionSetHelper.AddUniqueSelectionSet(document.SelectionSets, <span class="stringliteral">&quot;MoldHole&quot;</span>);</div>
<div class="line">            <span class="keywordflow">if</span> (boundaryRadius &lt; holeRadius)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span> moldHolePattern;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            var hole = document.Circles.Add(center, holeRadius);</div>
<div class="line">            moldHolePattern.Add(hole);</div>
<div class="line"> </div>
<div class="line">            var centerDistance = spacing + 2 * holeRadius;</div>
<div class="line">            uint ring = 0;</div>
<div class="line">            var holesOnRing = 0;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">do</span></div>
<div class="line">            {</div>
<div class="line">                ring++;</div>
<div class="line">                holesOnRing = 0;</div>
<div class="line">                var x = center.X + ring * centerDistance;</div>
<div class="line">                var y = center.Y;</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">for</span> (var sideAngleInDegrees = 120; sideAngleInDegrees &lt;= 420; sideAngleInDegrees += 60)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">for</span> (var holeOnSide = 1; holeOnSide &lt;= ring; holeOnSide++)</div>
<div class="line">                    {</div>
<div class="line">                        x = x + centerDistance * Math.Cos(sideAngleInDegrees * Math.PI / 180);</div>
<div class="line">                        y = y + centerDistance * Math.Sin(sideAngleInDegrees * Math.PI / 180);</div>
<div class="line"> </div>
<div class="line">                        var outerTangent = Geometry.Distance(x, y, center.X, center.Y) + holeRadius + spacing;</div>
<div class="line">                        <span class="keywordflow">if</span> (outerTangent &lt; boundaryRadius)</div>
<div class="line">                        {</div>
<div class="line">                            hole = document.Circles.Add(document.GetPoint(x, y, center.Z), holeRadius);</div>
<div class="line">                            moldHolePattern.Add(hole);</div>
<div class="line">                            holesOnRing++;</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line"> </div>
<div class="line">                }</div>
<div class="line">            } <span class="keywordflow">while</span> (holesOnRing != 0);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> moldHolePattern;</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/>
<script type="text/javascript" src="restoreTabs.js"></script>
</body>
</html>
