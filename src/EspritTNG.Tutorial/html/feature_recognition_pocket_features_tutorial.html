<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Feature Recognition: Pocket Features</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="tutorial.css" rel="stylesheet" type="text/css" />
<link href="tab.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="tab.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Feature Recognition: Pocket Features </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This tutorial introduces the CreatePocketFeatures method of FeatureRecognition. One thing that distinguishes CreatePocketFeatures from the other feature recognition methods is that the SelectionSet that is passed to it does not contain the objects on which to recognize features. Instead the SelectionSet is a boundary, inside which all pockets will be recognized, and the object on which to recognize those pockets is passed as a separate Body argument.</p>
<p>Suppose we want to find all of the pockets on a certain solid with respect to the current active plane. The solid is the Body argument. We need to come up with its outside boundary in order to add that to the SelectionSet argument. Well, we already know how to get the outside boundary of a solid. We did that in Tutorial: Feature Recognition: Part Profiles by using the CreatePartProfileShadow method of feature recognition.</p>
<div class="tab"> <div class="tablinks" onclick="openTab(event, &apos;CShsnippet&apos;, &apos;tabcontent1&apos;, &apos;tablinks&apos;)">C#</div> </div><div id="CShsnippet" class="tabcontent1"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">void</span> FindAllXYZPockets()</div>
<div class="line">        {</div>
<div class="line">            Esprit.Solid solid = <span class="keyword">null</span>;</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                solid = Document.GetAnyElement(<span class="stringliteral">&quot;Select Reference Solid&quot;</span>, EspritConstants.espGraphicObjectType.espSolidModel) as Esprit.Solid;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span>(System.Runtime.InteropServices.COMException)</div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// Element was not set</span></div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span>(solid == <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            var <span class="keyword">set</span> = SelectionSetHelper.GetSelectionSet(Document, <span class="stringliteral">&quot;Temp&quot;</span>);</div>
<div class="line">            <span class="keyword">set</span>.RemoveAll();</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">set</span>.Add(solid);</div>
<div class="line"> </div>
<div class="line">            var plane = Document.Planes[<span class="stringliteral">&quot;XYZ&quot;</span>];</div>
<div class="line">            <span class="keywordflow">if</span> (plane == <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                plane = PlaneHelper.GetPlane(Document, <span class="stringliteral">&quot;Temp XYZ&quot;</span>);</div>
<div class="line">                PlaneHelper.SetPlaneVectors(ref plane, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            EspritApplication.Configuration.ConfigurationFeatureRecognition.Tolerance = (Document.SystemUnit == EspritConstants.espUnitType.espInch)</div>
<div class="line">                ? 0.0001</div>
<div class="line">                : 0.0025;</div>
<div class="line"> </div>
<div class="line">            Array boundaries = <span class="keyword">null</span>;</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                boundaries = Document.FeatureRecognition.CreatePartProfileShadow(<span class="keyword">set</span>, plane, EspritConstants.espGraphicObjectReturnType.espFeatureChains);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (Exception)</div>
<div class="line">            {</div>
<div class="line">                MessageBox.Show(<span class="stringliteral">&quot;Fail on creating part profile shadow.&quot;</span>, <span class="stringliteral">&quot;FeatureRecognitionPocketFeaturesTutorial&quot;</span>, MessageBoxButton.OK);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            Esprit.FeatureChain boundary = <span class="keyword">null</span>;</div>
<div class="line">            <span class="keywordflow">for</span> (var i = boundaries.GetLowerBound(0); i &lt;= boundaries.GetUpperBound(0); i++)</div>
<div class="line">            {</div>
<div class="line">                var graphicObject = boundaries.GetValue(i) as Esprit.GraphicObject;</div>
<div class="line">                <span class="keywordflow">if</span> (graphicObject.GraphicObjectType != EspritConstants.espGraphicObjectType.espFeatureChain)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">continue</span>;</div>
<div class="line">                }</div>
<div class="line">                var featureChain = graphicObject as Esprit.FeatureChain;</div>
<div class="line">                <span class="keywordflow">if</span> (boundary == <span class="keyword">null</span>)</div>
<div class="line">                {</div>
<div class="line">                    boundary = featureChain;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (featureChain.Area &gt; boundary.Area)</div>
<div class="line">                {</div>
<div class="line">                    boundary = featureChain;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (boundary == <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                MessageBox.Show(<span class="stringliteral">&quot;Unable to determine boundary. Aborting.&quot;</span>, <span class="stringliteral">&quot;FeatureRecognitionPocketFeaturesTutorial&quot;</span>, MessageBoxButton.OK);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">set</span>.RemoveAll();</div>
<div class="line">            <span class="keyword">set</span>.Add(boundary);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                Document.FeatureRecognition.CreatePocketFeatures(<span class="keyword">set</span>, EspritConstants.espPocketType.espPocketTypeMultiple, solid, <span class="keyword">new</span> Esprit.Plane[1] { plane });</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (Exception)</div>
<div class="line">            {</div>
<div class="line">                MessageBox.Show(<span class="stringliteral">&quot;Fail on creating pocket features.&quot;</span>, <span class="stringliteral">&quot;FeatureRecognitionPocketFeaturesTutorial&quot;</span>, MessageBoxButton.OK);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> SelectionSet GetOrAddSelectionSet(ISelectionSets selectionSets, <span class="keywordtype">string</span> name)</div>
<div class="line">        {</div>
<div class="line">            var <span class="keyword">set</span> = selectionSets[name] ?? selectionSets.Add(name);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">set</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> Esprit.Plane GetPlane(Esprit.Document document, <span class="keywordtype">string</span> name)</div>
<div class="line">        {</div>
<div class="line">            Esprit.Plane plane = <span class="keyword">null</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">foreach</span> (Esprit.Plane p in document.Planes)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (p.Name == name)</div>
<div class="line">                {</div>
<div class="line">                    plane = p;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (plane == <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                plane = document.Planes.Add(name);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> plane;</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">void</span> SetPlaneVectors(ref Esprit.Plane plane,</div>
<div class="line">            <span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, <span class="keywordtype">double</span> z,</div>
<div class="line">            <span class="keywordtype">double</span> Ux, <span class="keywordtype">double</span> Uy, <span class="keywordtype">double</span> Uz,</div>
<div class="line">            <span class="keywordtype">double</span> Vx, <span class="keywordtype">double</span> Vy, <span class="keywordtype">double</span> Vz,</div>
<div class="line">            <span class="keywordtype">double</span> Wx, <span class="keywordtype">double</span> Wy, <span class="keywordtype">double</span> Wz)</div>
<div class="line">        {</div>
<div class="line">            plane.X = x;</div>
<div class="line">            plane.Y = y;</div>
<div class="line">            plane.Z = z;</div>
<div class="line">            plane.Ux = Ux;</div>
<div class="line">            plane.Uy = Uy;</div>
<div class="line">            plane.Uz = Uz;</div>
<div class="line">            plane.Vx = Vx;</div>
<div class="line">            plane.Vy = Vy;</div>
<div class="line">            plane.Vz = Vz;</div>
<div class="line">            plane.Wx = Wx;</div>
<div class="line">            plane.Wy = Wy;</div>
<div class="line">            plane.Wz = Wz;</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>Before running the code open a file that contains a solid, or create one in the Solid Modeler. What kind of feature is created for pocketing? If you look on the Feature Tab of the Project Manager in ESPRIT, you may see a whole folder of features for the pocket, including its boundary and all of the islands. This conglomeration is a FeatureSet. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/>
<script type="text/javascript" src="restoreTabs.js"></script>
</body>
</html>
