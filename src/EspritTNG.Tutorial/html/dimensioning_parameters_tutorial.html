<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Configuration: Scale, Save, and Open Dimensioning Parameters</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="tutorial.css" rel="stylesheet" type="text/css" />
<link href="tab.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="tab.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Configuration: Scale, Save, and Open Dimensioning Parameters </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This tutorial demonstrates the dimensioning parameters which belong to the Configuration.ConfigurationDimension object.</p>
<p><a class="anchor" id="AnchorScaleDimensioningParameters"></a></p><ul>
<li>Scale all of the dimensioning parameters, similar to the way the grid was scaled in Tutorial: More Configuration: Grid and Background:</li>
</ul>
<div class="tab"> <div class="tablinks" onclick="openTab(event, &apos;CShsnippet&apos;, &apos;tabcontent1&apos;, &apos;tablinks&apos;)">C#</div> </div><div id="CShsnippet" class="tabcontent1"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> ScaleDimensioningParameters()</div>
<div class="line">        {</div>
<div class="line">            var scaleFactor = 1.0;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (RequestUserInput(<span class="stringliteral">&quot;Enter Dimensioning Factor&quot;</span>, <span class="stringliteral">&quot;Scale Factor&quot;</span>, ref scaleFactor))</div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// only scale linear measurement values</span></div>
<div class="line"> </div>
<div class="line">                EspritApplication.Configuration.ConfigurationDimension.ArrowHeight *= scaleFactor;</div>
<div class="line">                EspritApplication.Configuration.ConfigurationDimension.ArrowWidth *= scaleFactor;</div>
<div class="line">                EspritApplication.Configuration.ConfigurationDimension.DatumDistance *= scaleFactor;</div>
<div class="line">                EspritApplication.Configuration.ConfigurationDimension.LeaderDistance *= scaleFactor;</div>
<div class="line">                EspritApplication.Configuration.ConfigurationDimension.ToleranceMinus *= scaleFactor;</div>
<div class="line">                EspritApplication.Configuration.ConfigurationDimension.TolerancePlus *= scaleFactor;</div>
<div class="line">                EspritApplication.Configuration.ConfigurationDimension.WitnessDistance *= scaleFactor;</div>
<div class="line">                EspritApplication.Configuration.ConfigurationDimension.WitnessExtentDistance *= scaleFactor;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><ul>
<li>Save the Dimensioning Parameters. For saving, we will make a comma separated (.csv) file giving both the parameter name and its value. When the file is read back in, we can test for the parameter name before assigning the value. This way, the order or even the number of parameters will not matter. Someone could edit the parameter file and delete values or new values could be added to ConfigurationDimension in the future without affecting the ability to read the remaining values in the file.</li>
</ul>
<div class="tab"> <div class="tablinks2" onclick="openTab(event, &apos;CShsnippet2&apos;, &apos;tabcontent2&apos;, &apos;tablinks2&apos;)">C#</div> </div><div id="CShsnippet2" class="tabcontent2"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> SaveDimensioningParameters(String filePath)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (filePath.Length != 0)</div>
<div class="line">            {</div>
<div class="line">                var text = <span class="keyword">new</span> StringBuilder();</div>
<div class="line">                var config = EspritApplication.Configuration.ConfigurationDimension;</div>
<div class="line"> </div>
<div class="line">                text.AppendLine($<span class="stringliteral">&quot;AllowMajorAngle, {config.AllowMajorAngle}&quot;</span>);</div>
<div class="line">                text.AppendLine($<span class="stringliteral">&quot;AngleTrailingDigits, {config.AngleTrailingDigits}&quot;</span>);</div>
<div class="line">                text.AppendLine($<span class="stringliteral">&quot;AngleUnit, {config.AngleUnit}&quot;</span>);</div>
<div class="line">                text.AppendLine($<span class="stringliteral">&quot;ArcCenterLine, {config.ArcCenterLine}&quot;</span>);</div>
<div class="line">                text.AppendLine($<span class="stringliteral">&quot;ArcType, {config.ArcType}&quot;</span>);</div>
<div class="line">                text.AppendLine($<span class="stringliteral">&quot;ArrowHeight, {config.ArrowHeight}&quot;</span>);</div>
<div class="line">                text.AppendLine($<span class="stringliteral">&quot;ArrowType, {config.ArrowType}&quot;</span>);</div>
<div class="line">                text.AppendLine($<span class="stringliteral">&quot;ArrowWidth, {config.ArrowWidth}&quot;</span>);</div>
<div class="line">                text.AppendLine($<span class="stringliteral">&quot;AutoCenter, {config.AutoCenter}&quot;</span>);</div>
<div class="line">                text.AppendLine($<span class="stringliteral">&quot;AutoDimensionSide, {config.AutoDimensionSide}&quot;</span>);</div>
<div class="line">                text.AppendLine($<span class="stringliteral">&quot;CircleCenterLine, {config.CircleCenterLine}&quot;</span>);</div>
<div class="line">                text.AppendLine($<span class="stringliteral">&quot;CircleType, {config.CircleType}&quot;</span>);</div>
<div class="line">                text.AppendLine($<span class="stringliteral">&quot;DatumDistance, {config.DatumDistance}&quot;</span>);</div>
<div class="line">                text.AppendLine($<span class="stringliteral">&quot;DatumType, {config.DatumType}&quot;</span>);</div>
<div class="line">                text.AppendLine($<span class="stringliteral">&quot;DrawingScale, {config.DrawingScale}&quot;</span>);</div>
<div class="line">                text.AppendLine($<span class="stringliteral">&quot;LeaderDistance, {config.LeaderDistance}&quot;</span>);</div>
<div class="line">                text.AppendLine($<span class="stringliteral">&quot;LengthTrailingDigits, {config.LengthTrailingDigits}&quot;</span>);</div>
<div class="line">                text.AppendLine($<span class="stringliteral">&quot;LengthUnit, {config.LengthUnit}&quot;</span>);</div>
<div class="line">                text.AppendLine($<span class="stringliteral">&quot;Prefix, {config.Prefix}&quot;</span>);</div>
<div class="line">                text.AppendLine($<span class="stringliteral">&quot;Suffix, {config.Suffix}&quot;</span>);</div>
<div class="line">                text.AppendLine($<span class="stringliteral">&quot;ToleranceMinus, {config.ToleranceMinus}&quot;</span>);</div>
<div class="line">                text.AppendLine($<span class="stringliteral">&quot;TolerancePlus, {config.TolerancePlus}&quot;</span>);</div>
<div class="line">                text.AppendLine($<span class="stringliteral">&quot;ToleranceTextProportion, {config.ToleranceTextProportion}&quot;</span>);</div>
<div class="line">                text.AppendLine($<span class="stringliteral">&quot;ToleranceType, {config.ToleranceType}&quot;</span>);</div>
<div class="line">                text.AppendLine($<span class="stringliteral">&quot;WitnessDistance, {config.WitnessDistance}&quot;</span>);</div>
<div class="line">                text.AppendLine($<span class="stringliteral">&quot;WitnessExtentDistance, {config.WitnessExtentDistance}&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                <span class="keyword">using</span> (var outStream = <span class="keyword">new</span> System.IO.StreamWriter(filePath))</div>
<div class="line">                {</div>
<div class="line">                    outStream.Write(text.ToString());</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><ul>
<li>Reading from a Dimensioning Parameter file:</li>
</ul>
<div class="tab"> <div class="tablinks3" onclick="openTab(event, &apos;CShsnippet3&apos;, &apos;tabcontent3&apos;, &apos;tablinks3&apos;)">C#</div><p> <br  />
 </div><div id="CShsnippet3" class="tabcontent3"> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OpenDimensioningParameters(String filePath)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (filePath.Length != 0)</div>
<div class="line">            {</div>
<div class="line"> </div>
<div class="line">                var config = EspritApplication.Configuration.ConfigurationDimension;</div>
<div class="line"> </div>
<div class="line">                <span class="keyword">using</span> (var inStream = <span class="keyword">new</span> System.IO.StreamReader(filePath))</div>
<div class="line">                {</div>
<div class="line">                    var charSeparators = <span class="keyword">new</span> <span class="keywordtype">char</span>[] { <span class="charliteral">&#39;,&#39;</span> };</div>
<div class="line">                    var data = <span class="keywordtype">string</span>.Empty;</div>
<div class="line"> </div>
<div class="line">                    <span class="keywordflow">while</span> ((data = inStream.ReadLine()) != <span class="keyword">null</span>)</div>
<div class="line">                    {</div>
<div class="line">                        var parameterData = data.Split(charSeparators, StringSplitOptions.RemoveEmptyEntries);</div>
<div class="line">                        <span class="keywordflow">if</span> (parameterData.Length != 2)</div>
<div class="line">                        {</div>
<div class="line">                            <span class="keywordflow">continue</span>;</div>
<div class="line">                        }</div>
<div class="line"> </div>
<div class="line">                        <span class="keywordflow">switch</span> (parameterData[0])</div>
<div class="line">                        {</div>
<div class="line">                            <span class="keywordflow">case</span> <span class="stringliteral">&quot;AllowMajorAngle&quot;</span>:</div>
<div class="line">                                {</div>
<div class="line">                                    <span class="keywordflow">if</span> (<span class="keywordtype">bool</span>.TryParse(parameterData[1], out var value))</div>
<div class="line">                                        config.AllowMajorAngle = value;</div>
<div class="line">                                    <span class="keywordflow">break</span>;</div>
<div class="line">                                }</div>
<div class="line"> </div>
<div class="line">                            <span class="keywordflow">case</span> <span class="stringliteral">&quot;AngleTrailingDigits&quot;</span>:</div>
<div class="line">                                {</div>
<div class="line">                                    <span class="keywordflow">if</span> (<span class="keywordtype">int</span>.TryParse(parameterData[1], out var value))</div>
<div class="line">                                        config.AngleTrailingDigits = value;</div>
<div class="line">                                    <span class="keywordflow">break</span>;</div>
<div class="line">                                }</div>
<div class="line">                            <span class="keywordflow">case</span> <span class="stringliteral">&quot;AngleUnit&quot;</span>:</div>
<div class="line">                                {</div>
<div class="line">                                    <span class="keywordflow">if</span> (Enum.TryParse(parameterData[1], out EspritConstants.espAngleUnitType value))</div>
<div class="line">                                        config.AngleUnit = value;</div>
<div class="line">                                    <span class="keywordflow">break</span>;</div>
<div class="line">                                }</div>
<div class="line">                            <span class="keywordflow">case</span> <span class="stringliteral">&quot;ArcCenterLine&quot;</span>:</div>
<div class="line">                                {</div>
<div class="line">                                    <span class="keywordflow">if</span> (<span class="keywordtype">bool</span>.TryParse(parameterData[1], out var value))</div>
<div class="line">                                        config.ArcCenterLine = value;</div>
<div class="line">                                    <span class="keywordflow">break</span>;</div>
<div class="line">                                }</div>
<div class="line">                            <span class="keywordflow">case</span> <span class="stringliteral">&quot;ArcType&quot;</span>:</div>
<div class="line">                                {</div>
<div class="line">                                    <span class="keywordflow">if</span> (Enum.TryParse(parameterData[1], out EspritConstants.espDimensionRoundType value))</div>
<div class="line">                                        config.ArcType = value;</div>
<div class="line">                                    <span class="keywordflow">break</span>;</div>
<div class="line">                                }</div>
<div class="line">                            <span class="keywordflow">case</span> <span class="stringliteral">&quot;ArrowHeight&quot;</span>:</div>
<div class="line">                                {</div>
<div class="line">                                    <span class="keywordflow">if</span> (<span class="keywordtype">double</span>.TryParse(parameterData[1], out var value))</div>
<div class="line">                                        config.ArrowHeight = value;</div>
<div class="line">                                    <span class="keywordflow">break</span>;</div>
<div class="line">                                }</div>
<div class="line">                            <span class="keywordflow">case</span> <span class="stringliteral">&quot;ArrowType&quot;</span>:</div>
<div class="line">                                {</div>
<div class="line">                                    <span class="keywordflow">if</span> (Enum.TryParse(parameterData[1], out EspritConstants.espArrowType value))</div>
<div class="line">                                        config.ArrowType = value;</div>
<div class="line">                                    <span class="keywordflow">break</span>;</div>
<div class="line">                                }</div>
<div class="line">                            <span class="keywordflow">case</span> <span class="stringliteral">&quot;ArrowWidth&quot;</span>:</div>
<div class="line">                                {</div>
<div class="line">                                    <span class="keywordflow">if</span> (<span class="keywordtype">double</span>.TryParse(parameterData[1], out var value))</div>
<div class="line">                                        config.ArrowWidth = value;</div>
<div class="line">                                    <span class="keywordflow">break</span>;</div>
<div class="line">                                }</div>
<div class="line">                            <span class="keywordflow">case</span> <span class="stringliteral">&quot;AutoCenter&quot;</span>:</div>
<div class="line">                                {</div>
<div class="line">                                    <span class="keywordflow">if</span> (<span class="keywordtype">bool</span>.TryParse(parameterData[1], out var value))</div>
<div class="line">                                        config.AutoCenter = value;</div>
<div class="line">                                    <span class="keywordflow">break</span>;</div>
<div class="line">                                }</div>
<div class="line">                            <span class="keywordflow">case</span> <span class="stringliteral">&quot;AutoDimensionSide&quot;</span>:</div>
<div class="line">                                {</div>
<div class="line">                                    <span class="keywordflow">if</span> (Enum.TryParse(parameterData[1], out EspritConstants.espDimensionAutoPlacementType value))</div>
<div class="line">                                        config.AutoDimensionSide = value;</div>
<div class="line">                                    <span class="keywordflow">break</span>;</div>
<div class="line">                                }</div>
<div class="line">                            <span class="keywordflow">case</span> <span class="stringliteral">&quot;CircleCenterLine&quot;</span>:</div>
<div class="line">                                {</div>
<div class="line">                                    <span class="keywordflow">if</span> (<span class="keywordtype">bool</span>.TryParse(parameterData[1], out var value))</div>
<div class="line">                                        config.CircleCenterLine = value;</div>
<div class="line">                                    <span class="keywordflow">break</span>;</div>
<div class="line">                                }</div>
<div class="line">                            <span class="keywordflow">case</span> <span class="stringliteral">&quot;CircleType&quot;</span>:</div>
<div class="line">                                {</div>
<div class="line">                                    <span class="keywordflow">if</span> (Enum.TryParse(parameterData[1], out EspritConstants.espDimensionRoundType value))</div>
<div class="line">                                        config.CircleType = value;</div>
<div class="line">                                    <span class="keywordflow">break</span>;</div>
<div class="line">                                }</div>
<div class="line">                            <span class="keywordflow">case</span> <span class="stringliteral">&quot;DatumDistance&quot;</span>:</div>
<div class="line">                                {</div>
<div class="line">                                    <span class="keywordflow">if</span> (<span class="keywordtype">double</span>.TryParse(parameterData[1], out var value))</div>
<div class="line">                                        config.DatumDistance = value;</div>
<div class="line">                                    <span class="keywordflow">break</span>;</div>
<div class="line">                                }</div>
<div class="line">                            <span class="keywordflow">case</span> <span class="stringliteral">&quot;DatumType&quot;</span>:</div>
<div class="line">                                {</div>
<div class="line">                                    <span class="keywordflow">if</span> (Enum.TryParse(parameterData[1], out EspritConstants.espDimensionDatumType value))</div>
<div class="line">                                        config.DatumType = value;</div>
<div class="line">                                    <span class="keywordflow">break</span>;</div>
<div class="line">                                }</div>
<div class="line">                            <span class="keywordflow">case</span> <span class="stringliteral">&quot;DrawingScale&quot;</span>:</div>
<div class="line">                                {</div>
<div class="line">                                    <span class="keywordflow">if</span> (<span class="keywordtype">double</span>.TryParse(parameterData[1], out var value))</div>
<div class="line">                                        config.DrawingScale = value;</div>
<div class="line">                                    <span class="keywordflow">break</span>;</div>
<div class="line">                                }</div>
<div class="line">                            <span class="keywordflow">case</span> <span class="stringliteral">&quot;LeaderDistance&quot;</span>:</div>
<div class="line">                                {</div>
<div class="line">                                    <span class="keywordflow">if</span> (<span class="keywordtype">double</span>.TryParse(parameterData[1], out var value))</div>
<div class="line">                                        config.LeaderDistance = value;</div>
<div class="line">                                    <span class="keywordflow">break</span>;</div>
<div class="line">                                }</div>
<div class="line">                            <span class="keywordflow">case</span> <span class="stringliteral">&quot;LengthTrailingDigits&quot;</span>:</div>
<div class="line">                                {</div>
<div class="line">                                    <span class="keywordflow">if</span> (<span class="keywordtype">int</span>.TryParse(parameterData[1], out var value))</div>
<div class="line">                                        config.LengthTrailingDigits = value;</div>
<div class="line">                                    <span class="keywordflow">break</span>;</div>
<div class="line">                                }</div>
<div class="line">                            <span class="keywordflow">case</span> <span class="stringliteral">&quot;LengthUnit&quot;</span>:</div>
<div class="line">                                {</div>
<div class="line">                                    <span class="keywordflow">if</span> (Enum.TryParse(parameterData[1], out EspritConstants.espUnitType value))</div>
<div class="line">                                        config.LengthUnit = value;</div>
<div class="line">                                    <span class="keywordflow">break</span>;</div>
<div class="line">                                }</div>
<div class="line">                            <span class="keywordflow">case</span> <span class="stringliteral">&quot;Prefix&quot;</span>:</div>
<div class="line">                                {</div>
<div class="line">                                    config.Prefix = parameterData[1];</div>
<div class="line">                                    <span class="keywordflow">break</span>;</div>
<div class="line">                                }</div>
<div class="line">                            <span class="keywordflow">case</span> <span class="stringliteral">&quot;Suffix&quot;</span>:</div>
<div class="line">                                {</div>
<div class="line">                                    config.Suffix = parameterData[1];</div>
<div class="line">                                    <span class="keywordflow">break</span>;</div>
<div class="line">                                }</div>
<div class="line">                            <span class="keywordflow">case</span> <span class="stringliteral">&quot;ToleranceMinus&quot;</span>:</div>
<div class="line">                                {</div>
<div class="line">                                    <span class="keywordflow">if</span> (<span class="keywordtype">double</span>.TryParse(parameterData[1], out var value))</div>
<div class="line">                                        config.ToleranceMinus = value;</div>
<div class="line">                                    <span class="keywordflow">break</span>;</div>
<div class="line">                                }</div>
<div class="line">                            <span class="keywordflow">case</span> <span class="stringliteral">&quot;TolerancePlus&quot;</span>:</div>
<div class="line">                                {</div>
<div class="line">                                    <span class="keywordflow">if</span> (<span class="keywordtype">double</span>.TryParse(parameterData[1], out var value))</div>
<div class="line">                                        config.TolerancePlus = value;</div>
<div class="line">                                    <span class="keywordflow">break</span>;</div>
<div class="line">                                }</div>
<div class="line">                            <span class="keywordflow">case</span> <span class="stringliteral">&quot;ToleranceTextProportion&quot;</span>:</div>
<div class="line">                                {</div>
<div class="line">                                    <span class="keywordflow">if</span> (<span class="keywordtype">double</span>.TryParse(parameterData[1], out var value))</div>
<div class="line">                                        config.ToleranceTextProportion = value;</div>
<div class="line">                                    <span class="keywordflow">break</span>;</div>
<div class="line">                                }</div>
<div class="line">                            <span class="keywordflow">case</span> <span class="stringliteral">&quot;ToleranceType&quot;</span>:</div>
<div class="line">                                {</div>
<div class="line">                                    <span class="keywordflow">if</span> (Enum.TryParse(parameterData[1], out EspritConstants.espDimensionToleranceType value))</div>
<div class="line">                                        config.ToleranceType = value;</div>
<div class="line">                                    <span class="keywordflow">break</span>;</div>
<div class="line">                                }</div>
<div class="line">                            <span class="keywordflow">case</span> <span class="stringliteral">&quot;WitnessDistance&quot;</span>:</div>
<div class="line">                                {</div>
<div class="line">                                    <span class="keywordflow">if</span> (<span class="keywordtype">double</span>.TryParse(parameterData[1], out var value))</div>
<div class="line">                                        config.WitnessDistance = value;</div>
<div class="line">                                    <span class="keywordflow">break</span>;</div>
<div class="line">                                }</div>
<div class="line">                            <span class="keywordflow">case</span> <span class="stringliteral">&quot;WitnessExtentDistance&quot;</span>:</div>
<div class="line">                                {</div>
<div class="line">                                    <span class="keywordflow">if</span> (<span class="keywordtype">double</span>.TryParse(parameterData[1], out var value))</div>
<div class="line">                                        config.WitnessExtentDistance = value;</div>
<div class="line">                                    <span class="keywordflow">break</span>;</div>
<div class="line">                                }</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div><p>Note that this tutorial only worked with properties of the ConfigurationDimension object. Using a similar algorithm, any values in the Configuration could be saved to a file, including those associated with the ConfigurationAnnotation, ConfigurationHatch, and ConfigurationLeader objects. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/>
<script type="text/javascript" src="restoreTabs.js"></script>
</body>
</html>
