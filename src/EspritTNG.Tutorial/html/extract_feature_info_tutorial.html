<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Extracting Feature Information</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="tutorial.css" rel="stylesheet" type="text/css" />
<link href="tab.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="tab.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Extracting Feature Information </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This tutorial shows how to extract information from a FeaturePtop object. Similar to collections, feature objects such as FeatureChain and FeaturePtop have a Count property and an Item. The Item for a FeaturePtop directly returns a Point object. The Count can be used to set up a loop then, and information can be gathered on each point.</p>
<p>The code below extracts the points from a chosen FeaturePtop, and finds the shortest and longest distances between two points in a FeaturePtop.</p>
<div class="tab"> <div class="tablinks" onclick="openTab(event, &apos;CShsnippet&apos;, &apos;tabcontent1&apos;, &apos;tablinks&apos;)">C#</div> </div><div id="CShsnippet" class="tabcontent1"> <div> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keywordtype">void</span> FindFeaturePtopInfo()</div>
<div class="line">        {</div>
<div class="line">            EspritApplication.EventWindow.Clear();</div>
<div class="line">            EspritApplication.EventWindow.Visible = <span class="keyword">true</span>;</div>
<div class="line">            var shortestDistance = 0.0;</div>
<div class="line">            var longestDistance = 0.0;</div>
<div class="line"> </div>
<div class="line">            Esprit.FeaturePtop featurePtop = <span class="keyword">null</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                featurePtop = Document.GetAnyElement(<span class="stringliteral">&quot;Pick Feature Ptop&quot;</span>, EspritConstants.espGraphicObjectType.espFeaturePtop) as Esprit.FeaturePtop;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span>(System.Runtime.InteropServices.COMException)</div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// Element was not set</span></div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (featurePtop == <span class="keyword">null</span>)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (var i = 1; i &lt;= featurePtop.Count - 1; i++)</div>
<div class="line">            {</div>
<div class="line">                var distance = Geometry.Distance(featurePtop.Item[i] as Esprit.Point, featurePtop.Item[i + 1] as Esprit.Point);</div>
<div class="line">                <span class="keywordflow">if</span> (i == 1)</div>
<div class="line">                {</div>
<div class="line">                    shortestDistance = distance;</div>
<div class="line">                    longestDistance = distance;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">if</span> (distance &lt; shortestDistance)</div>
<div class="line">                    {</div>
<div class="line">                        shortestDistance = distance;</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">if</span> (distance &gt; longestDistance)</div>
<div class="line">                    {</div>
<div class="line">                        longestDistance = distance;</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                EspritApplication.EventWindow.AddMessage(EspritConstants.espMessageType.espMessageTypeInformation, <span class="stringliteral">&quot;ExtractFeatureInfoTutorial&quot;</span>, $<span class="stringliteral">&quot;The distance between items {i} and {i + 1} is {Math.Round(distance, 5)}&quot;</span>);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            EspritApplication.EventWindow.AddMessage(EspritConstants.espMessageType.espMessageTypeInformation, <span class="stringliteral">&quot;ExtractFeatureInfoTutorial&quot;</span>, $<span class="stringliteral">&quot;The shortest distance is {Math.Round(shortestDistance, 5)}&quot;</span>);</div>
<div class="line">            EspritApplication.EventWindow.AddMessage(EspritConstants.espMessageType.espMessageTypeInformation, <span class="stringliteral">&quot;ExtractFeatureInfoTutorial&quot;</span>, $<span class="stringliteral">&quot;The longest distance is {Math.Round(longestDistance, 5)}&quot;</span>);</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div> <div> The following function is used to calculate distance between two points: </div> <div> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">double</span> Distance(Point point1, Point point2 = <span class="keyword">null</span>)</div>
<div class="line">        {</div>
<div class="line">            var x2 = point2?.X ?? 0;</div>
<div class="line">            var y2 = point2?.Y ?? 0;</div>
<div class="line">            var z2 = point2?.Z ?? 0;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> Distance(point1.X, point1.Y, point1.Z, x2, y2, z2);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">double</span> Distance(<span class="keywordtype">double</span> x1, <span class="keywordtype">double</span> y1, <span class="keywordtype">double</span> z1, <span class="keywordtype">double</span> x2, <span class="keywordtype">double</span> y2, <span class="keywordtype">double</span> z2)</div>
<div class="line">        {</div>
<div class="line">            var dx = x2 - x1;</div>
<div class="line">            var dy = y2 - y1;</div>
<div class="line">            var dz = z2 - z1;</div>
<div class="line">            <span class="keywordflow">return</span> Math.Sqrt(dx * dx + dy * dy + dz * dz);</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div></div><div id="CShsnippet" class="tabcontent1"></div><p>Before runing the code make sure you have one or more FeaturePtops in your ESPRIT file. Pick a FeaturePtop and the information for it will be displayed in the Output Window. If you want, you can confirm the information by smashing the FeaturePtop and placing dimensions between the points.</p>
<p>Tutorial outputs information to the EventWindow :</p>
<div class="image">
<img src="ExtractFeatureInfoEventWindow.png" alt=""/>
</div>
 </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/>
<script type="text/javascript" src="restoreTabs.js"></script>
</body>
</html>
