<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Zigzag Down FeatureChain</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="tutorial.css" rel="stylesheet" type="text/css" />
<link href="tab.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="tab.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Zigzag Down FeatureChain </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The Tutorial: Making a FeatureChain into a Spiral took a closed feature and spiraled downward. What if we want to cut slots and other open contours in a similar fashion. We would simply need to reverse the direction on alternate levels.</p>
<p>This would give us two options, we could ramp in one direction, and then stay level for the return direction, or ramp in both directions. Because of this additional option, let us use a dialog to have the user enter the zigzag parameters.</p>
<p>Set the (Name) and some other properties of each control as shown in the table below:</p>
<center> <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Object Type </th><th class="markdownTableHeadCenter">Name </th><th class="markdownTableHeadCenter">Properties  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">UserForm </td><td class="markdownTableBodyCenter">frmZigZagTutorial </td><td class="markdownTableBodyCenter">Caption = Zigzag Down FeatureChain  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">OptionButton </td><td class="markdownTableBodyCenter">optRampLevel </td><td class="markdownTableBodyCenter">Caption = Ramp - Level  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">OptionButton </td><td class="markdownTableBodyCenter">optRampRamp </td><td class="markdownTableBodyCenter">Caption = Ramp - Ramp  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">Label </td><td class="markdownTableBodyCenter">lblTotalDepth </td><td class="markdownTableBodyCenter">Caption = Total Depth  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">Label </td><td class="markdownTableBodyCenter">lblMaxIncrementalDepth </td><td class="markdownTableBodyCenter">Caption = Max Incr Depth  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">TextBox </td><td class="markdownTableBodyCenter">txtTotalDepth </td><td class="markdownTableBodyCenter"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">TextBox </td><td class="markdownTableBodyCenter">txtMaxIncrementalDepth </td><td class="markdownTableBodyCenter"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">CommandButton </td><td class="markdownTableBodyCenter">cmdOK </td><td class="markdownTableBodyCenter">Caption = OK  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">CommandButton </td><td class="markdownTableBodyCenter">cmdCancel </td><td class="markdownTableBodyCenter">Caption = Cancel  </td></tr>
</table>
</center><center></center><p>Arrange the controls on the form and resize and align them if you like. When you are finished, your form should look similar to the one below.</p>
<div class="image">
<img src="ZigZagTutorial.png" alt=""/>
</div>
<p>Assosiate the following event procedures with the form:</p>
<ul>
<li>OK Button:</li>
</ul>
<div class="tab"> <div class="tablinks" onclick="openTab(event, &apos;CShsnippet&apos;, &apos;tabcontent1&apos;, &apos;tablinks&apos;)">C#</div> </div><div id="CShsnippet" class="tabcontent1"> <div> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnButtonOkClick(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            var totalDepth = 0.0;</div>
<div class="line">            var maxIncrementalDepth = 0.0;</div>
<div class="line">            <span class="keywordflow">if</span> (!<span class="keywordtype">double</span>.TryParse(_totalDepthTextBox.Text, out totalDepth))</div>
<div class="line">            {</div>
<div class="line">                System.Windows.MessageBox.Show(<span class="stringliteral">&quot;Total Depth must be a positive value&quot;</span>, <span class="stringliteral">&quot;ZigzagDownFeatureChainTutorial&quot;</span>, MessageBoxButton.OK);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span> (totalDepth &lt;= 0)</div>
<div class="line">            {</div>
<div class="line">                System.Windows.MessageBox.Show(<span class="stringliteral">&quot;Total Depth must be a positive value&quot;</span>, <span class="stringliteral">&quot;ZigzagDownFeatureChainTutorial&quot;</span>, MessageBoxButton.OK);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (!<span class="keywordtype">double</span>.TryParse(_maxIncrDepthTextBox.Text, out maxIncrementalDepth))</div>
<div class="line">            {</div>
<div class="line">                System.Windows.MessageBox.Show(<span class="stringliteral">&quot;Max Incremental Depth must be a positive value less then Total Depth&quot;</span>, <span class="stringliteral">&quot;ZigzagDownFeatureChainTutorial&quot;</span>, MessageBoxButton.OK);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (maxIncrementalDepth &gt; totalDepth || maxIncrementalDepth &lt; 0)</div>
<div class="line">            {</div>
<div class="line">                System.Windows.MessageBox.Show(<span class="stringliteral">&quot;Max Incremental Depth must be a positive value less then Total Depth&quot;</span>, <span class="stringliteral">&quot;ZigzagDownFeatureChainTutorial&quot;</span>, MessageBoxButton.OK);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            Esprit.FeatureChain featureChain = <span class="keyword">null</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">            {</div>
<div class="line">                featureChain = Document.GetAnyElement(<span class="stringliteral">&quot;Pick Feature Chain to Zigzag Down&quot;</span>, EspritConstants.espGraphicObjectType.espFeatureChain) as Esprit.FeatureChain;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// Element was not set</span></div>
<div class="line">                System.Windows.MessageBox.Show(<span class="stringliteral">&quot;Feature chain does not selected!&quot;</span>, <span class="stringliteral">&quot;ZigzagDownFeatureChainTutorial&quot;</span>, MessageBoxButton.OK);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            var totalSegmentLength = 0.0;</div>
<div class="line">            <span class="keywordflow">for</span> (var i = 1; i &lt;= featureChain.Count; i++)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (featureChain.Item[i].GraphicObjectType == EspritConstants.espGraphicObjectType.espSegment)</div>
<div class="line">                {</div>
<div class="line">                    var segment = featureChain.Item[i] as Esprit.Segment;</div>
<div class="line">                    totalSegmentLength += segment.Length;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (totalSegmentLength == 0)</div>
<div class="line">            {</div>
<div class="line">                System.Windows.MessageBox.Show(<span class="stringliteral">&quot;Cannot zigzag down feature containing only arcs!&quot;</span>, <span class="stringliteral">&quot;ZigzagDownFeatureChainTutorial&quot;</span>, MessageBoxButton.OK);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span> (maxIncrementalDepth == 0)</div>
<div class="line">            {</div>
<div class="line">                maxIncrementalDepth = totalDepth;</div>
<div class="line">            }</div>
<div class="line">            var numberOfPasses = (int)(totalDepth / maxIncrementalDepth);</div>
<div class="line">            <span class="keywordflow">if</span> (totalDepth / maxIncrementalDepth &gt; numberOfPasses)</div>
<div class="line">            {</div>
<div class="line">                numberOfPasses++;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            maxIncrementalDepth = totalDepth / numberOfPasses;</div>
<div class="line">            var passDepth = <span class="keyword">new</span> <span class="keywordtype">double</span>[2];</div>
<div class="line">            <span class="keywordflow">if</span> (_optLevel.Checked)</div>
<div class="line">            {</div>
<div class="line">                passDepth[0] = maxIncrementalDepth;</div>
<div class="line">                passDepth[1] = 0;</div>
<div class="line">                numberOfPasses *= 2;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                passDepth[0] = maxIncrementalDepth / 2;</div>
<div class="line">                passDepth[1] = passDepth[0];</div>
<div class="line">                numberOfPasses = numberOfPasses * 2 + 1;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            var zigzag = Document.FeatureChains.Add(featureChain.Extremity(EspritConstants.espExtremityType.espExtremityStart));</div>
<div class="line">            zigzag.Color = featureChain.Color;</div>
<div class="line">            zigzag.LineType = featureChain.LineType;</div>
<div class="line">            zigzag.LineWeight = featureChain.LineWeight;</div>
<div class="line">            var currentDepth = zigzag.Extremity(EspritConstants.espExtremityType.espExtremityStart).Z;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (var pass = 1; pass &lt;= numberOfPasses; pass++)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (pass % 2 &gt; 0)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">for</span> (var i = 1; i &lt;= featureChain.Count; i++)</div>
<div class="line">                    {</div>
<div class="line">                        <span class="keywordflow">switch</span> (featureChain.Item[i].GraphicObjectType)</div>
<div class="line">                        {</div>
<div class="line">                            <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espArc:</div>
<div class="line">                                var arc = featureChain.Item[i] as Esprit.Arc;</div>
<div class="line">                                var centerPoint = arc.CenterPoint;</div>
<div class="line">                                centerPoint = Document.GetPoint(centerPoint.X, centerPoint.Y, currentDepth);</div>
<div class="line"> </div>
<div class="line">                                <span class="keywordflow">try</span></div>
<div class="line">                                {</div>
<div class="line">                                    arc = Document.GetArc(centerPoint, arc.Radius, arc.StartAngle, arc.EndAngle);</div>
<div class="line">                                    zigzag.Add(arc);</div>
<div class="line">                                }</div>
<div class="line">                                <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">                                {</div>
<div class="line">                                }</div>
<div class="line">                                <span class="keywordflow">break</span>;</div>
<div class="line">                            <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espSegment:</div>
<div class="line">                                var segment = featureChain.Item[i] as Esprit.Segment;</div>
<div class="line">                                <span class="keywordflow">if</span> (pass &lt; numberOfPasses)</div>
<div class="line">                                {</div>
<div class="line">                                    currentDepth -= passDepth[0] * segment.Length / totalSegmentLength;</div>
<div class="line">                                }</div>
<div class="line">                                zigzag.Add(Document.GetPoint(segment.XEnd, segment.YEnd, currentDepth));</div>
<div class="line">                                <span class="keywordflow">break</span>;</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">for</span> (var i = featureChain.Count; i &gt;= 1; i--)</div>
<div class="line">                    {</div>
<div class="line">                        <span class="keywordflow">switch</span> (featureChain.Item[i].GraphicObjectType)</div>
<div class="line">                        {</div>
<div class="line">                            <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espArc:</div>
<div class="line">                                var arc = featureChain.Item[i] as Esprit.Arc;</div>
<div class="line">                                var centerPoint = arc.CenterPoint;</div>
<div class="line">                                centerPoint = Document.GetPoint(centerPoint.X, centerPoint.Y, currentDepth);</div>
<div class="line"> </div>
<div class="line">                                <span class="keywordflow">try</span></div>
<div class="line">                                {</div>
<div class="line">                                    arc = Document.GetArc(centerPoint, arc.Radius, arc.StartAngle, arc.EndAngle);</div>
<div class="line">                                    arc.Reverse();</div>
<div class="line">                                    zigzag.Add(arc);</div>
<div class="line">                                }</div>
<div class="line">                                <span class="keywordflow">catch</span> (System.Runtime.InteropServices.COMException)</div>
<div class="line">                                {</div>
<div class="line">                                }</div>
<div class="line">                                <span class="keywordflow">break</span>;</div>
<div class="line">                            <span class="keywordflow">case</span> EspritConstants.espGraphicObjectType.espSegment:</div>
<div class="line">                                var segment = featureChain.Item[i] as Esprit.Segment;</div>
<div class="line">                                <span class="keywordflow">if</span> (pass &lt; numberOfPasses)</div>
<div class="line">                                {</div>
<div class="line">                                    currentDepth -= passDepth[1] * segment.Length / totalSegmentLength;</div>
<div class="line">                                }</div>
<div class="line">                                zigzag.Add(Document.GetPoint(segment.XStart, segment.YStart, currentDepth));</div>
<div class="line">                                <span class="keywordflow">break</span>;</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            CloseForm();</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div> </div><ul>
<li>Cancel Button:</li>
</ul>
<div class="tab"> <div class="tablinks2" onclick="openTab(event, &apos;CShsnippet2&apos;, &apos;tabcontent2&apos;, &apos;tablinks2&apos;)">C#</div> </div><div id="CShsnippet2" class="tabcontent2"> <div> <div class="fragment"><div class="line"> </div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> OnCancelButtonClick(<span class="keywordtype">object</span> sender, EventArgs e)</div>
<div class="line">        {</div>
<div class="line">            CloseForm();</div>
<div class="line">        }</div>
<div class="line">        <span class="keyword">private</span> <span class="keywordtype">void</span> CloseForm()</div>
<div class="line">        {</div>
<div class="line">            _form.Close();</div>
<div class="line">            _form = <span class="keyword">null</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
</div><!-- fragment --></div> </div><ul>
<li>Init user form:</li>
</ul>
<div class="tab"> <div class="tablinks3" onclick="openTab(event, &apos;CShsnippet3&apos;, &apos;tabcontent3&apos;, &apos;tablinks3&apos;)">C#</div> </div><div id="CShsnippet3" class="tabcontent3"> <div> <div class="fragment"><div class="line"> </div>
<div class="line">            _totalDepthTextBox.Text = (Document.SystemUnit == EspritConstants.espUnitType.espInch)</div>
<div class="line">                ? <span class="stringliteral">&quot;1&quot;</span></div>
<div class="line">                : <span class="stringliteral">&quot;25&quot;</span>;</div>
<div class="line">            _maxIncrDepthTextBox.Text = (Document.SystemUnit == EspritConstants.espUnitType.espInch)</div>
<div class="line">                ? <span class="stringliteral">&quot;0.1&quot;</span></div>
<div class="line">                : <span class="stringliteral">&quot;2.5&quot;</span>;</div>
<div class="line"> </div>
</div><!-- fragment --></div> </div><p>Set the parameters and OK the dialog and pick a feature. Be sure to try both the Ramp-Ramp and Ramp-Level options for comparison. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/>
<script type="text/javascript" src="restoreTabs.js"></script>
</body>
</html>
